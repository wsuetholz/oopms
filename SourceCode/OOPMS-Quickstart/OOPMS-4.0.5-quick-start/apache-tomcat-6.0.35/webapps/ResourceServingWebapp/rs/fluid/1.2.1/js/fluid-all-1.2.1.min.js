(function(a){a.each({focus:"focusin",blur:"focusout"},function(c,b){a.event.special[b]={setup:function(){if(a.browser.msie){return false}this.addEventListener(c,a.event.special[b].handler,true)},teardown:function(){if(a.browser.msie){return false}this.removeEventListener(c,a.event.special[b].handler,true)},handler:function(d){arguments[0]=a.event.fix(d);arguments[0].type=b;return a.event.handle.apply(this,arguments)}}});a.extend(a.fn,{delegate:function(d,c,b){return this.bind(d,function(e){var f=a(e.target);if(f.is(c)){return b.apply(f,arguments)}})},triggerEvent:function(b,c){return this.triggerHandler(b,[jQuery.event.fix({type:b,target:c})])}})})(jQuery);var fluid_1_2=fluid_1_2||{};var fluid=fluid||fluid_1_2;(function(a,b){b.version="Infusion 1.2.1";b.environment={fluid:b};var c=window||{};b.fail=function(j){b.setLogging(true);b.log(j.message?j.message:j);throw new Error(j)};b.wrap=function(j){return((!j||j.jquery)?j:a(j))};b.unwrap=function(j){return j&&j.jquery&&j.length===1?j[0]:j};b.keyForValue=function(l,k){for(var j in l){if(l[j]===k){return j}}return null};b.findKeyInObject=b.keyForValue;b.clear=function(k){if(k instanceof Array){k.length=0}else{for(var j in k){delete k[j]}}};b.identity=function(j){return j};b.container=function(k){var j=k;if(typeof k==="string"||k.nodeType&&(k.nodeType===1||k.nodeType===9)){j=a(k)}if(!j||!j.jquery||j.length!==1){if(typeof(k)!=="string"){k=j.selector}b.fail({name:"NotOne",message:"A single container element was not found for selector "+k})}return j};b.dumpEl=b.identity;b.renderTimestamp=b.identity;var f={};var g={};b.defaults=function(){var m=0;var k=f;if(typeof arguments[0]==="boolean"){k=g;m=1}var j=arguments[m];var l=arguments[m+1];if(l!==undefined){k[j]=l;return l}return k[j]};b.createDomBinder=function(k,m){var l={},n={};function o(q,p){return b.allocateSimpleId(p)+"-"+q}function j(r,q,p){l[o(r,q)]=p}n.locate=function(r,t){var p,q,s;p=m[r];q=t?t:k;if(!q){b.fail("DOM binder invoked for selector "+r+" without container")}if(!p){return q}if(typeof(p)==="function"){s=a(p.call(null,b.unwrap(q)))}else{s=a(p,q)}if(s.get(0)===document){s=[]}if(!s.selector){s.selector=p;s.context=q}s.selectorName=r;j(r,q,s);return s};n.fastLocate=function(q,t){var p=t?t:k;var r=o(q,p);var s=l[r];return s?s:n.locate(q,t)};n.clear=function(){l={}};n.refresh=function(s,t){var q=t?t:k;if(typeof s==="string"){s=[s]}if(q.length===undefined){q=[q]}for(var r=0;r<s.length;++r){for(var p=0;p<q.length;++p){n.locate(s[r],q[p])}}};return n};b.isArrayable=function(j){return typeof(j)!=="string"&&typeof(j.length)==="number"};b.mergeListeners=function(l,o){if(o){for(var k in o){var p=o[k];var q=k.indexOf(".");var n;if(q!==-1){n=k.substring(q+1);k=k.substring(0,q)}if(!l[k]){l[k]=b.event.getEventFirer()}var m=l[k];if(typeof(p)==="function"){m.addListener(p,n)}else{if(p&&b.isArrayable(p)){for(var j=0;j<p.length;++j){m.addListener(p[j],n)}}}}}};b.instantiateFirers=function(m,j){m.events={};if(j.events){for(var l in j.events){var k=j.events[l];m.events[l]=b.event.getEventFirer(k==="unicast",k==="preventable")}}b.mergeListeners(m.events,j.listeners)};b.mergeComponentOptions=function(k,j,m){var l=b.defaults(j);k.options=b.merge(l?l.mergePolicy:null,{},l,m)};b.expectFilledSelector=function(j,k){if(j&&j.length===0&&j.jquery){b.fail(k+': selector "'+j.selector+'" with name '+j.selectorName+" returned no results in context "+b.dumpEl(j.context))}};b.initView=function(k,j,m){var l={};b.expectFilledSelector(j,'Error instantiating component with name "'+k);b.mergeComponentOptions(l,k,m);if(j){l.container=b.container(j);b.initDomBinder(l)}b.instantiateFirers(l,l.options);return l};b.COMPONENT_OPTIONS={};b.VALUE={};b.emptySubcomponent=function(j){var l={};j=a.makeArray(j);for(var k=0;k<j.length;++k){l[j[k]]=function(){}}return l};b.initLittleComponent=function(k,j){var l={};b.mergeComponentOptions(l,k,j);return l};b.initSubcomponent=function(l,k,j){return b.initSubcomponents(l,k,j)[0]};b.initSubcomponents=function(p,q,r){var s=p.options[q];if(!s){return}var o=a.makeArray(s);var t=-1;var l=[];r=a.makeArray(r);for(var n=0;n<r.length;++n){if(r[n]===b.COMPONENT_OPTIONS){t=n}}for(n=0;n<o.length;++n){s=o[n];if(t!==-1&&s.options){r[t]=s.options}if(typeof(s)!=="function"){var m=typeof(s)==="string"?s:s.type;var j=b.defaults(true,m);b.merge("reverse",p.options,j);l[n]=m==="fluid.emptySubcomponent"?b.emptySubcomponent(s.options):b.invokeGlobalFunction(m,r,{fluid:b})}else{l[n]=s.apply(null,r)}var k=l[n]?l[n].returnedOptions:null;if(k){b.merge(p.options.mergePolicy,p.options,k);if(k.listeners){b.mergeListeners(p.events,k.listeners)}}}return l};b.initDomBinder=function(j){j.dom=b.createDomBinder(j.container,j.options.selectors);j.locate=j.dom.locate};b.isPrimitive=function(j){var k=typeof(j);return !j||k==="string"||k==="boolean"||k==="number"||k==="function"};function d(o,q,n,j){var r=o&&typeof(o)!=="string"?o[q]:o;if(typeof(r)==="function"){r.apply(null,n,j);return n}if(r==="replace"){b.clear(n)}for(var l in j){var s=(q?q+".":"")+l;var p=n[l];var m=j[l];var k=b.isPrimitive(p);if(m!==undefined){if(m!==null&&typeof m==="object"&&!m.nodeType&&!m.jquery&&m!==b.VALUE){if(k){n[l]=p=m instanceof Array?[]:{}}d(o,s,p,m)}else{if(p===null||p===undefined||r!=="reverse"){n[l]=m}}}}return n}b.merge=function(n,m){var r="";for(var l=2;l<arguments.length;++l){var j=arguments[l];if(j!==null&&j!==undefined){d(n,r,m,j)}}if(n&&typeof(n)!=="string"){for(var p in n){var q=n[p];if(typeof(q)==="string"&&q!=="replace"){var k=b.model.getBeanValue(m,p);if(k===null||k===undefined){var o=b.model.getBeanValue(m,q);b.model.setBeanValue(m,p,o)}}}}return m};b.freshContainer=function(j){return b.isArrayable(j)?[]:{}};b.copy=function(j){if(b.isPrimitive(j)){return j}return a.extend(true,b.freshContainer(j),j)};b.getGlobalValue=function(k,j){j=j||b.environment;return b.model.getBeanValue(c,k,j)};b.invokeGlobalFunction=function(k,l,j){var m=b.getGlobalValue(k,j);if(!m){b.fail("Error invoking global function: "+k+" could not be located")}else{return m.apply(null,l)}};b.registerGlobalFunction=function(j,l,k){k=k||b.environment;b.model.setBeanValue(c,j,l,k)};b.registerGlobal=b.registerGlobalFunction;b.registerNamespace=function(l,j){j=j||b.environment;var k=b.getGlobalValue(l,j);if(!k){k={};b.registerGlobal(l,k,j)}return k};b.event={};var e=1;b.event.getEventFirer=function(l,m){var k=b.log;var j={};return{addListener:function(p,o,n){if(!p){return}if(l){o="unicast"}if(!o){if(!p.$$guid){p.$$guid=e++}o=p.$$guid}j[o]={listener:p,predicate:n}},removeListener:function(n){if(typeof(n)==="string"){delete j[n]}else{if(typeof(n)==="object"&&n.$$guid){delete j[n.$$guid]}}},fire:function(){for(var p in j){var n=j[p];var q=n.listener;if(n.predicate&&!n.predicate(q,arguments)){continue}try{var o=q.apply(null,arguments);if(m&&o===false){return false}}catch(r){k("FireEvent received exception "+r.message+" e "+r+" firing to listener "+p);throw (r)}}}}};b.model={};b.model.copyModel=function(k,j){b.clear(k);a.extend(true,k,j)};b.model.parseEL=function(j){return String(j).split(".")};b.model.composePath=function(j,k){return j===""?k:j+"."+k};b.model.getPenultimate=function(l,p,j,n){var k=b.model.parseEL(p);for(var m=0;m<k.length-1;++m){if(!l){return l}var o=k[m];if(j&&j[o]){l=j[o];j=null}else{if(l[o]===undefined&&n){l[o]={}}l=l[o]}}return{root:l,last:k[k.length-1]}};b.model.setBeanValue=function(k,m,n,j){var l=b.model.getPenultimate(k,m,j,true);l.root[l.last]=n};b.model.getBeanValue=function(k,m,j){if(m===""||m===null||m===undefined){return k}var l=b.model.getPenultimate(k,m,j);return l.root?l.root[l.last]:l.root};var i;b.setLogging=function(j){if(typeof j==="boolean"){i=j}else{i=false}};b.log=function(j){if(i){j=b.renderTimestamp(new Date())+":  "+j;if(typeof(console)!=="undefined"){if(console.debug){console.debug(j)}else{console.log(j)}}else{if(typeof(YAHOO)!=="undefined"){YAHOO.log(j)}else{if(typeof(opera)!=="undefined"){opera.postError(j)}}}}};b.findAncestor=function(j,k){j=b.unwrap(j);while(j){if(k(j)){return j}j=j.parentNode}};b.jById=function(m,l){l=l&&l.nodeType===9?l:document;var j=b.byId(m,l);var k=j?a(j):[];k.selector="#"+m;k.context=l;return k};b.byId=function(l,k){k=k&&k.nodeType===9?k:document;var j=k.getElementById(l);if(j){if(j.getAttribute("id")!==l){b.fail("Problem in document structure - picked up element "+b.dumpEl(j)+" for id "+l+" without this id - most likely the element has a name which conflicts with this id")}return j}else{return null}};b.getId=function(j){return b.unwrap(j).getAttribute("id")};b.allocateSimpleId=function(j){j=b.unwrap(j);if(!j.id){j.id="fluid-id-"+(e++)}return j.id};function h(p,o,n,m){var k=p[n];for(var l=0;l<m.length-1;++l){k=m[l+1](k,n)}o[n]=k}b.transform=function(m){var l=b.freshContainer(m);if(b.isArrayable(m)){for(var k=0;k<m.length;++k){h(m,l,k,arguments)}}else{for(var j in m){h(m,l,j,arguments)}}return l};b.find=function(m,l,n){for(var k=0;k<m.length;++k){var j=l(m[k],k);if(j!==null&&j!==undefined){return j}}return n};b.accumulate=function(m,l,j){for(var k=0;k<m.length;++k){j=l(m[k],j,k)}return j};b.remove_if=function(l,k){for(var j=0;j<l.length;++j){if(k(l[j],j)){l.splice(j,1);--j}}return l};b.stringTemplate=function(n,k){var m=n;for(var l in k){var j="%"+l;m=m.replace(j,k[l])}return m}})(jQuery,fluid_1_2);var fluid_1_2=fluid_1_2||{};(function(c,b){b.dom=b.dom||{};var a=function(d){if(d.node.firstChild){d.node=d.node.firstChild;d.depth+=1;return d}while(d.node){if(d.node.nextSibling){d.node=d.node.nextSibling;return d}d.node=d.node.parentNode;d.depth-=1}return d};b.dom.iterateDom=function(h,g,f){var e={node:h,depth:0};var d=h;var i;while(e.node!==null&&e.depth>=0&&e.depth<b.dom.iterateDom.DOM_BAIL_DEPTH){i=null;if(e.node.nodeType===1||f){i=g(e.node,e.depth)}if(i){if(i==="delete"){e.node.parentNode.removeChild(e.node);e.node=d}else{if(i==="stop"){return e.node}}}d=e.node;e=a(e)}};b.dom.iterateDom.DOM_BAIL_DEPTH=256;b.dom.isContainer=function(d,e){for(;e;e=e.parentNode){if(d===e){return true}}return false};b.dom.getElementText=function(f){var d=f.childNodes;
var g="";for(var e=0;e<d.length;++e){var h=d[e];if(h.nodeType==3){g=g+h.nodeValue}}return g}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(c,b){var d=/(\\u[\dabcdef]{4}|\\x[\dabcdef]{2})/g;b.unescapeProperties=function(f){f=f.replace(d,function(j){var k=j.substring(2);var i=parseInt(k,16);return String.fromCharCode(i)});var h=0;while(true){var e=f.indexOf("\\",h);if(e===-1){break}if(e===f.length-1){return[f.substring(0,f.length-1),true]}var g=f.charAt(e+1);if(g==="n"){g="\n"}if(g==="r"){g="\r"}if(g==="t"){g="\t"}f=f.substring(0,e)+g+f.substring(e+2);h=e+1}return[f,false]};var a=/[^\\][\s:=]/;b.parseJavaProperties=function(l){var f={};l=l.replace(/\r\n/g,"\n");l=l.replace(/\r/g,"\n");lines=l.split("\n");var m,k,e,o,j;for(var g=0;g<lines.length;++g){var n=c.trim(lines[g]);if(!n||n.charAt(0)==="#"||n.charAt(0)==="!"){continue}if(!m){e="";var h=n.search(a);if(h===-1){k=n;o=""}else{k=c.trim(n.substring(0,h+1));o=c.trim(n.substring(h+2));if(o.charAt(0)===":"||o.charAt(0)==="="){o=c.trim(o.substring(1))}}k=b.unescapeProperties(k)[0];j=b.unescapeProperties(o)}else{j=b.unescapeProperties(n)}m=j[1];if(!j[1]){f[k]=e+j[0]}else{e+=j[0]}}return f};b.formatMessage=function(g,e){if(!e){return g}if(typeof(e)==="string"){e=[e]}for(var f=0;f<e.length;++f){g=g.replace("{"+f+"}",e[f])}return g}})(jQuery,fluid_1_2);var fluid_1_2=fluid_1_2||{};var fluid=fluid||fluid_1_2;(function(b,a){a.renderTimestamp=function(c){var d=function(f,g){if(!g){g=2}var e=(f==undefined?"":f.toString());return"00000".substring(5-g+e.length)+e};return d(c.getHours())+":"+d(c.getMinutes())+":"+d(c.getSeconds())+"."+d(c.getMilliseconds(),3)};a.dumpEl=function(d){var e;if(!d){return"null"}if(d.nodeType===3||d.nodeType===8){return"[data: "+d.data+"]"}if(d.nodeType===9){return"[document: location "+d.location+"]"}if(!d.nodeType&&a.isArrayable(d)){e="[";for(var c=0;c<d.length;++c){e+=a.dumpEl(d[c]);if(c<d.length-1){e+=", "}}return e+"]"}d=b(d);e=d.get(0).tagName;if(d.attr("id")){e+="#"+d.attr("id")}if(d.attr("class")){e+="."+d.attr("class")}return e}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(d,c){c.VALUE={};c.BINDING_ROOT_KEY="fluid-binding-root";c.findData=function(h,g){while(h){var i=d.data(h,g);if(i){return i}h=h.parentNode}};c.bindFossils=function(h,i,g){d.data(h,c.BINDING_ROOT_KEY,{data:i,fossils:g})};c.findForm=function(g){return c.findAncestor(g,function(h){return h.nodeName.toLowerCase()==="form"})};c.value=function(l,i){var j=c.unwrap(l);var o=false;if(j.nodeType===undefined&&j.length>1){j=j[0];o=true}var k=d(j);if("input"!==j.nodeName.toLowerCase()||!/radio|checkbox/.test(j.type)){return d(j).val(i)}var h=j.name;if(h===undefined){c.fail("Cannot acquire value from node "+c.dumpEl(j)+" which does not have name attribute set")}var g;if(o){g=l}else{var g=document.getElementsByName(h);var n=c.findForm(j);g=d.grep(g,function(p){if(p.name!==h){return false}return !n||c.dom.isContainer(n,p)})}if(i!==undefined){if(typeof(i)==="boolean"){i=(i?"true":"false")}d.each(g,function(){this.checked=(i instanceof Array?d.inArray(this.value,i)!==-1:i===this.value)})}else{var m=d.map(g,function(p){return p.checked?p.value:null});return j.type==="radio"?m[0]:m}};c.applyChange=function(l,m,i){l=c.unwrap(l);if(m===undefined){m=c.value(l)}if(l.nodeType===undefined&&l.length>0){l=l[0]}var g=c.findData(l,c.BINDING_ROOT_KEY);if(!g){c.fail("Bound data could not be discovered in any node above "+c.dumpEl(l))}var h=l.name;var j=g.fossils[h];if(!j){c.fail("No fossil discovered for name "+h+" in fossil record above "+c.dumpEl(l))}if(typeof(j.oldvalue)==="boolean"){m=m[0]?true:false}var k=g.fossils[h].EL;if(i){i.fireChangeRequest({path:k,value:m,source:l.id})}else{c.model.setBeanValue(g.data,k,m)}};c.pathUtil={};var f=function(j,m,h){var k=null;if(j){k=""}var l=false;var g=m.length;for(;h<g;++h){var n=m.charAt(h);if(!l){if(n==="."){break}else{if(n==="\\"){l=true}else{if(k!==null){k+=n}}}}else{l=false;if(k!==null){j+=n}}}if(k!==null){j[0]=k}return h};var a=[];c.pathUtil.getPathSegment=function(h,g){f(a,h,g);return a[0]};c.pathUtil.getHeadPath=function(g){return c.pathUtil.getPathSegment(g,0)};c.pathUtil.getFromHeadPath=function(h){var g=f(null,h,0);return g===h.length?null:h.substring(g+1)};function e(g){return g.lastIndexOf(".")}c.pathUtil.getToTailPath=function(h){var g=e(h);return g==-1?null:h.substring(0,g)};c.pathUtil.getTailPath=function(h){var g=e(h);return c.pathUtil.getPathSegment(h,g+1)};var b=function(j,h){for(var g=0;g<h.length;++g){var k=h.charAt(g);if(k==="."||k==="\\"||k==="}"){j+="\\"}j+=k}return j};c.pathUtil.composePath=function(g,h){if(g.length!==0){g+="."}return b(g,h)};c.pathUtil.matchPath=function(g,j){var i="";while(true){if(!g){break}if(!j){return null}var h=c.pathUtil.getHeadPath(g);var k=c.pathUtil.getHeadPath(j);if(h!=="*"&&h!==k){return null}i=c.pathUtil.composePath(i,k);g=c.pathUtil.getFromHeadPath(g);j=c.pathUtil.getFromHeadPath(j)}return i};c.model.applyChangeRequest=function(h,k){if(k.type==="ADD"){c.model.setBeanValue(h,k.path,k.value)}else{if(k.type==="DELETE"){var i=c.pathUtil.getToTailPath(k.path);var g=c.pathUtil.getTailPath(k.path);var j=c.model.getBeanValue(h,j);delete j[g]}}};c.model.bindRequestChange=function(g){g.requestChange=function(k,j,h){var i={path:k,value:j,type:h};g.fireChangeRequest(i)}};c.makeChangeApplier=function(h){var i={guards:c.event.getEventFirer(false,true),modelChanged:c.event.getEventFirer(false,false)};var j={model:h};function k(l,m){return function(p,n){var o=n[m];return c.pathUtil.matchPath(p[l],o.path)}}function g(o,n,m,p){var l=k(m,p);o[n]={addListener:function(q,s,r){s[m]=q;i[n].addListener(s,r,l)},removeListener:function(q){i[n].removeListener(q)}}}g(j,"guards","guardedPathSpec",1);g(j,"modelChanged","triggerPathSpec",2);j.fireChangeRequest=function(m){if(!m.type){m.type="ADD"}var l=i.guards.fire(h,m);if(l===false){return}var n={};c.model.copyModel(n,h);c.model.applyChangeRequest(h,m);i.modelChanged.fire(h,n,m)};c.model.bindRequestChange(j);return j};c.makeSuperApplier=function(){var h=[];var g={};g.addSubApplier=function(i,j){h.push({path:i,subApplier:j})};g.fireChangeRequest=function(m){for(var l=0;l<h.length;++l){var n=h[l].path;if(m.path.indexOf(n)===0){var k=m.path.substring(n.length+1);var j=c.copy(m);j.path=k;h[l].subApplier.fireChangeRequest(j)}}};return g};c.attachModel=function(g,n,l){var j=c.model.parseEL(n);for(var m=0;m<j.length-1;++m){var h=j[m];var k=g[h];if(!k){g[h]=k={}}g=k}g[j[j.length-1]]=l};c.assembleModel=function(g){var h={};var j=c.makeSuperApplier();var i={model:h,applier:j};for(path in g){var k=g[path];c.attachModel(h,path,k.model);if(k.applier){j.addSubApplier(path,k.applier)}}return i}})(jQuery,fluid_1_2);var fluid_1_2=fluid_1_2||{};var fluid=fluid||fluid_1_2;(function(t,p){p.thatistBridge=function(L,N){var M=function(O){var Q=O.split(".");var P=N;for(var T=0;T<Q.length;++T){P=P[Q[T]]}var S=[this];if(arguments.length===2){S=S.concat(t.makeArray(arguments[1]))}var R=P.apply(null,S);this.that=function(){return R};var U=typeof(R);return !R||U==="string"||U==="number"||U==="boolean"||R&&R.length!==undefined?R:this};t.fn[L]=M;return M};p.thatistBridge("fluid",p);p.thatistBridge("fluid_1_2",fluid_1_2);var J="fluid-keyboard-a11y";var j=function(N,L){var M=t(N).data(J);return M?M[L]:undefined};var l=function(N,L,M){t(N).each(function(){var O=t.data(this,J)||{};O[L]=M;t.data(this,J,O)})};var m="disabled";if(t.event.special.focusin){m=null;t(document).bind("focusin",function(L){m=L.target})}p.getLastFocusedElement=function(){if(m==="disabled"){p.fail("Focus manager not enabled - please include jquery.delegate.js or equivalent for support of 'focusin' event")}return m};var I=function(){return t.browser.msie?"tabIndex":"tabindex"};var u=function(L){if(L.length<=0){return false}return t(L[0]).is("a, input, button, select, area, textarea, object")};var x=function(M){if(M.length<=0){return undefined}if(!p.tabindex.hasAttr(M)){return u(M)?Number(0):undefined}var L=M.attr(I());return Number(L)};var v=function(L,M){return L.each(function(N,O){t(O).attr(I(),M)})};p.tabindex=function(M,L){M=t(M);if(L!==null&&L!==undefined){return v(M,L)}else{return x(M)}};p.tabindex.remove=function(L){L=t(L);return L.each(function(M,N){t(N).removeAttr(I())})};p.tabindex.hasAttr=function(M){M=t(M);if(M.length<=0){return false}var L=M.map(function(){var N=this.getAttributeNode(I());return N?N.specified:false});return L.length===1?L[0]:L};p.tabindex.has=function(L){L=t(L);return p.tabindex.hasAttr(L)||u(L)};var g="enablement";p.enabled=function(M,L){M=t(M);if(L===undefined){return j(M,g)!==false}else{t("*",M).each(function(){if(j(this,g)!==undefined){l(this,g,L)}else{if(/select|textarea|input/i.test(this.nodeName)){t(this).attr("disabled",!L)}}});l(M,g,L)}};p.a11y=t.a11y||{};p.a11y.orientation={HORIZONTAL:0,VERTICAL:1,BOTH:2};var d={next:t.ui.keyCode.DOWN,previous:t.ui.keyCode.UP};var q={next:t.ui.keyCode.RIGHT,previous:t.ui.keyCode.LEFT};var b=function(L){return L.jquery?L[0]:L};var n=function(L){L.each(function(M,N){N=t(N);if(!N.fluid("tabindex.has")||N.fluid("tabindex")<0){N.fluid("tabindex",0)}})};p.tabbable=function(L){L=t(L);n(L)};var D="selectionContext";var B=-32768;var k=function(L){if(L.options.onLeaveContainer){L.options.onLeaveContainer(L.selectables[L.activeItemIndex])}else{if(L.options.onUnselect){L.options.onUnselect(L.selectables[L.activeItemIndex])}}if(!L.options.rememberSelectionState){L.activeItemIndex=B}};var f=function(L,M){if(M){M(L)}};var w=function(M,L){if(L&&M){L(M)}};var i=function(M,L){w(M,L.options.onUnselect)};var s=function(L,M){i(M.selectedElement(),M);L=b(L);var N=M.selectables.index(L);if(N===-1){return}M.activeItemIndex=N;f(L,M.options.onSelect)};var G=function(L){return function(M){t(M.target).fluid("tabindex",0);s(M.target,L);return M.stopPropagation()}};var r=function(L){return function(M){t(M.target).fluid("tabindex",L.options.selectablesTabindex);i(M.target,L);return M.stopPropagation()}};var K=function(L){var M=L.selectables;if(L.activeItemIndex>=M.length){L.activeItemIndex=0
}if(L.activeItemIndex<0&&L.activeItemIndex!==B){L.activeItemIndex=M.length-1}if(L.activeItemIndex>=0){t(M[L.activeItemIndex]).focus()}};var c=function(L){var M=L.selectedElement();if(M){M.blur()}i(L.selectedElement(),L);if(L.activeItemIndex===B){L.activeItemIndex=-1}};var o=function(L){c(L);++L.activeItemIndex;K(L)};var e=function(L){c(L);--L.activeItemIndex;K(L)};var z=function(L,N,M){return function(O){if(O.which===N.next){o(L);O.preventDefault()}else{if(O.which===N.previous){e(L);O.preventDefault()}}}};var E=function(L){var M;if(L===p.a11y.orientation.HORIZONTAL){M=q}else{if(L===p.a11y.orientation.VERTICAL){M=d}}return M};var H=function(L){return function(M){if(M.which!==t.ui.keyCode.TAB){return}k(L);if(M.shiftKey){L.focusIsLeavingContainer=true}}};var y=function(L){return function(M){var O=L.options.autoSelectFirstItem;var N=typeof(O)==="function"?O():O;if(L.focusIsLeavingContainer){N=false}if(N&&M.target===L.container.get(0)){if(L.activeItemIndex===B){L.activeItemIndex=0}t(L.selectables[L.activeItemIndex]).focus()}return M.stopPropagation()}};var a=function(L){return function(M){L.focusIsLeavingContainer=false;return M.stopPropagation()}};var A=function(M,P,Q){var N=t.extend(true,{},P,Q);var R=E(N.direction);var L=N.selectableElements?N.selectableElements:M.find(N.selectableSelector);var O={container:M,activeItemIndex:B,selectables:L,focusIsLeavingContainer:false,options:N};O.selectablesUpdated=function(S){if(typeof(O.options.selectablesTabindex)==="number"){O.selectables.fluid("tabindex",O.options.selectablesTabindex)}O.selectables.unbind("focus."+J);O.selectables.unbind("blur."+J);O.selectables.bind("focus."+J,G(O));O.selectables.bind("blur."+J,r(O));if(S){s(S,O)}else{K(O)}};O.refresh=function(){if(!O.options.selectableSelector){throw ("Cannot refresh selectable context which was not initialised by a selector")}O.selectables=M.find(N.selectableSelector);O.selectablesUpdated()};O.selectedElement=function(){return O.activeItemIndex<0?null:O.selectables[O.activeItemIndex]};if(R){M.keydown(z(O,R))}M.keydown(H(O));M.focus(y(O));M.blur(a(O));O.selectablesUpdated();return O};p.selectable=function(N,L){N=t(N);var M=A(N,p.selectable.defaults,L);l(N,D,M);return M};p.selectable.select=function(M,L){t(L).focus()};p.selectable.selectNext=function(L){L=t(L);o(j(L,D))};p.selectable.selectPrevious=function(L){L=t(L);e(j(L,D))};p.selectable.currentSelection=function(M){M=t(M);var L=j(M,D);return t(L.selectedElement())};p.selectable.defaults={direction:p.a11y.orientation.VERTICAL,selectablesTabindex:-1,autoSelectFirstItem:true,rememberSelectionState:true,selectableSelector:".selectable",selectableElements:null,onSelect:null,onUnselect:null,onLeaveContainer:null};var h=function(Q,M){if(!Q.modifier){return true}var N=Q.modifier;var O=N&&M.ctrlKey;var L=N&&M.altKey;var P=N&&M.shiftKey;return O||L||P};var F=function(L){return function(M){var P=M.target;if(!p.enabled(M.target)){return}var O=M.which?M.which:M.keyCode;if(O===L.key&&L.activateHandler&&h(L,M)){var N=t.Event("fluid-activate");t(M.target).trigger(N,[L.activateHandler]);if(N.isDefaultPrevented()){M.preventDefault()}}}};var C=function(O,R,L,M){var Q=[];t(L).each(function(S,T){Q.push({modifier:null,key:T,activateHandler:R})});if(M&&M.additionalBindings){Q=Q.concat(M.additionalBindings)}l(O,g,true);for(var N=0;N<Q.length;++N){var P=Q[N];O.keydown(F(P))}O.bind("fluid-activate",function(S,T){T=T||R;return T?T(S):null})};p.activatable=function(N,M,L){N=t(N);C(N,M,p.activatable.defaults.keys,L)};p.activate=function(L){t(L).trigger("fluid-activate")};p.activatable.defaults={keys:[t.ui.keyCode.ENTER,t.ui.keyCode.SPACE]}})(jQuery,fluid_1_2);XMLP=function(a){this.m_xml=a;this.m_iP=0;this.m_iState=XMLP._STATE_PROLOG;this.m_stack=[];this.m_attributes={};this.m_emitSynthetic=false};XMLP.closedTags={abbr:true,br:true,col:true,img:true,input:true,link:true,meta:true,param:true,hr:true,area:true,embed:true};XMLP._NONE=0;XMLP._ELM_B=1;XMLP._ELM_E=2;XMLP._ELM_EMP=3;XMLP._ATT=4;XMLP._TEXT=5;XMLP._ENTITY=6;XMLP._PI=7;XMLP._CDATA=8;XMLP._COMMENT=9;XMLP._DTD=10;XMLP._ERROR=11;XMLP._CONT_XML=0;XMLP._CONT_ALT=1;XMLP._ATT_NAME=0;XMLP._ATT_VAL=1;XMLP._STATE_PROLOG=1;XMLP._STATE_DOCUMENT=2;XMLP._STATE_MISC=3;XMLP._errs=[];XMLP._errs[XMLP.ERR_CLOSE_PI=0]="PI: missing closing sequence";XMLP._errs[XMLP.ERR_CLOSE_DTD=1]="DTD: missing closing sequence";XMLP._errs[XMLP.ERR_CLOSE_COMMENT=2]="Comment: missing closing sequence";XMLP._errs[XMLP.ERR_CLOSE_CDATA=3]="CDATA: missing closing sequence";XMLP._errs[XMLP.ERR_CLOSE_ELM=4]="Element: missing closing sequence";XMLP._errs[XMLP.ERR_CLOSE_ENTITY=5]="Entity: missing closing sequence";XMLP._errs[XMLP.ERR_PI_TARGET=6]="PI: target is required";XMLP._errs[XMLP.ERR_ELM_EMPTY=7]="Element: cannot be both empty and closing";XMLP._errs[XMLP.ERR_ELM_NAME=8]='Element: name must immediatly follow "<"';XMLP._errs[XMLP.ERR_ELM_LT_NAME=9]='Element: "<" not allowed in element names';XMLP._errs[XMLP.ERR_ATT_VALUES=10]="Attribute: values are required and must be in quotes";XMLP._errs[XMLP.ERR_ATT_LT_NAME=11]='Element: "<" not allowed in attribute names';XMLP._errs[XMLP.ERR_ATT_LT_VALUE=12]='Attribute: "<" not allowed in attribute values';XMLP._errs[XMLP.ERR_ATT_DUP=13]="Attribute: duplicate attributes not allowed";XMLP._errs[XMLP.ERR_ENTITY_UNKNOWN=14]="Entity: unknown entity";XMLP._errs[XMLP.ERR_INFINITELOOP=15]="Infinite loop";XMLP._errs[XMLP.ERR_DOC_STRUCTURE=16]="Document: only comments, processing instructions, or whitespace allowed outside of document element";XMLP._errs[XMLP.ERR_ELM_NESTING=17]="Element: must be nested correctly";XMLP.prototype._checkStructure=function(c){var a=this.m_stack;if(XMLP._STATE_PROLOG==this.m_iState){this.m_iState=XMLP._STATE_DOCUMENT}if(XMLP._STATE_DOCUMENT===this.m_iState){if((XMLP._ELM_B==c)||(XMLP._ELM_EMP==c)){this.m_stack[a.length]=this.getName()}if((XMLP._ELM_E==c)||(XMLP._ELM_EMP==c)){if(a.length===0){return XMLP._NONE}var b=a[a.length-1];this.m_stack.length--;if(b===null||b!==this.getName()){return this._setErr(XMLP.ERR_ELM_NESTING)}}}return c};XMLP.prototype.getColumnNumber=function(){return SAXStrings.getColumnNumber(this.m_xml,this.m_iP)};XMLP.prototype.getContent=function(){return(this.m_cSrc==XMLP._CONT_XML)?this.m_xml:this.m_cAlt};XMLP.prototype.getContentBegin=function(){return this.m_cB};XMLP.prototype.getContentEnd=function(){return this.m_cE};XMLP.prototype.getLineNumber=function(){return SAXStrings.getLineNumber(this.m_xml,this.m_iP)};XMLP.prototype.getName=function(){return this.m_name};XMLP.prototype.next=function(){return this._checkStructure(this._parse())};XMLP.prototype._parse=function(){var d=this.m_iP;var a=this.m_xml;if(d===a.length){return XMLP._NONE}var e=a.charAt(d);if(e==="<"){var b=a.charAt(d+1);if(b==="?"){return this._parsePI(d+2)}else{if(b==="!"){if(d===a.indexOf("<!DOCTYPE",d)){return this._parseDTD(d+9)}else{if(d===a.indexOf("<!--",d)){return this._parseComment(d+4)}else{if(d===a.indexOf("<![CDATA[",d)){return this._parseCDATA(d+9)}}}}else{return this._parseElement(d+1)}}}else{return this._parseText(d)}};(function(){nameRegex=/([^\s\/>]+)/g;attrStartRegex=/\s*([\w:_][\w:_\-\.]*)/gm;attrValRegex=/\"([^\"]*)\"\s*/gm;attrValIERegex=/([^\>\s]+)\s*/gm;closeRegex=/\s*<\//g;XMLP.prototype._parseElement=function(m){var j,d,g;var n,e,a;d=j=this.m_xml.indexOf(">",m);if(j==-1){return this._setErr(XMLP.ERR_CLOSE_ELM)}if(this.m_xml.charAt(m)=="/"){n=XMLP._ELM_E;m++}else{n=XMLP._ELM_B}if(this.m_xml.charAt(j-1)=="/"){if(n==XMLP._ELM_E){return this._setErr(XMLP.ERR_ELM_EMPTY)}n=XMLP._ELM_EMP;d--}nameRegex.lastIndex=m;var k=nameRegex.exec(this.m_xml);if(!k){return this._setErr(XMLP.ERR_ELM_NAME)}e=k[1].toLowerCase();if("li"===e&&n!==XMLP._ELM_E&&this.m_stack.length>0&&this.m_stack[this.m_stack.length-1]==="li"&&!this.m_emitSynthetic){this.m_name="li";this.m_emitSynthetic=true;return XMLP._ELM_E}this.m_attributes={};this.m_cAlt="";if(nameRegex.lastIndex<d){this.m_iP=nameRegex.lastIndex;while(this.m_iP<d){attrStartRegex.lastIndex=this.m_iP;var c=attrStartRegex.exec(this.m_xml);if(!c){return this._setErr(XMLP.ERR_ATT_VALUES)}var h=c[1].toLowerCase();var l;if(this.m_xml.charCodeAt(attrStartRegex.lastIndex)===61){var b=this.m_xml.charCodeAt(attrStartRegex.lastIndex+1)===34?attrValRegex:attrValIERegex;b.lastIndex=attrStartRegex.lastIndex+1;c=b.exec(this.m_xml);if(!c){return this._setErr(XMLP.ERR_ATT_VALUES)}l=c[1]}else{l=h;b=attrStartRegex}if(!this.m_attributes[h]){this.m_attributes[h]=l}else{return this._setErr(XMLP.ERR_ATT_DUP)}this.m_iP=b.lastIndex}}if(e.indexOf("<")!=-1){return this._setErr(XMLP.ERR_ELM_LT_NAME)}this.m_name=e;this.m_iP=j+1;if(XMLP.closedTags[e]){closeRegex.lastIndex=j+1;var f=closeRegex.exec;if(f){var i=this.m_xml.indexOf(e,f.lastIndex);if(i===f.lastIndex){return n}else{return XMLP._ELM_EMP}}}this.m_emitSynthetic=false;return n}})();XMLP.prototype._parseCDATA=function(a){var b=this.m_xml.indexOf("]]>",a);if(b==-1){return this._setErr(XMLP.ERR_CLOSE_CDATA)}this._setContent(XMLP._CONT_XML,a,b);this.m_iP=b+3;return XMLP._CDATA};XMLP.prototype._parseComment=function(a){var b=this.m_xml.indexOf("-->",a);if(b==-1){return this._setErr(XMLP.ERR_CLOSE_COMMENT)}this._setContent(XMLP._CONT_XML,a-4,b+3);this.m_iP=b+3;return XMLP._COMMENT};XMLP.prototype._parseDTD=function(b){var e,a,c,d;e=this.m_xml.indexOf(">",b);if(e==-1){return this._setErr(XMLP.ERR_CLOSE_DTD)}c=this.m_xml.indexOf("[",b);a=((c!=-1)&&(c<e))?"]>":">";while(true){if(e==d){return this._setErr(XMLP.ERR_INFINITELOOP)}d=e;e=this.m_xml.indexOf(a,b);if(e==-1){return this._setErr(XMLP.ERR_CLOSE_DTD)}if(this.m_xml.substring(e-1,e+2)!="]]>"){break}}this.m_iP=e+a.length;return XMLP._DTD};XMLP.prototype._parsePI=function(b){var e,a,d,f,c;e=this.m_xml.indexOf("?>",b);if(e==-1){return this._setErr(XMLP.ERR_CLOSE_PI)}a=SAXStrings.indexOfNonWhitespace(this.m_xml,b,e);if(a==-1){return this._setErr(XMLP.ERR_PI_TARGET)}d=SAXStrings.indexOfWhitespace(this.m_xml,a,e);if(d==-1){d=e}f=SAXStrings.indexOfNonWhitespace(this.m_xml,d,e);if(f==-1){f=e}c=SAXStrings.lastIndexOfNonWhitespace(this.m_xml,f,e);
if(c==-1){c=e-1}this.m_name=this.m_xml.substring(a,d);this._setContent(XMLP._CONT_XML,f,c+1);this.m_iP=e+2;return XMLP._PI};XMLP.prototype._parseText=function(a){var b=this.m_xml.indexOf("<",a);if(b==-1){b=this.m_xml.length}this._setContent(XMLP._CONT_XML,a,b);this.m_iP=b;return XMLP._TEXT};XMLP.prototype._setContent=function(b){var a=arguments;if(XMLP._CONT_XML==b){this.m_cAlt=null;this.m_cB=a[1];this.m_cE=a[2]}else{this.m_cAlt=a[1];this.m_cB=0;this.m_cE=a[1].length}this.m_cSrc=b};XMLP.prototype._setErr=function(b){var a=XMLP._errs[b];this.m_cAlt=a;this.m_cB=0;this.m_cE=a.length;this.m_cSrc=XMLP._CONT_ALT;return XMLP._ERROR};SAXStrings={};SAXStrings.WHITESPACE=" \t\n\r";SAXStrings.QUOTES="\"'";SAXStrings.getColumnNumber=function(d,c){if(!d){return -1}c=c||d.length;var a=d.substring(0,c).split("\n");a.length--;var b=a.join("\n").length;return c-b};SAXStrings.getLineNumber=function(b,a){if(!b){return -1}a=a||b.length;return b.substring(0,a).split("\n").length};SAXStrings.indexOfNonWhitespace=function(f,a,d){if(!f){return -1}a=a||0;d=d||f.length;for(var b=a;b<d;++b){var e=f.charAt(b);if(e!==" "&&e!=="\t"&&e!=="\n"&&e!=="\r"){return b}}return -1};SAXStrings.indexOfWhitespace=function(d,a,c){if(!d){return -1}a=a||0;c=c||d.length;for(var b=a;b<c;b++){if(SAXStrings.WHITESPACE.indexOf(d.charAt(b))!=-1){return b}}return -1};SAXStrings.lastIndexOfNonWhitespace=function(d,a,c){if(!d){return -1}a=a||0;c=c||d.length;for(var b=c-1;b>=a;b--){if(SAXStrings.WHITESPACE.indexOf(d.charAt(b))==-1){return b}}return -1};SAXStrings.replace=function(e,a,d,c,b){if(!e){return""}a=a||0;d=d||e.length;return e.substring(a,d).split(c).join(b)};fluid_1_2=fluid_1_2||{};(function(b,c){c.parseTemplate=function(R,O,x,E,F){F=F||{};var C;var o;var G;var s=0;var l=0;var D=false;var H=-1;var P=-1;var n=F;var O;var w=false;var r=[];var q=[];XMLLump=function(T,t){return{nestingdepth:t,lumpindex:T,parent:C}};function M(V,t,U){C.rootlump=XMLLump(0,-1);G=[C.rootlump];s=0;l=0;D=false;H=-1;P=-1;O=V;w=t;r=U;if(r){for(var T=0;T<r.length;++T){q[T]=[];r[T].tree=c.parseSelector(r[T].selector)}}}function B(){for(var t=G.length-1;t>=0;--t){var T=G[t];if(T.rsfID!==undefined){return T}}return C.rootlump}function Q(){var t=XMLLump(s,l);if(w){t.line=o.getLineNumber();t.column=o.getColumnNumber()}C.lumps[s]=t;++s;return t}function v(T,t,U){var V=T[t];if(!V){V=[];T[t]=V}V[V.length]=U}function J(t,T){if(t.indexOf("scr=contribute-")!==-1){var U=t.substring("scr=contribute-".length);v(C.collectmap,U,T)}}function u(t){return"<"+t.tagname+">"}function z(T,t){if(!t){return false}return(" "+t+" ").indexOf(" "+T+" ")!==-1}function j(U,V){if(U.predList){for(var T=0;T<U.predList.length;++T){var t=U.predList[T];if(t.id&&V.attributemap.id!==t.id){return false}if(t.clazz&&!z(t.clazz,V.attributemap["class"])){return false}if(t.tag&&V.tagname!==t.tag){return false}}return true}}function K(Z){var W=undefined;if(r){for(var U=0;U<r.length;++U){var X=r[U];var Y=q[U];var t=Y.length;if(t<X.tree.length){var T=X.tree[t];if(t>0){if(X.tree[t-1].child&&Y[t-1]!==Z.nestingdepth-1){continue}}var V=j(T,Z);if(V){Y[Y.length]=Z.nestingdepth;if(Y.length===X.tree.length){if(W!==undefined){c.fail("Cutpoint specification error - node "+u(Z)+" has already matched with rsf:id of "+W)}if(X.id===undefined||X.id===null){c.fail("Error in cutpoints list - entry at position "+U+" does not have an id set")}W=X.id}}}}}return W}function k(){if(r){for(var t=0;t<r.length;++t){var T=q[t];if(T.length>0&&T[T.length-1]===l){T.length--}}}}function m(aa,ae){++l;if(D){D=false;var W=Q();W.nestingdepth--}if(C.firstdocumentindex===-1){C.firstdocumentindex=s}var Z=Q();var t=G[G.length-1];Z.uplump=t;var ac=o.getName();Z.tagname=ac;var ad=Z.attributemap=o.m_attributes;var ab=ad[c.ID_ATTRIBUTE];if(ab===undefined){ab=K(Z)}for(var V in ad){var Y=ad[V];if(ab===undefined){if(/href|src|codebase|action/.test(V)){ab="scr=rewrite-url"}else{if(ab===undefined&&/for|headers/.test(V)){ab="scr=null"}}}}if(ab){if(ab.charCodeAt(0)===126){ab=ab.substring(1);Z.elide=true}J(ab,Z);Z.rsfID=ab;var U=B();if(!U.downmap){U.downmap={}}v(U.downmap,ab,Z);v(C.globalmap,ab,Z);var T=ab.indexOf(":");if(T!==-1){var X=ab.substring(0,T);if(!t.finallump){t.finallump={}}t.finallump[X]=Z}}Z.text="<"+ac+c.dumpAttributes(ad)+(aa&&!ab?"/>":">");G[G.length]=Z;if(aa){if(ab){p()}else{--l;G.length--}}}function p(){k();var t=Q();--l;t.text="</"+o.getName()+">";var T=G[G.length-1];T.close_tag=C.lumps[s-1];G.length--;D=true}function A(){if(H!==-1){if(C.firstdocumentindex===-1){C.firstdocumentindex=s}var T=o.getContent().substr(H,P-H);D=false;var t=Q();t.text=T;H=-1}}C=c.XMLViewTemplate();M(O,F.debugMode,E);var S=R.indexOf(c.ID_ATTRIBUTE);if(x){var L=R.indexOf(">",S);o=new XMLP(R.substring(L+1))}else{o=new XMLP(R)}parseloop:while(true){var N=o.next();switch(N){case XMLP._ELM_B:A();m(false,"");break;case XMLP._ELM_E:A();p();break;case XMLP._ELM_EMP:A();m(true,"");break;case XMLP._PI:case XMLP._DTD:H=-1;continue;case XMLP._TEXT:case XMLP._ENTITY:case XMLP._CDATA:case XMLP._COMMENT:if(H===-1){H=o.m_cB}P=o.m_cE;break;case XMLP._ERROR:c.setLogging(true);var y="Error parsing template: "+o.m_cAlt+" at line "+o.getLineNumber();c.log(y);c.log("Just read: "+o.m_xml.substring(o.m_iP-30,o.m_iP));c.log("Still to read: "+o.m_xml.substring(o.m_iP,o.m_iP+30));c.fail(y);break parseloop;case XMLP._NONE:break parseloop}}A();var I=G.length-1;if(I){c.fail("Error parsing template - unclosed tag(s) of depth "+(I)+": "+c.transform(G.splice(1,I),function(t){return u(t)}).join(", "))}return C};c.debugLump=function(k){var j=k.text;j+=" at ";j+="lump line "+k.line+" column "+k.column+" index "+k.lumpindex;j+=k.parent.href===null?"":" in file "+k.parent.href;return j};c.ID_ATTRIBUTE="rsf:id";c.getPrefix=function(k){var j=k.indexOf(":");return j===-1?k:k.substring(0,j)};c.SplitID=function(l){var k={};var j=l.indexOf(":");if(j===-1){k.prefix=l}else{k.prefix=l.substring(0,j);k.suffix=l.substring(j+1)}return k};c.XMLViewTemplate=function(){return{globalmap:{},collectmap:{},lumps:[],firstdocumentindex:-1}};c.fetchResources=function(m,p){var q=function(s){return{success:function(t){s.resourceText=t;s.resourceKey=s.href;s.queued=false;c.fetchResources(m,p)},error:function(t,v,u){s.fetchError={status:t.status,textStatus:t.textStatus,errorThrown:u};s.queued=false;c.fetchResources(m,p)}}};var k=true;for(var o in m){var n=m[o];if(n.href&&!(n.resourceKey||n.fetchError)){if(!n.queued){var j=q(n);var r={url:n.href,success:j.success,error:j.error};b.extend(true,r,n.options);n.queued=true;b.ajax(r)}if(n.queued){k=false}}else{if(n.nodeId&&!n.resourceText){var l=document.getElementById(n.nodeId);n.resourceText=c.dom.getElementText(l);n.resourceKey=n.nodeId}}}if(k&&!m.callbackCalled){m.callbackCalled=true;if(b.browser.mozilla){setTimeout(function(){p(m)},1)}else{p(m)}}};c.XMLEncode=function(j){return j.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};c.dumpAttributes=function(j){var l="";for(var m in j){var k=j[m];if(k!==null&&k!==undefined){l+=" "+m+'="'+k+'"'}}return l};c.aggregateMMap=function(m,l){for(var j in l){var k=m[j];if(!k){m[j]=[]}m[j]=m[j].concat(l[j])}};c.parseTemplates=function(n,p,j){var l=[];j=j||{};l.globalmap={};for(var o=0;o<p.length;++o){var m=n[p[o]];var q=m.href.lastIndexOf("/");var k=q===-1?"":m.href.substring(0,q+1);var r=c.parseTemplate(m.resourceText,k,j.scanStart&&o===0,m.cutpoints,j);if(o===0){c.aggregateMMap(l.globalmap,r.globalmap)}r.href=m.href;r.baseURL=k;r.resourceKey=m.resourceKey;l[o]=r;c.aggregateMMap(l.globalmap,r.rootlump.downmap)}return l};var e="(?:[\\w\u0128-\uFFFF*_-]|\\\\.)";var d=new RegExp("^>\\s*("+e+"+)");var a=new RegExp("^("+e+"+)(#)("+e+"+)");var h=new RegExp("^s*([#.]?)("+e+"*)");var f=new RegExp("([#.]?)("+e+"+)","g");var g=new RegExp("\\s*(>)?\\s*","g");var i=new RegExp("^\\w*$");c.parseSelector=function(p){var k=[];p=b.trim(p);f.lastIndex=0;var o=0;while(true){var m=[];while(true){var s=f.exec(p);if(!s||s.index!==o){break}var n={};var r=s[2];if(s[1]===""){n.tag=r}else{if(s[1]==="#"){n.id=r}else{if(s[1]==="."){n.clazz=r}}}m[m.length]=n;o=f.lastIndex}g.lastIndex=o;var j={predList:m};var l=g.exec(p);if(!l||l.index!==o){var q=p.substring(o);c.fail("Error in selector string - can not match child selector expression at "+q)}if(l[1]===">"){j.child=true}k[k.length]=j;if(g.lastIndex>=p.length){break}o=g.lastIndex;f.lastIndex=g.lastIndex}return k}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(g,j){function o(p){return"as child of "+(p.parent.fullID?"component with full ID "+p.parent.fullID:"root")}function i(s){var u="";var q=s;if(s.children===undefined){u=s.ID+(s.localID!==undefined?s.localID:"");q=s.parent}while(q.parent){var t=q.parent;if(q.fullID!==undefined){u=q.fullID+u;return u}if(q.noID===undefined){var p=q.ID;if(p===undefined){j.fail("Error in component tree - component found with no ID "+o(t)+": please check structure")}var r=p.indexOf(":");var v=r===-1?p:p.substring(0,r);u=v+":"+(q.localID===undefined?"":q.localID)+":"+u}q=t}return u}var l={};l.isBoundPrimitive=function(p){return j.isPrimitive(p)||p instanceof Array&&(p.length===0||typeof(p[0])==="string")};function b(r,q){if(l.isBoundPrimitive(r)){return{componentType:"UIBound",value:r,ID:q}}else{var p=f(r);if(p.ID){return{ID:q,componentType:"UIContainer",children:[p]}}else{p.ID=q;return p}}}function e(r){if(!(r instanceof Array)){var s=[];for(var q in r){var t=r[q];if(t instanceof Array){for(var p=0;p<t.length;++p){var u=b(t[p],q);s[s.length]=u}}else{s[s.length]=b(t,q)}}return s}else{return r}}function c(p,q){if(p.value===undefined&&p.valuebinding!==undefined){if(!q){j.fail("Cannot perform value fixup for valuebinding "+p.valuebinding+" since no model was supplied to rendering")}p.value=j.model.getBeanValue(q,p.valuebinding)}}function n(q,r,p){if(q[r]!==undefined){if(l.isBoundPrimitive(q[r])){q[r]={value:q[r]}}else{if(q[r].messagekey){q[r].componentType="UIMessage"}}}else{q[r]={value:null}}c(q[r],p)}var k={children:"UIContainer",value:"UIBound",valuebinding:"UIBound",messagekey:"UIMessage",markup:"UIVerbatim",selection:"UISelect",target:"UILink",choiceindex:"UISelectChoice",functionname:"UIInitBlock"};
l.inferComponentType=function(p){for(var q in k){if(p[q]!==undefined){p.componentType=k[q];break}}if(p.componentType===undefined&&p.ID!==undefined){p.componentType="UIBound"}};function f(s,r){if(s){l.inferComponentType(s)}if(!s||s.componentType===undefined){var q=s.decorators;if(q){delete s.decorators}s={componentType:"UIContainer",children:s};s.decorators=q}var p=s.componentType;if(p==="UIContainer"){s.children=e(s.children)}else{if(p==="UISelect"){n(s,"selection",r);n(s,"optionlist",r);n(s,"optionnames",r)}else{if(p==="UILink"){n(s,"target",r);n(s,"linktext",r)}else{if(p==="UIVerbatim"){n(s,"markup",r)}}}}return s}function h(q,p){if(q.submittingname===undefined&&q.willinput!==false){q.submittingname=p?p:q.fullID}return q.submittingname}function m(y,v){if(y.componentType===undefined){y=f(y,v)}if(y.componentType!=="UIContainer"&&!y.parent){y={children:[y]}}if(y.children){y.childmap={};for(var u=0;u<y.children.length;++u){var q=y.children[u];if(q.componentType===undefined){q=f(q,v);y.children[u]=q}q.parent=y;if(q.ID===undefined){j.fail("Error in component tree: component found with no ID "+o(q))}y.childmap[q.ID]=q;var s=q.ID.indexOf(":");if(s===-1){}else{var w=q.ID.substring(0,s);var p=y.childmap[w];if(!p){p=[];y.childmap[w]=p}if(q.localID===undefined&&p.length!==0){q.localID=p.length}p[p.length]=q}q.fullID=i(q);var r=q.componentType;if(r=="UISelect"){q.selection.fullID=q.fullID+"-selection"}else{if(r=="UIInitBlock"){var x=q.functionname+"(";for(var t=0;t<q.arguments.length;++t){if(q.arguments[t] instanceof j.ComponentReference){q.arguments[t]=q.parent.fullID+q.arguments[t].reference}x+=JSON.stringify(q.arguments[t]);if(t<q.arguments.length-1){x+=", "}}q.markup={value:x+")\n"};q.componentType="UIVerbatim"}else{if(r=="UIBound"){c(q,v)}}}m(q,v)}}return y}j.NULL_STRING="\u25a9null\u25a9";var d={a:"href",link:"href",img:"src",frame:"src",script:"src",style:"src",input:"src",embed:"src",form:"action",applet:"codebase",object:"codebase"};j.renderer=function(r,O,Y,t){Y=Y||{};O=O||{};debugMode=Y.debugMode;if(!Y.messageLocator&&Y.messageSource){Y.messageLocator=j.resolveMessageSource(Y.messageSource)}Y.document=Y.document||document;var F=t||{};var ac={};var au={};var an={};var P={};var Q={};var am="";var Z=Y;var aj=[];var H={};var ak={};function az(aD,aC,aE){return aD.resourceKey+aC.fullID+aE}function N(aH,aC,aE,aJ){var aI;var aG=aE?aE[aH]:null;if(aG){for(var aD=0;aD<aG.length;++aD){var aF=aG[aD];if(!aI&&aF.rsfID==aC){aI=aF}if(aF.rsfID==aH){return aF}}}return aI}function aw(aF,aH){var aG=aH.jointID?aH.jointID:aH.ID;var aE=j.SplitID(aG);var aC=aE.prefix+":";var aD=N(aG,aC,aF.downmap,aH);if(aD){return aD}if(aH.children){aD=N(aG,aC,ac,aH);if(aD){return aD}}return null}function L(aC){if(!P[aC.href]){j.aggregateMMap(Q,aC.collectmap);P[aC.href]=true}}function S(aH,aE){for(var aF=0;aF<aH.children.length;++aF){var aI=aH.children[aF];if(aI.children){var aK=aw(aE,aI);if(aK){au[aI.fullID]=aK;var aC=aK.attributemap.id;if(aC!==undefined){an[az(aE.parent,aH,aC)]=aI.fullID}L(aK.parent);S(aI,aK)}}}if(aE.downmap){for(var aC in aE.downmap){var aJ=aE.downmap[aC];for(var aF=0;aF<aJ.length;++aF){var aG=aJ[aF];var aL=aG.attributemap.id;if(aL!==undefined&&aG.rsfID!==undefined){var aK=ap(aH,aG.rsfID);if(aK!==null){var aD=aK.fullID;if(aK.componentType==="UISelect"){aD=aD+"-selection"}an[az(aE.parent,aH,aL)]=aD}}}}}}function M(aE,aD,aC){au={};an={};P={};Q={};ac=aE;au[aD.fullID]=aC;S(aD,aC)}function aa(aE,aC){if(aC.elide){return}var aD={};g.extend(true,aD,aC.attributemap);E(aD,aE);I(aE,aD);am+="<"+aC.tagname+" ";am+=j.dumpAttributes(aD);am+=">"}function D(aD,aF,aC){for(;aF<aC;++aF){var aE=aD[aF].text;if(aE){am+=aD[aF].text}}}function ab(aE,aH,aC,aG,aD){var aI=aH;while(true){if(aH===aE.length){break}var aF=aE[aH];if(aF.nestingdepth<aC){break}if(aF.rsfID!==undefined){if(!aD){break}if(aD&&aF.nestingdepth>aC+(aG?0:1)){j.log("Error in component tree - leaf component found to contain further components - at "+aF.toString())}else{break}}++aH}if(!aG&&(aH==aE.length||!aE[aH].rsfID)){--aH}D(aE,aI,aH);return aH}var J={};function y(){if(!J.iselide){am+="<"+J.uselump.tagname}}function av(){if(!J.iselide){am+="</"+J.uselump.tagname+">"}}function ae(){D(J.uselump.parent.lumps,J.uselump.lumpindex+1,J.close.lumpindex+(J.iselide?0:1))}function al(){if(!J.iselide){am+=j.dumpAttributes(J.attrcopy)}ai()}function T(){return J.endopen.lumpindex===J.close.lumpindex&&XMLP.closedTags[J.uselump.tagname]}function ar(){if(J.iselide){al()}else{am+=j.dumpAttributes(J.attrcopy);var aC=T();am+=aC?"/>":">";J.nextpos=aC?J.close.lumpindex+1:J.endopen.lumpindex}}function ai(){if(T()){if(!J.iselide){am+="/>"}}else{if(!J.iselide){am+=">"}D(J.uselump.parent.lumps,J.endopen.lumpindex,J.close.lumpindex+(J.iselide?0:1))}}function ag(aC){if(x(aC)){aA(aC)}else{al()}}function ay(aC){if(J.iselide){ag(J.value)}else{if(x(aC)){aA(aC)}else{ar()}}}function aA(aC){am+=j.dumpAttributes(J.attrcopy);if(!J.iselide){am+=">"}am+=j.XMLEncode(aC.toString());av()}function x(aC){return aC!==null&&aC!==undefined&&!w(aC)}function w(aC){return false}function p(aE,aC){if(Z.urlRewriter){var aF=Z.urlRewriter(aC);if(aF){return aF}}if(!Z.rebaseURLs){return aC}var aD=aC.indexOf(":/");if(aC.charAt(0)==="/"||aD!==-1&&aD<7){return aC}else{return Z.baseURL+aC}}function ax(aE){am+='<input type="hidden" ';var aD=aE.virtual;var aC={};aC[aD?"id":"name"]=aE.name;aC.value=aE.value;am+=j.dumpAttributes(aC);am+=" />\n"}function s(aC,aD){var aH=J.uselump.tagname;var aF=Z.applier;function aG(){j.applyChange(j.byId(aD),undefined,aF)}if(Z.autoBind&&/input|select|textarea/.test(aH)&&!H[aD]){var aE=[{jQuery:["change",aG]}];if(g.browser.msie&&aH==="input"&&/radio|checkbox/.test(J.attrcopy.type)){aE.push({jQuery:["click",aG]})}if(g.browser.safari&&aH==="input"&&J.attrcopy.type==="radio"){aE.push({jQuery:["keyup",aG]})}V(aC,aE,J.attrcopy,aD)}}function K(aC,aE){if(aC){var aD=aE?aE:aC;if(F&&aD.submittingname&&aD.valuebinding){F[aD.submittingname]={name:aD.submittingname,EL:aD.valuebinding,oldvalue:aD.value};s(aC,aC.fullID)}if(aC.fossilizedbinding){ax(aC.fossilizedbinding)}if(aC.fossilizedshaper){ax(aC.fossilizedshaper)}}}function C(aC){if(!H[aC.selection.fullID]){H[aC.selection.fullID]=true;K(aC.selection);K(aC.optionlist);K(aC.optionnames)}}function X(aC,aE){var aD=aC.selection;return aD.value&&typeof(aD.value)!=="string"&&typeof(aD.value.length)==="number"?g.inArray(aE,aD.value,aE)!==-1:aD.value===aE}function ao(aC,aD){aC=aC.parent;while(aD.indexOf("..::")===0){aD=aD.substring(4);aC=aC.parent}return aC.childmap[aD]}function at(aD){var aF=[];if(aD.type){aF[0]=aD}else{for(var aE in aD){if(aE==="$"){aE="jQuery"}var aG=aD[aE];var aC={type:aE};if(aE==="jQuery"){aC.func=aG[0];aC.args=aG.slice(1)}else{if(aE==="addClass"||aE==="removeClass"){aC.classes=aG}else{if(aE==="attrs"){aC.attributes=aG}else{if(aE==="identify"){aC.key=aG}}}}aF[aF.length]=aC}}return aF}function V(aG,aK,aD,aI){Z.idMap=Z.idMap||{};for(var aF=0;aF<aK.length;++aF){var aE=aK[aF];var aH=aE.type;if(!aH){var aJ=at(aE);V(aG,aJ,aD,aI);continue}if(aH==="$"){aH=aE.type="jQuery"}if(aH==="jQuery"||aH==="event"||aH==="fluid"){var aC=E(aD,aG,true,aI);aE.id=aC;aj[aj.length]=aE}else{if(aH==="attrs"){g.extend(true,aD,aE.attributes)}else{if(aH==="addClass"||aH==="removeClass"){var aL={nodeType:1,className:aD["class"]||""};g(aL)[aH](aE.classes);aD["class"]=aL.className}else{if(aH==="identify"){var aC=E(aD,aG,true,aI);Z.idMap[aE.key]=aC}else{j.log("Unrecognised decorator of type "+aH+" found at component of ID "+aI)}}}}}}function I(aC,aD){if(!aC.decorators){return}if(aC.decorators.length===undefined){aC.decorators=at(aC.decorators)}V(aC,aC.decorators,aD)}function af(aC){if(!aC){return aC}return j.transform(aC,function(aD,aE){n(aC,aE,Z.model);return aC[aE].value})}function aq(aD){if(aD.componentType==="UIMessage"){aD.componentType="UIBound";if(!Z.messageLocator){aD.value="[No messageLocator is configured in options - please consult documentation on options.messageSource]"}else{n(aD,"messagekey",Z.model);var aC=af(aD.args);aD.value=Z.messageLocator(aD.messagekey.value,aC)}}}function R(aP){var aH=J.attrcopy;var aC=J.uselump.parent.lumps;var aJ=J.uselump.lumpindex;aq(aP);var aN=aP.componentType;var aS=J.uselump.tagname;I(aP,aH);function aE(aW,aX){j.fail("Error in component tree - UISelectChoice with id "+aW.fullID+aX)}if(aN==="UIBound"||aN==="UISelectChoice"){var aK;if(aP.choiceindex!==undefined){if(aP.parentFullID){aK=getAbsoluteComponent(view,aP.parentFullID);if(!aK){aE(aP," has parentFullID of "+aP.parentFullID+" which cannot be resolved")}}else{if(aP.parentRelativeID!==undefined){aK=ao(aP,aP.parentRelativeID);if(!aK){aE(aP," has parentRelativeID of "+aP.parentRelativeID+" which cannot be resolved")}}else{aE(aP," does not have either parentFullID or parentRelativeID set")}}h(aK.selection);C(aK)}var aG=aK?aK.selection.submittingname:aP.submittingname;if(aS==="input"||aS==="textarea"){if(!aK){aG=h(aP)}if(aG!==undefined){aH.name=aG}}K(aP,aK?aK.selection:null);if(typeof(aP.value)==="boolean"||aH.type==="radio"||aH.type==="checkbox"){var aI;var aR=aP.value;if(aP.choiceindex!==undefined){if(!aK.optionlist.value){j.fail("Error in component tree - selection control with full ID "+aK.fullID+" has no values")}aI=aK.optionlist.value[aP.choiceindex];aR=X(aK,aI)}if(x(aR)){if(aR){aH.checked="checked"}else{delete aH.checked}}aH.value=aI?aI:"true";ag(null)}else{if(aP.value instanceof Array){ae()}else{var aO=aK?aK[aS==="textarea"||aS==="input"?"optionlist":"optionnames"].value[aP.choiceindex]:aP.value;if(aS==="textarea"){if(w(aO)&&aP.willinput){aO=""}ag(aO)}else{if(aS==="input"){if(aP.willinput||x(aO)){aH.value=aO}ag(null)}else{delete aH.name;ay(aO)}}}}}else{if(aN==="UISelect"){s(aP,aP.selection.fullID);var aV=aS==="select";var aF=false;if(aP.selection.value instanceof Array){aF=true;if(aV){aH.multiple="multiple"}}h(aP.selection,aH.id);if(aV){if(aP.selection.willinput!==false){aH.name=aP.selection.submittingname}}am+=j.dumpAttributes(aH);if(aV){am+=">";var aD=aP.optionlist.value;var aM=aP.optionnames===null||aP.optionnames===undefined||!aP.optionnames.value?aD:aP.optionnames.value;
if(!aM||!aM.length){j.fail("Error in component tree - UISelect component with fullID "+aP.fullID+" does not have optionnames set")}for(var aQ=0;aQ<aM.length;++aQ){am+='<option value="';var aO=aD[aQ];if(aO===null){aO=j.NULL_STRING}am+=j.XMLEncode(aO);if(X(aP,aO)){am+='" selected="selected'}am+='">';am+=j.XMLEncode(aM[aQ]);am+="</option>\n"}av()}else{ai()}C(aP)}else{if(aN==="UILink"){var aL=d[aS];if(aL){aq(aP.target);var aU=aP.target.value;if(!x(aU)){aU=aH[aL]}aU=p(J.uselump.parent,aU);aH[aL]=aU}var aO;if(aP.linktext){aq(aP.linktext);var aO=aP.linktext.value}if(!x(aO)){ar()}else{ag(aO)}}else{if(aP.markup!==undefined){aq(aP.markup);var aT=aP.markup.value;if(aT===null){am+=j.dumpAttributes(aH);am+=">";ae()}else{if(!J.iselide){am+=j.dumpAttributes(aH);am+=">"}am+=aT;av()}}else{}}}}}function E(aF,aE,aD,aH){if(!aD){delete aF["rsf:id"]}if(aH!==undefined){aF.id=aH}else{if(aF.id||aD){aF.id=aE.fullID}}var aG=1;var aC=aF.id;while(Z.document.getElementById(aF.id)){aF.id=aC+"-"+(aG++)}return aF.id}function v(aC){var aG;var aE=J.attrcopy["for"];if(aE!==undefined){aG="for"}else{aE=J.attrcopy.headers;if(aE!==undefined){aG="headers"}}if(!aG){return}var aF=J.uselump.tagname;if(aG==="for"&&aF!=="label"){return}if(aG==="headers"&&aF!=="td"&&aF!=="th"){return}var aD=an[az(J.uselump.parent,aC,aE)];if(aD!==undefined){J.attrcopy[aG]=aD}}function ah(aC){am+=("<!-- "+j.XMLEncode(aC)+"-->")}function z(aC){am+='<span style="background-color:#FF466B;color:white;padding:1px;">';am+=aC;am+="</span><br/>"}function W(aC){var aD=aC.fullID;return !aD?"component tree root":"full path "+aD}function G(aD,aM,aI){var aK=aI.lumpindex;var aQ=aI.parent.lumps;var aJ=-1;var aL=aQ[aK+1];var aC=aI.close_tag;aJ=aC.lumpindex+1;var aH=aI.downmap?aI.downmap["payload-component"]:null;var aP=aH?aH[0]:null;var aO=aI.rsfID.charCodeAt(0)===126;var aG=aL;var aR=aC;var aF=aI;var aE={};g.extend(true,aE,(aP===null?aI:aP).attributemap);J.attrcopy=aE;J.uselump=aF;J.endopen=aG;J.close=aR;J.nextpos=aJ;J.iselide=aO;v(aD);if(aM===null){if(aI.rsfID.indexOf("scr=")===(aO?1:0)){var aN=aI.rsfID.substring(4+(aO?1:0));if(aN==="ignore"){aJ=J.close.lumpindex+1}else{if(aN==="rewrite-url"){aM={componentType:"UILink",target:{}}}else{y();ar();aJ=J.endopen.lumpindex}}}}if(aM!==null){if(aP){J.endopen=aQ[aP.lumpindex+1];J.close=aP.close_tag;J.uselump=aP;D(aQ,aK,aP.lumpindex);aK=aP.lumpindex}E(aE,aM);y();R(aM);if(aP!==null){if(J.nextpos===aJ){D(aQ,J.close.lumpindex+1,aC.lumpindex+1)}}aJ=J.nextpos}return aJ}function B(aF,aC){var aE=aC.parent;var aD=aE.lumps[aC.lumpindex+1];if(aF.children!==undefined){aa(aF,aC)}else{G(aF.parent,aF,aC)}ad(aF,aC,aD)}function ap(aF,aG,aE){if(aG.indexOf("msg=")===0){var aC=aG.substring(4);return{componentType:"UIMessage",messagekey:aC}}while(aF){var aD=aF.childmap[aG];if(aD){return aD}aF=aF.parent}return null}function aB(aD,aE){var aC;while(aD){aC=aD.childmap[aE];if(aC){break}aD=aD.parent}return aC}function U(aE,aF){var aD=j.SplitID(aF.ID);var aC=aE.downmap[aF.ID];if(aC===null){aC=aE.downmap[aD.prefix+":"]}return aC===null?null:aC[0]}function ad(aH,aW,aN){var aQ=aN.lumpindex;var aT=aW.nestingdepth;var aI=aW.parent;if(debugMode){var aU={}}while(true){aQ=ab(aI.lumps,aQ,aT,!aW.elide,false);if(aQ===aI.lumps.length){break}var aL=aI.lumps[aQ];var aM=aL.rsfID;if(aL.nestingdepth<aT||aM===undefined){break}if(aM.charCodeAt(0)===126){aM=aM.substring(1)}if(aM.indexOf(":")!==-1){var aO=j.getPrefix(aM);var aC=aB(aH,aO);var aE=aL.uplump.finallump[aO];var aF=aE.close_tag;if(aC){for(var aP=0;aP<aC.length;++aP){var aD=aC[aP];if(aD.children){if(debugMode){aU[aD.fullID]=true}var aR=au[aD.fullID];if(aR){if(debugMode){ah("Branching for "+aD.fullID+" from "+j.debugLump(aL)+" to "+j.debugLump(aR))}B(aD,aR);if(debugMode){ah("Branch returned for "+aD.fullID+j.debugLump(aL)+" to "+j.debugLump(aR))}}else{if(debugMode){z("No matching template branch found for branch container with full ID "+aD.fullID+" rendering from parent template branch "+j.debugLump(aN))}}}else{var aR=U(aW,aD);if(!aR){if(debugMode){z("Repetitive leaf with full ID "+aD.fullID+" could not be rendered from parent template branch "+j.debugLump(aN))}continue}var aS=G(aH,aD,aR);var aK=aS<aI.lumps.lengtn&&aI.lumps[aS].nestingdepth>=aR.nestingdepth;var aG=aD.children?aD:aH;if(aK){ad(aG,aR,aI.lumps[aS]);aS=aR.close_tag.lumpindex+1}if(aP!==aC.length-1){if(aS<aF.lumpindex){ab(aI.lumps,aS,aR.nestingdepth-1,false,false)}}else{ab(aI.lumps,aS,aR.nestingdepth,true,false)}}}}else{if(debugMode){z("No branch container with prefix "+aO+": found in container "+W(aH)+" rendering at template position "+j.debugLump(aN)+", skipping")}}aQ=aF.lumpindex+1;if(debugMode){ah("Stack returned from branch for ID "+aM+" to "+j.debugLump(aN)+": skipping from "+j.debugLump(aL)+" to "+j.debugLump(aF))}}else{var aJ;if(aM){aJ=ap(aH,aM,aL);if(debugMode&&aJ){aU[aJ.fullID]=true}}if(aJ&&aJ.children!==undefined){B(aJ);aQ=aL.close_tag.lumpindex+1}else{aQ=G(aH,aJ,aL)}}if(aQ===aI.lumps.length){break}}if(debugMode){var aC=aH.children;for(var aV=0;aV<aC.length;++aV){var aD=aC[aV];if(!aU[aD.fullID]){z("Component "+aD.componentType+" with full ID "+aD.fullID+" could not be found within template "+j.debugLump(aN))}}}}function u(aC){D(aC.parent.lumps,aC.lumpindex,aC.close_tag.lumpindex+1)}function q(){for(var aE in Q){var aC=Q[aE];for(var aD=0;aD<aC.length;++aD){u(aC[aD])}}}function A(){for(var aF=0;aF<aj.length;++aF){var aC=aj[aF];var aH=j.byId(aC.id,Z.document);if(!aH){j.fail("Error during rendering - component with id "+aC.id+" which has a queued decorator was not found in the output markup")}if(aC.type==="jQuery"){var aE=g(aH);aE[aC.func].apply(aE,g.makeArray(aC.args))}else{if(aC.type==="fluid"){var aD=aC.args;if(!aD){if(!aC.container){aC.container=aH}aD=[aC.container,aC.options]}var aG=j.invokeGlobalFunction(aC.func,aD,j);aC.that=aG}else{if(aC.type==="event"){aH[aC.event]=aC.handler}}}}}ak.renderTemplates=function(){O=m(O,Y.model);var aC=r[0];M(r.globalmap,O,aC.rootlump);H={};q();ad(O,aC.rootlump,aC.lumps[aC.firstdocumentindex]);return am};ak.processDecoratorQueue=function(){A()};return ak};jQuery.extend(true,j.renderer,l);j.ComponentReference=function(p){this.reference=p};j.explode=function(s,p){var r=[];for(var q in s){var t=p===undefined?q:p+"."+q;r[r.length]={ID:q,value:s[q],valuebinding:t}}return r};j.explodeSelectionToInputs=function(p,q){return j.transform(p,function(s,r){return{ID:q.rowID,children:[{ID:q.inputID,parentRelativeID:"..::"+q.selectID,choiceindex:r},{ID:q.labelID,parentRelativeID:"..::"+q.selectID,choiceindex:r}]}})};j.messageLocator=function(q,p){p=p||j.stringTemplate;return function(r,s){if(typeof(r)==="string"){r=[r]}for(var t=0;t<r.length;++t){var v=r[t];var u=q[v];if(u===undefined){continue}return p(u,s)}return"[Message string for key "+r[0]+" not found]"}};j.resolveMessageSource=function(p){if(p.type==="data"){if(p.url===undefined){return j.messageLocator(p.messages,p.resolveFunc)}else{}}};j.renderTemplates=function(s,p,q,r){var t=j.renderer(s,p,q,r);var u=t.renderTemplates();return u};j.reRender=function(w,r,y,x){x=x||{};r=j.unwrap(r);var t=j.getLastFocusedElement?j.getLastFocusedElement():null;var p;if(t&&j.dom.isContainer(r,t)){p=t.id}if(g.browser.msie){g(r).empty()}else{r.innerHTML=""}var u={};var v=j.renderer(w,y,x,u);var q=v.renderTemplates();if(x.renderRaw){q=j.XMLEncode(q);q=q.replace(/\n/g,"<br/>")}if(x.model){j.bindFossils(r,x.model,u)}if(g.browser.msie){g(r).html(q)}else{r.innerHTML=q}v.processDecoratorQueue();if(p){var s=j.byId(p);if(s){g(s).focus()}}return w};function a(p){var q=j.dom.iterateDom(p,function(s){return s.nodeType===8||s.nodeType===4?"stop":null},true);var r=q.nodeValue;if(r.indexOf("[CDATA[")===0){return r.substring(6,r.length-2)}else{return r}}j.extractTemplate=function(q,p){if(!p){return q.innerHTML}else{return a(q)}};j.render=function(u,v,p,r){r=r||{};var t=u;if(typeof(u)==="object"){t=j.extractTemplate(j.unwrap(u.node),u.armouring)}v=j.unwrap(v);var q={base:{resourceText:t,href:".",resourceKey:".",cutpoints:r.cutpoints}};var s=j.parseTemplates(q,["base"],r);return j.reRender(s,v,p,r)};j.selfRender=function(r,p,q){q=q||{};return j.render({node:r,armouring:q.armouring},r,p,q)}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(d,b){var f=function(h){var g=d("<a name='"+h.text()+"' />",h[0].ownerDocument);h.before(g)};var e=function(h){var g={ID:h,children:[]};return g};var a=function(k,j){var i=function(m,l,s){if(l.length===0){return}var p=l[0];if(s===p.level){m[m.length-1].push(p.leaf);l.shift();return i(m,l,s)}if(s<p.level){var q=s>-1?"level"+(s+1)+":":"";var r=s===-1?"s:":"s";var n=q+"level"+(s+2)+r;var o=e(n);m[m.length-1].push(o);m.push(o.children);return i(m,l,s+1)}if(s>p.level){m.pop();return i(m,l,s-1)}};var g={children:[]};var h=b.transform(k,function(l){var n=d.inArray(l.tagName,j);var m=d(l).text();return{level:n,leaf:{ID:"level"+(n+1)+":item",children:[{ID:"link",linktext:m,target:"#"+m}]}}});i([g.children],h,-1);return g};var c=function(g,k,h,j,l){k.each(function(m,n){f(d(n))});var i={toc:{href:j}};b.fetchResources(i,function(){var m=b.parseTemplates(i,["toc"],{});var n=d("<div></div>",g[0].ownerDocument);b.reRender(m,n,a(k,h),{});g.prepend(n);l.fire(n)})};b.tableOfContents=function(g,h){var i=b.initView("fluid.tableOfContents",g,h);i.events.afterRender.addListener(function(j){i.tocNode=d(j)});c(i.container,i.locate("headings"),i.options.levels,i.options.templateUrl,i.events.afterRender);i.hide=function(){if(i.tocNode){i.tocNode.hide()}};i.show=function(){if(i.tocNode){i.tocNode.show()}};return i};b.defaults("fluid.tableOfContents",{selectors:{headings:":header"},events:{afterRender:null},templateUrl:"../html/TableOfContents.html",levels:["H1","H2","H3","H4","H5","H6"]})})(jQuery,fluid_1_2);if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};
function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(:?[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}fluid_1_2=fluid_1_2||{};(function(d,f){var j=function(q,p,s,r){r=r||"";d(p,q).andSelf().each(function(u){var t=(d.browser.msie===false)?"class":"className";if(this.getAttribute(t)){this.setAttribute(t,this.getAttribute(t).replace(s,r))}})};var n=function(r,q,t,u){var p=u[q]||{};var s=p[t];if(s){r.addClass(s)}};var o=function(p){return p&&(p===true||p==="true")};var h=function(p,q){if(o(q)){if(p.tableOfContents){p.tableOfContents.show()}else{p.tableOfContents=f.initSubcomponent(p,"tableOfContents",[p.container,f.COMPONENT_OPTIONS])}}else{if(p.tableOfContents){p.tableOfContents.hide()}}};var b=function(p,q){q=q&&q>0?q:1;p.css("line-height",q+"em")};var k=function(p,q){if(q&&q>0){p.css("font-size",q+"pt");j(p,"[class*=fl-font-size-]",/\bfl-font-size-[0-9]{1,2}\s+/g,"fl-font-size-100")}else{p.css("font-size","")}};var e=function(p,q,r){n(p,"textFont",q.textFont,r);n(p,"textSpacing",q.textSpacing,r);n(p,"theme",q.theme,r);n(p,"layout",q.layout,r)};var m=function(q,p,r){if(p){q.addClass(r)}else{q.removeClass(r)}};var a=function(p,r,s){var q=d("a",p);m(q,r.linksUnderline,s.linksUnderline);m(q,r.linksBold,s.linksBold);m(q,r.linksLarger,s.linksLarger)};var l=function(p,q,r){m(d("input",p),q.inputsLarger,r.inputsLarger)};var c=function(p){if(p.options.savedSettings){p.model=p.options.savedSettings;return}p.model=p.settingsStore.fetch()||f.copy(p.defaultSiteSettings)};var g=function(p,q){var s=["textFont","textSpacing","theme","layout"];var x="fl-noBackgroundImages";var v=".fl-noBackgroundImages";for(var w=0;w<s.length;w++){var t=q[s[w]];for(var r in t){var u=t[r];if(u){x=x+" "+u;v=v+",."+u}}}d(v,p).removeClass(x);return x};var i=function(p){p.settingsStore=f.initSubcomponent(p,"settingsStore",[f.COMPONENT_OPTIONS]);c(p);p.refreshView()};f.uiEnhancer=function(s,q){s=s||document;var r=f.initView("fluid.uiEnhancer",s,q);d(s).data("uiEnhancer",r);r.container=d("body",s);r.defaultSiteSettings=r.options.defaultSiteSettings;var p;r.refreshView=function(){r.container.removeClass(p);e(r.container,r.model,r.options.classnameMap);m(r.container,!o(r.model.backgroundImages),r.options.classnameMap.noBackgroundImages);k(r.container,r.model.textSize);b(r.container,r.model.lineSpacing);h(r,r.model.toc);a(r.container,r.model,r.options.classnameMap);l(r.container,r.model,r.options.classnameMap)};r.updateModel=function(t,u){r.events.modelChanged.fire(t,r.model,u);f.clear(r.model);f.model.copyModel(r.model,t);r.settingsStore.save(r.model);r.refreshView()};p=g(r.container,r.options.classnameMap);i(r);return r};f.defaults("fluid.uiEnhancer",{tableOfContents:{type:"fluid.tableOfContents",options:{templateUrl:"../../tableOfContents/html/TableOfContents.html"}},settingsStore:{type:"fluid.uiEnhancer.cookieStore"},events:{modelChanged:null},classnameMap:{textFont:{serif:"fl-font-serif",sansSerif:"fl-font-sans",arial:"fl-font-arial",verdana:"fl-font-verdana",monospace:"fl-font-monospace",courier:"fl-font-courier",times:"fl-font-times"},textSpacing:{"default":"",wide0:"fl-font-spacing-0",wide1:"fl-font-spacing-1",wide2:"fl-font-spacing-2",wide3:"fl-font-spacing-3",wide4:"fl-font-spacing-4",wide5:"fl-font-spacing-5",wide6:"fl-font-spacing-6"},theme:{mist:"fl-theme-mist",rust:"fl-theme-rust",highContrast:"fl-theme-hc",highContrastInverted:"fl-theme-hci",lowContrast:"fl-theme-slate",mediumContrast:"fl-theme-coal","default":""},layout:{simple:"fl-layout-linear","default":""},noBackgroundImages:"fl-noBackgroundImages",linksUnderline:"fl-text-underline",linksBold:"fl-text-bold",linksLarger:"fl-text-larger",inputsLarger:"fl-text-larger"},defaultSiteSettings:{textFont:"",textSpacing:"",theme:"default",layout:"default",textSize:"",lineSpacing:"",backgroundImages:true,toc:false,linksUnderline:false,linksBold:false,linksLarger:false,inputsLarger:false}});f.uiEnhancer.cookieStore=function(p){var q={};f.mergeComponentOptions(q,"fluid.uiEnhancer.cookieStore",p);q.fetch=function(){var s=document.cookie;var r=q.options.cookieName+"=";var u,v,t;if(s.length>0){v=s.indexOf(r);if(v>-1){v=v+r.length;t=s.indexOf(";",v);if(t<v){t=s.length}u=JSON.parse(decodeURIComponent(s.substring(v,t)))}}return u};q.save=function(r){document.cookie=q.options.cookieName+"="+encodeURIComponent(JSON.stringify(r))};return q};f.defaults("fluid.uiEnhancer.cookieStore",{cookieName:"fluid-ui-settings"});f.uiEnhancer.tempStore=function(p){var q={};q.model=null;q.fetch=function(){return q.model};q.save=function(r){q.model=r};return q}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(g,e){var h=function(i,k){var j={role:"slider","aria-valuenow":k.value,"aria-valuemin":k.min,"aria-valuemax":k.max};i.attr(j)};var f=function(j){var k=j.options.sliderOptions;k.value=j.model;k.min=j.min;k.max=j.max;var i=j.locate("slider").slider(k);h(j.locate("thumb"),k);return i};var a=function(k,j,i){i.bind("slide",function(m,l){j.val(l.value);k.updateModel(l.value,i)})};var c=function(k,j){var i=k.locate("textfield");i.val(k.model);return i};var b=function(k,j,i){j.change(function(){if(k.isValid(this.value)){if(!k.isInRange(this.value)){this.value=(this.value<k.min)?k.min:k.max}i.slider("value",this.value);k.updateModel(this.value,this)}else{this.value=k.model}});j.keypress(function(l){if(l.keyCode!==g.ui.keyCode.ENTER){return true}else{g(l.target).change();g(e.findForm(l.target)).submit();return false}})};var d=function(k){var j=f(k);var i=c(k,j);a(k,i,j);b(k,i,j)};e.textfieldSlider=function(i,j){var k=e.initView("fluid.textfieldSlider",i,j);k.model=k.options.value||k.locate("textfield").val();k.min=k.options.min;k.max=k.options.max;k.isInRange=function(l){return(l>=k.min&&l<=k.max)};k.isValid=function(l){return !(isNaN(parseInt(l,10))||isNaN(l))};k.updateModel=function(l,m){if(k.isInRange(l)){k.events.modelChanged.fire(l,k.model,m);k.model=l;k.locate("thumb").attr("aria-valuenow",k.model)}};d(k);return k};e.defaults("fluid.textfieldSlider",{selectors:{textfield:".flc-textfieldSlider-field",slider:".flc-textfieldSlider-slider",thumb:".ui-slider-handle"},events:{modelChanged:null},sliderOptions:{orientation:"horizontal"},min:0,max:100,value:null})})(jQuery,fluid_1_2);(function(d,g){var j=function(p,m,n,o){return{ID:p,selection:{valuebinding:m},optionlist:{valuebinding:n},optionnames:{valuebinding:o}}};var a=function(n,m){return{ID:n,valuebinding:m}};var k=function(p,r){var o=[];o.push(j("text-font","selections.textFont","labelMap.textFont.values","labelMap.textFont.names"));o.push(j("text-spacing","selections.textSpacing","labelMap.textSpacing.values","labelMap.textSpacing.names"));o.push(j("theme","selections.theme","labelMap.theme.values","labelMap.theme.names"));var n={selectID:"background-images",rowID:"background-images-row:",inputID:"background-images-choice",labelID:"background-images-label"};o.push(j("background-images","selections.backgroundImages","labelMap.backgroundImages.values","labelMap.backgroundImages.names"));o=o.concat(g.explodeSelectionToInputs(p.options.controlValues.backgroundImages,n));var q={selectID:"layout",rowID:"layout-row:",inputID:"layout-choice",labelID:"layout-label"};o.push(j("layout","selections.layout","labelMap.layout.values","labelMap.layout.names"));o=o.concat(g.explodeSelectionToInputs(p.options.controlValues.layout,q));var m={selectID:"toc",rowID:"toc-row:",inputID:"toc-choice",labelID:"toc-label"};o.push(j("toc","selections.toc","labelMap.toc.values","labelMap.toc.names"));o=o.concat(g.explodeSelectionToInputs(p.options.controlValues.layout,m));o.push(a("links-underline","selections.linksUnderline"));o.push(a("links-bold","selections.linksBold"));o.push(a("links-larger","selections.linksLarger"));o.push(a("inputs-larger","selections.inputsLarger"));return{children:o}};var h=function(n){var o=n.locate("save");o.click(n.save);n.locate("reset").click(n.reset);n.locate("cancel").click(n.cancel);var m=g.findForm(o);d(m).submit(function(){n.save()})};var i=function(m){var o=m.locate("previewFrame");var n;m.events.modelChanged.addListener(function(p){setTimeout(function(){if(n){n.updateModel(p)}},0)});o.load(function(){var p=o.contents();var q={savedSettings:m.model,tableOfContents:m.uiEnhancer.options.tableOfContents,settingsStore:{type:"fluid.uiEnhancer.tempStore"}};n=g.uiEnhancer(p,q)})};var e=function(m){var o={};for(var n in m.controlValues){o[n]={names:m.strings[n],values:m.controlValues[n]}}return o};var c=function(n){n.model.toc=String(n.model.toc);n.model.backgroundImages=String(n.model.backgroundImages);var m=g.assembleModel({selections:{model:n.model,applier:n.applier},labelMap:{model:e(n.options)}});
return{model:m.model,applier:m.applier,autoBind:true}};var f=function(o){var n=function(p){return{listeners:{modelChanged:function(q){o.applier.requestChange(p,q)}},value:o.model[p]}};var m=n("textSize");g.merge(null,m,o.options.textMinSize.options);g.initSubcomponents(o,"textMinSize",[o.options.selectors.textMinSizeCtrl,m]);m=n("lineSpacing");g.merge(null,m,o.options.lineSpacing.options);g.initSubcomponents(o,"lineSpacing",[o.options.selectors.lineSpacingCtrl,m])};var b=function(o,s){for(var p in o.controlValues){var q=String(s[p]);var m=o.controlValues[p];if(q){var n=d.inArray(q,m);if(n===-1){var r=d.inArray("default",m);if(r===-1){m.push(q)}else{m[r]=q}}}}};var l=function(n){n.applier.modelChanged.addListener("*",function(p,r,q){n.events.modelChanged.fire(p,r,q.source)});b(n.options,n.uiEnhancer.defaultSiteSettings);n.events.afterRender.addListener(function(){f(n);h(n);i(n)});var o=c(n);var m=g.selfRender(n.container,k(n,o.model),o);n.events.afterRender.fire();return m};g.uiOptions=function(m,o){var q=g.initView("fluid.uiOptions",m,o);q.uiEnhancer=d(document).data("uiEnhancer");q.model=g.copy(q.uiEnhancer.model);q.applier=g.makeChangeApplier(q.model);var n=q.uiEnhancer.model;var p;q.save=function(){q.events.onSave.fire(q.model);n=g.copy(q.model);q.uiEnhancer.updateModel(n)};q.reset=function(){q.events.onReset.fire();q.updateModel(g.copy(q.uiEnhancer.defaultSiteSettings),q);q.refreshView()};q.cancel=function(){q.events.onCancel.fire();q.updateModel(g.copy(n),q);q.refreshView()};q.refreshView=function(){var r=c(q);g.reRender(p,q.container,k(q,r.model),r);q.events.afterRender.fire()};q.updateModel=function(r,s){q.events.modelChanged.fire(r,q.model,s);g.clear(q.model);g.model.copyModel(q.model,r)};p=l(q);return q};g.defaults("fluid.uiOptions",{textMinSize:{type:"fluid.textfieldSlider",options:{min:6,max:30}},lineSpacing:{type:"fluid.textfieldSlider",options:{min:1,max:10}},selectors:{controls:".flc-uiOptions-control",textMinSizeCtrl:".flc-uiOptions-min-text-size",lineSpacingCtrl:".flc-uiOptions-line-spacing",cancel:".flc-uiOptions-cancel",reset:".flc-uiOptions-reset",save:".flc-uiOptions-save",previewFrame:".flc-uiOptions-preview-frame"},events:{modelChanged:null,onSave:null,onCancel:null,onReset:null,afterRender:null},strings:{textFont:["Serif","Sans-Serif","Arial","Verdana","Courier","Times"],textSpacing:["Regular","Wide","Wider","Widest"],theme:["Low Contrast","Medium Contrast","Medium Contrast Grey Scale","High Contrast","High Contrast Inverted"],backgroundImages:["Yes","No"],layout:["Yes","No"],toc:["Yes","No"]},controlValues:{textFont:["serif","sansSerif","arial","verdana","courier","times"],textSpacing:["default","wide1","wide2","wide3"],theme:["lowContrast","default","mediumContrast","highContrast","highContrastInverted"],backgroundImages:["true","false"],layout:["simple","default"],toc:["true","false"]}})})(jQuery,fluid_1_2);(function(a){a.fn.bgIframe=a.fn.bgiframe=function(c){if(a.browser.msie&&parseInt(a.browser.version)<=6){c=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;"},c||{});var d=function(e){return e&&e.constructor==Number?e+"px":e},b='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;'+(c.opacity!==false?"filter:Alpha(Opacity='0');":"")+"top:"+(c.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":d(c.top))+";left:"+(c.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":d(c.left))+";width:"+(c.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":d(c.width))+";height:"+(c.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":d(c.height))+';"/>';return this.each(function(){if(a("> iframe.bgiframe",this).length==0){this.insertBefore(document.createElement(b),this.firstChild)}})}return this};if(!a.browser.version){a.browser.version=navigator.userAgent.toLowerCase().match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)[1]}})(jQuery);var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(a){this.initSWFUpload(a)}}SWFUpload.prototype.initSWFUpload=function(b){try{this.customSettings={};this.settings=b;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(a){if(typeof(a)!=="string"||a.match(/^https?:\/\//i)||a.match(/^\//)){return a}var c=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var b=window.location.pathname.lastIndexOf("/");if(b<=0){path="/"}else{path=window.location.pathname.substr(0,b)+"/"}return path+a};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(b,a){this.settings[b]=(this.settings[b]==undefined)?a:this.settings[b]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a,b;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(a==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}b=document.createElement("div");b.innerHTML=this.getFlashHTML();a.parentNode.replaceChild(b.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var b=this.buildParamString();var a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(b),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")
};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var c=this.settings.post_params;var b=[];if(typeof(c)==="object"){for(var a in c){if(c.hasOwnProperty(a)){b.push(encodeURIComponent(a.toString())+"="+encodeURIComponent(c[a].toString()))}}}return b.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var a=null;a=this.getMovieElement();if(a&&typeof(a.CallFunction)==="unknown"){for(var c in a){try{if(typeof(a[c])==="function"){a[c]=null}}catch(e){}}try{a.parentNode.removeChild(a)}catch(b){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(d){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(b,c,a){if(c==undefined){return(this.settings[b]=a)}else{return(this.settings[b]=c)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(a,b){if(b!==false){b=true}this.callFlash("CancelUpload",[a,b])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(a,b,c){return this.callFlash("AddFileParam",[a,b,c])};SWFUpload.prototype.removeFileParam=function(a,b){this.callFlash("RemoveFileParam",[a,b])};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,b){this.settings.post_params[a]=b;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(a,b){this.settings.file_types=a;this.settings.file_types_description=b;this.callFlash("SetFileTypes",[a,b])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(c,a){this.settings.button_width=c;this.settings.button_height=a;var b=this.getMovieElement();if(b!=undefined){b.style.width=c+"px";b.style.height=a+"px"}this.callFlash("SetButtonDimensions",[c,a])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(b,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=b;this.callFlash("SetButtonTextPadding",[b,a])};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(b,c){if(c==undefined){c=[]}else{if(!(c instanceof Array)){c=[c]}}var a=this;if(typeof this.settings[b]==="function"){this.eventQueue.push(function(){this.settings[b].apply(this,c)});setTimeout(function(){a.executeNextEvent()},0)}else{if(this.settings[b]!==null){throw"Event handler "+b+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(c){var e=/[$]([0-9a-f]{4})/i;var f={};var d;if(c!=undefined){for(var a in c.post){if(c.post.hasOwnProperty(a)){d=a;var b;while((b=e.exec(d))!==null){d=d.replace(b[0],String.fromCharCode(parseInt("0x"+b[1],16)))}f[d]=c.post[a]}}c.post=f}return c};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")
}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(a);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&typeof(a.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var c in a){try{if(typeof(a[c])==="function"){a[c]=null}}catch(b){}}}}catch(d){}window.__flash__removeCallback=function(e,f){try{if(e){e[f]=null}}catch(g){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("file_queue_error_handler",[a,c,b])};SWFUpload.prototype.fileDialogComplete=function(b,c,a){this.queueEvent("file_dialog_complete_handler",[b,c,a])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(a){var b;if(typeof this.settings.upload_start_handler==="function"){a=this.unescapeFilePostParams(a);b=this.settings.upload_start_handler.call(this,a)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(b===undefined){b=true}b=!!b;this.callFlash("ReturnUploadStart",[b])};SWFUpload.prototype.uploadProgress=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_progress_handler",[a,c,b])};SWFUpload.prototype.uploadError=function(a,c,b){a=this.unescapeFilePostParams(a);this.queueEvent("upload_error_handler",[a,c,b])};SWFUpload.prototype.uploadSuccess=function(b,a,c){b=this.unescapeFilePostParams(b);this.queueEvent("upload_success_handler",[b,a,c])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(c){if(this.settings.debug){var a,d=[];if(typeof c==="object"&&typeof c.name==="string"&&typeof c.message==="string"){for(var b in c){if(c.hasOwnProperty(b)){d.push(b+": "+c[b])}}a=d.join("\n")||"";d=a.split("\n");a="EXCEPTION: "+d.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(a)}else{SWFUpload.Console.writeLine(c)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(d){var b,a;try{b=document.getElementById("SWFUpload_Console");if(!b){a=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(a);b=document.createElement("textarea");b.id="SWFUpload_Console";b.style.fontFamily="monospace";b.setAttribute("wrap","off");b.wrap="off";b.style.overflow="auto";b.style.width="700px";b.style.height="350px";b.style.margin="5px";a.appendChild(b)}b.value+=d+"\n";b.scrollTop=b.scrollHeight-b.clientHeight}catch(c){alert("Exception: "+c.name+" Message: "+c.message)}};(function(e){var b={},k,m,o,j=e.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),a=false;e.tooltip={blocked:false,defaults:{delay:200,showURL:true,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){e.tooltip.blocked=!e.tooltip.blocked}};e.fn.extend({tooltip:function(p){p=e.extend({},e.tooltip.defaults,p);h(p);return this.each(function(){e.data(this,"tooltip-settings",p);this.tooltipText=this.title;e(this).removeAttr("title");this.alt=""}).hover(l,f).click(f)},fixPNG:j?function(){return this.each(function(){var p=e(this).css("backgroundImage");if(p.match(/^url\(["']?(.*\.png)["']?\)$/i)){p=RegExp.$1;e(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+p+"')"}).each(function(){var q=e(this).css("position");if(q!="absolute"&&q!="relative"){e(this).css("position","relative")}})}})}:function(){return this},unfixPNG:j?function(){return this.each(function(){e(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){e(this)[e(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}});function h(p){if(b.parent){return}b.parent=e('<div id="'+p.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide();if(e.fn.bgiframe){b.parent.bgiframe()}b.title=e("h3",b.parent);b.body=e("div.body",b.parent);b.url=e("div.url",b.parent)}function c(p){return e.data(p,"tooltip-settings")}function g(p){if(c(this).delay){o=setTimeout(n,c(this).delay)}else{n()}a=!!c(this).track;e(document.body).bind("mousemove",d);d(p)}function l(){if(e.tooltip.blocked||this==k||(!this.tooltipText&&!c(this).bodyHandler)){return}k=this;m=this.tooltipText;if(c(this).bodyHandler){b.title.hide();var s=c(this).bodyHandler.call(this);if(s.nodeType||s.jquery){b.body.empty().append(s)}else{b.body.html(s)}b.body.show()}else{if(c(this).showBody){var r=m.split(c(this).showBody);b.title.html(r.shift()).show();b.body.empty();for(var q=0,p;p=r[q];q++){if(q>0){b.body.append("<br/>")}b.body.append(p)}b.body.hideWhenEmpty()}else{b.title.html(m).show();b.body.hide()}}if(c(this).showURL&&e(this).url()){b.url.html(e(this).url().replace("http://","")).show()}else{b.url.hide()}b.parent.addClass(c(this).extraClass);if(c(this).fixPNG){b.parent.fixPNG()}g.apply(this,arguments)}function n(){o=null;b.parent.show();d()}function d(r){if(e.tooltip.blocked){return}if(!a&&b.parent.is(":visible")){e(document.body).unbind("mousemove",d)}if(k==null||!c(k)){return}b.parent.removeClass("viewport-right").removeClass("viewport-bottom");var t=b.parent[0].offsetLeft;var s=b.parent[0].offsetTop;if(r){t=r.pageX+c(k).left;s=r.pageY+c(k).top;b.parent.css({left:t+"px",top:s+"px"})}var p=i(),q=b.parent[0];if(p.x+p.cx<q.offsetLeft+q.offsetWidth){t-=q.offsetWidth+20+c(k).left;b.parent.css({left:t+"px"}).addClass("viewport-right")}if(p.y+p.cy<q.offsetTop+q.offsetHeight){s-=q.offsetHeight+20+c(k).top;b.parent.css({top:s+"px"}).addClass("viewport-bottom")}}function i(){return{x:e(window).scrollLeft(),y:e(window).scrollTop(),cx:e(window).width(),cy:e(window).height()}}function f(p){if(e.tooltip.blocked){return}if(o){clearTimeout(o)}k=null;b.parent.hide().removeClass(c(this).extraClass);if(c(this).fixPNG){b.parent.unfixPNG()}}e.fn.Tooltip=e.fn.tooltip})(jQuery);fluid_1_2=fluid_1_2||{};(function(h,f){var d="state_initial",c="state_changed",b="state_reverted";function g(l,j){var m=l.options.strings;var i="<span class='flc-undo'><a href='#' class='flc-undo-undoControl'>"+m.undo+"</a><a href='#' class='flc-undo-redoControl'>"+m.redo+"</a></span>";var k=h(i).attr({role:"region","aria-live":"polite","aria-relevant":"all"});j.append(k);return k}function a(i){if(i.state===d){i.locate("undoContainer").hide();i.locate("redoContainer").hide()}else{if(i.state===c){i.locate("undoContainer").show();i.locate("redoContainer").hide()}else{if(i.state===b){i.locate("undoContainer").hide();i.locate("redoContainer").show()}}}}var e=function(i){i.locate("undoControl").click(function(){if(i.state!==b){f.model.copyModel(i.extremalModel,i.component.model);i.component.updateModel(i.initialModel,i);i.state=b;a(i);i.locate("redoControl").focus()}return false});i.locate("redoControl").click(function(){if(i.state!==c){i.component.updateModel(i.extremalModel,i);i.state=c;a(i);i.locate("undoControl").focus()}return false});return{modelChanged:function(j,l,k){if(k!==i){i.state=c;f.model.copyModel(i.initialModel,l);a(i)}}}};f.undoDecorator=function(i,l){var k=f.initView("undo",null,l);k.container=k.options.renderer(k,i.container);f.initDomBinder(k);f.tabindex(k.locate("undoControl"),0);f.tabindex(k.locate("redoControl"),0);k.component=i;k.initialModel={};k.extremalModel={};f.model.copyModel(k.initialModel,i.model);f.model.copyModel(k.extremalModel,i.model);k.state=d;a(k);var j=e(k);k.returnedOptions={listeners:j};return k};f.defaults("undo",{selectors:{undoContainer:".flc-undo-undoControl",undoControl:".flc-undo-undoControl",redoContainer:".flc-undo-redoControl",redoControl:".flc-undo-redoControl"},strings:{undo:"undo edit",redo:"redo edit"},renderer:g})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(i,k){function n(H,G,D,F){var E=document.createEvent("KeyEvents");E.initKeyEvent(G,1,1,null,0,0,0,0,D,F);H.dispatchEvent(E)}k.setCaretToEnd=function(G,E){var H=E?E.length:0;try{G.focus();if(G.setSelectionRange){G.setSelectionRange(H,H);if(i.browser.mozilla&&H>0){n(G,"keypress",92,92);n(G,"keydown",8,0);n(G,"keypress",8,0)}}else{if(G.createTextRange){var D=G.createTextRange();D.move("character",H);D.select()}}}catch(F){}};k.deadMansBlur=function(H,E,G){var D=false;i(H).blur(function(){D=true;setTimeout(function(){if(D){G(H)}},150)});var F=function(){D=false};E.focus(F);E.click(F)};var d=function(E,F){E.editContainer=E.locate("editContainer");E.editField=E.locate("edit");if(E.editContainer.length!==1){if(E.editField.length===1){E.editContainer=E.editField}else{if(E.editContainer.length>1){k.fail("InlineEdit did not find a unique container for selector "+E.options.selectors.editContainer+": "+k.dumpEl(E.editContainer))}}}if(E.editContainer.length===1&&!E.editField){E.editField=E.locate("edit",E.editContainer)}if(!F){return}var D=E.options.editModeRenderer(E);if(D){E.editContainer=D.container;E.editField=D.field}if(E.editField.length===0){k.fail("InlineEdit improperly initialised - editField could not be located (selector "+E.options.selectors.edit+")")}};var l=function(D){D.editContainer.hide();D.viewEl.show()};var e=function(D){if(D.isEditing()){setTimeout(function(){D.editView.value(D.model.value)},1);l(D);D.events.afterFinishEdit.fire(D.model.value,D.model.value,D.editField[0],D.viewEl[0])}};var r=function(H){var I=H.editView.value();var F=H.model.value;var D=H.viewEl[0];var G=H.editField[0];var E=H.events.onFinishEdit.fire(I,F,G,D);if(E===false){return
}H.updateModelValue(I);H.events.afterFinishEdit.fire(I,F,G,D);l(H)};var w=function(F){if(F.options.submitOnEnter===undefined){F.options.submitOnEnter="textarea"!==k.unwrap(F.editField).nodeName.toLowerCase()}function G(H){return H.keyCode?H.keyCode:(H.which?H.which:0)}var D=function(H){var I=G(H);if(I===i.ui.keyCode.ESCAPE){e(F);return false}};var E=function(H){var I=G(H);if(I!==i.ui.keyCode.ENTER){return true}r(F);F.viewEl.focus();return false};if(F.options.submitOnEnter){F.editContainer.keypress(E)}F.editContainer.keydown(D)};var h=function(D){if(D.options.blurHandlerBinder){D.options.blurHandlerBinder(D)}else{var E=function(F){if(D.isEditing()){r(D)}return false};D.editField.blur(E)}};var y=function(E,D){if(!E.editInitialized){d(E,!E.options.lazyEditView||!D);if(!E.options.lazyEditView||!D){E.editView=k.initSubcomponent(E,"editView",E.editField);i.extend(true,E.editView,k.initSubcomponent(E,"editAccessor",E.editField));w(E);h(E);E.editView.refreshView(E);E.editInitialized=true}}};var p=function(E){y(E,false);var D=E.viewEl;var F=E.displayView.value();E.updateModelValue(E.model.value===""?"":F);if(E.options.applyEditPadding){E.editField.width(Math.max(D.width()+E.options.paddings.edit,E.options.paddings.minimumEdit))}D.removeClass(E.options.styles.invitation);D.removeClass(E.options.styles.focus);D.hide();E.editContainer.show();if(E.tooltipEnabled()){i("#"+E.options.tooltipId).hide()}setTimeout(function(){E.editField.focus();k.setCaretToEnd(E.editField[0],E.editView.value());if(E.options.selectOnEdit){E.editField[0].select()}},0);E.events.afterBeginEdit.fire()};var A=function(E,D,F){E.removeClass(D);E.css("padding-right",F)};var t=function(D){D.displayView.value(D.options.defaultViewText);D.viewEl.css("padding-right",D.existingPadding);D.viewEl.addClass(D.options.styles.defaultViewStyle)};var x=function(D){D.displayView.value("");if(i.browser.msie){if(D.viewEl.css("display")==="inline"){D.viewEl.css("display","inline-block")}}};var o=function(D){D.displayView.value(D.model.value);A(D.viewEl,D.options.styles.defaultViewStyle,D.existingPadding)};var s=function(D,E){D.displayView.refreshView(D,E);if(D.editView){D.editView.refreshView(D,E)}};var z=function(D,E){D.model.value=E;D.refreshView()};var b=function(E,G,F){var D=E.options.modelComparator;var H=D?D(E.model.value,G):E.model.value===G;if(!H){var I=i.extend(true,{},E.model);E.model.value=G;E.events.modelChanged.fire(E.model,I,F);E.refreshView(F)}};var u=function(E,G){var F=function(H){E.addClass(G)};var D=function(H){E.removeClass(G)};E.hover(F,D)};var C=function(D){return function(){var E=D.events.onBeginEdit.fire();if(E===false){return false}p(D);return true}};function g(E){var D=k.unwrap(E.viewEl);return function(G){var F=k.findAncestor(G.target,function(H){if(/input|select|textarea|button|a/i.test(H.nodeName)||H===D){return true}});if(F===D){E.edit();return false}}}var B=function(D){u(D.viewEl,D.options.styles.invitation);D.viewEl.click(g(D))};var a=function(F,D,G){var H=function(){F.addClass(D);F.addClass(G)};var E=function(){F.removeClass(D);F.removeClass(G)};F.focus(H);F.blur(E)};var m=function(E){k.tabbable(E.viewEl);var D=g(E);k.activatable(E.viewEl,function(F){return D(F)})};var f=function(D,E){D.attr("role","button")};var v=function(H){if(H.editContainer.length>0&&H.editField.length>0){return{container:H.editContainer,field:H.editField}}var E="<span><input type='text' class='flc-inlineEdit-edit fl-inlineEdit-edit'/></span>";var J=i(E);var D=i("input",J);var G=H.container.attr("id");if(G){var I=G+"-edit-container";var F=G+"-edit";J.attr("id",I);D.attr("id",F)}H.viewEl.after(J);return{container:J,field:D}};var q=function(E){var D=false;E.events.onBeginEdit.addListener(function(){D=true});E.events.afterFinishEdit.addListener(function(){D=false});return function(){return D}};var c=function(D,E){var F=E.viewEl.css("padding-right");E.existingPadding=F?parseFloat(F):0;z(E,E.displayView.value());B(E);m(E);a(E.viewEl,E.options.styles.focus,E.options.styles.invitation);f(E.viewEl);if(E.editContainer){E.editContainer.hide()}var G=function(){if(E.tooltipEnabled()){E.viewEl.tooltip({delay:E.options.tooltipDelay,extraClass:E.options.styles.tooltip,bodyHandler:function(){return E.options.tooltipText},id:E.options.tooltipId})}};i(G);E.decorators=k.initSubcomponents(E,"componentDecorators",[E,k.COMPONENT_OPTIONS])};var j=function(F,D){var E=[];F.each(function(G,H){E.push(k.inlineEdit(i(H),D))});return E};k.inlineEdit=function(D,F){var E=k.initView("inlineEdit",D,F);E.viewEl=E.locate("text");E.displayView=k.initSubcomponent(E,"displayView",E.viewEl);i.extend(true,E.displayView,k.initSubcomponent(E,"displayAccessor",E.viewEl));E.model={value:""};E.edit=C(E);E.isEditing=q(E);E.finish=function(){r(E)};E.cancel=function(){e(E)};E.tooltipEnabled=function(){return E.options.useTooltip&&i.fn.tooltip};E.refreshView=function(G){s(E,G)};E.updateModelValue=function(H,G){b(E,H,G)};E.updateModel=function(G,H){b(E,G.value,H)};y(E,true);c(D,E);return E};k.inlineEdit.standardAccessor=function(D){var F=D.nodeName.toLowerCase();var E="input"===F||"textarea"===F?"val":"text";return{value:function(G){return i(D)[E](G)}}};k.inlineEdit.richTextViewAccessor=function(D){return{value:function(E){return i(D).html(E)}}};k.inlineEdit.standardDisplayView=function(E){var D={refreshView:function(F,G){if(F.model.value){o(F)}else{if(F.options.defaultViewText){t(F)}else{x(F)}}if((i.trim(F.viewEl.text()).length===0)&&(F.existingPadding<F.options.paddings.minimumView)){F.viewEl.css("padding-right",F.options.paddings.minimumView)}}};return D};k.inlineEdit.standardEditView=function(D){var E={refreshView:function(F,G){if(!G||F.editField&&F.editField.index(G)===-1){F.editView.value(F.model.value)}}};i.extend(true,E,k.inlineEdit.standardAccessor(D));return E};k.inlineEdits=function(E,F){F=F||{};var G=i.extend({},k.defaults("inlineEdits").selectors,F.selectors);var D=k.container(E);var H=i(G.editables,D);return j(H,F)};k.defaults("inlineEdit",{selectors:{text:".flc-inlineEdit-text",editContainer:".flc-inlineEdit-editContainer",edit:".flc-inlineEdit-edit"},styles:{text:"fl-inlineEdit-text",edit:"fl-inlineEdit-edit",invitation:"fl-inlineEdit-invitation",defaultViewStyle:"fl-inlineEdit-invitation-text",tooltip:"fl-inlineEdit-tooltip",focus:"fl-inlineEdit-focus"},events:{modelChanged:null,onBeginEdit:"preventable",afterBeginEdit:null,onFinishEdit:"preventable",afterFinishEdit:null,afterInitEdit:null},paddings:{edit:10,minimumEdit:80,minimumView:60},applyEditPadding:true,blurHandlerBinder:null,submitOnEnter:undefined,modelComparator:null,displayAccessor:{type:"fluid.inlineEdit.standardAccessor"},displayView:{type:"fluid.inlineEdit.standardDisplayView"},editAccessor:{type:"fluid.inlineEdit.standardAccessor"},editView:{type:"fluid.inlineEdit.standardEditView"},editModeRenderer:v,lazyEditView:false,defaultViewText:"Click here to edit",tooltipText:"Click item to edit",tooltipId:"tooltip",useTooltip:false,tooltipDelay:1000,selectOnEdit:false});k.defaults("inlineEdits",{selectors:{editables:".flc-inlineEditable"}})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(d,c){c.inlineEdit.makeViewAccessor=function(g,h,i){return function(j){return{value:function(l){var k=g(j);if(!k){if(l){d(j).val(l)}return""}if(l){h(j,k,l)}else{return i(k)}}}}};var a=function(k,g,h){var j=c.defaults(k);var i=c.merge(j?j.mergePolicy:null,{},j,h);return c.inlineEdit(g,i)};c.inlineEdit.normalizeHTML=function(h){var g=d.trim(h.replace(/\s+/g," "));g=g.replace(/\s+<\//g,"</");g=g.replace(/\<(\S+)[^\>\s]*\>/g,function(i){return i.toLowerCase()});return g};c.inlineEdit.htmlComparator=function(h,g){return c.inlineEdit.normalizeHTML(h)===c.inlineEdit.normalizeHTML(g)};c.inlineEdit.tinyMCE=function(g,h){var i=a("fluid.inlineEdit.tinyMCE",g,h);tinyMCE.init(i.options.tinyMCE);return i};c.inlineEdit.tinyMCE.getEditor=function(g){return tinyMCE.get(g.id)};c.inlineEdit.tinyMCE.setValue=function(g,h,i){d(g).val(i);h.setContent(i,{format:"raw"})};c.inlineEdit.tinyMCE.getValue=function(g){return g.getContent()};var f=c.inlineEdit.tinyMCE;f.viewAccessor=c.inlineEdit.makeViewAccessor(f.getEditor,f.setValue,f.getValue);c.inlineEdit.tinyMCE.blurHandlerBinder=function(g){function h(i){setTimeout(function(){tinyMCE.execCommand("mceFocus",false,g.editField[0].id);if(d.browser.mozilla&&d.browser.version.substring(0,3)==="1.8"){return}i.selection.select(i.getBody(),1);i.selection.collapse(0)},10)}g.events.afterInitEdit.addListener(function(i){h(i);var j=i.getBody();c.deadMansBlur(g.editField,d(j),function(){g.cancel()})});g.events.afterBeginEdit.addListener(function(){var i=tinyMCE.get(g.editField[0].id);if(i){h(i)}})};c.inlineEdit.tinyMCE.editModeRenderer=function(i){var h=i.options.tinyMCE;h.elements=c.allocateSimpleId(i.editField);var g=h.init_instance_callback;h.init_instance_callback=function(j){i.events.afterInitEdit.fire(j);if(g){g()}};tinyMCE.init(h)};c.defaults("fluid.inlineEdit.tinyMCE",{tinyMCE:{mode:"exact",theme:"simple"},useTooltip:true,selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.tinyMCE.viewAccessor"},lazyEditView:true,modelComparator:c.inlineEdit.htmlComparator,blurHandlerBinder:c.inlineEdit.tinyMCE.blurHandlerBinder,editModeRenderer:c.inlineEdit.tinyMCE.editModeRenderer});c.inlineEdit.FCKEditor=function(g,h){return a("fluid.inlineEdit.FCKEditor",g,h)};c.inlineEdit.FCKEditor.getEditor=function(g){var h=typeof(FCKeditorAPI)==="undefined"?null:FCKeditorAPI.GetInstance(g.id);return h};c.inlineEdit.FCKEditor.complete=c.event.getEventFirer();c.inlineEdit.FCKEditor.complete.addListener(function(h){var g=h.LinkedField;var i=d.data(g,"fluid.inlineEdit.FCKEditor");if(i&&i.events){i.events.afterInitEdit.fire(h)}});c.inlineEdit.FCKEditor.blurHandlerBinder=function(g){function h(i){i.Focus()}g.events.afterInitEdit.addListener(function(i){h(i)});g.events.afterBeginEdit.addListener(function(){var i=c.inlineEdit.FCKEditor.getEditor(g.editField[0]);
if(i){h(i)}})};c.inlineEdit.FCKEditor.editModeRenderer=function(i){var j=c.allocateSimpleId(i.editField);d.data(c.unwrap(i.editField),"fluid.inlineEdit.FCKEditor",i);var h=new FCKeditor(j);var g=c.copy(i.options.FCKEditor);g.BasePath=g.BasePath+"editor/";d.extend(true,h.Config,g);d.extend(true,h,i.options.FCKEditor);h.Config.fluidInstance=i;h.ReplaceTextarea()};c.inlineEdit.FCKEditor.setValue=function(g,h,i){h.SetHTML(i)};c.inlineEdit.FCKEditor.getValue=function(g){return g.GetHTML()};var e=c.inlineEdit.FCKEditor;e.viewAccessor=c.inlineEdit.makeViewAccessor(e.getEditor,e.setValue,e.getValue);c.defaults("fluid.inlineEdit.FCKEditor",{selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.FCKEditor.viewAccessor"},lazyEditView:true,modelComparator:c.inlineEdit.htmlComparator,blurHandlerBinder:c.inlineEdit.FCKEditor.blurHandlerBinder,editModeRenderer:c.inlineEdit.FCKEditor.editModeRenderer,FCKEditor:{BasePath:"fckeditor/"}});c.inlineEdit.CKEditor=function(g,h){return a("fluid.inlineEdit.CKEditor",g,h)};c.inlineEdit.CKEditor.getEditor=function(g){return CKEDITOR.instances[g.id]};c.inlineEdit.CKEditor.setValue=function(g,h,i){h.setData(i)};c.inlineEdit.CKEditor.getValue=function(g){return g.getData()};var b=c.inlineEdit.CKEditor;b.viewAccessor=c.inlineEdit.makeViewAccessor(b.getEditor,b.setValue,b.getValue);c.inlineEdit.CKEditor.focus=function(g){setTimeout(function(){g.focus()},0)};c.inlineEdit.CKEditor.normalizeHTML=function(i){var h=c.inlineEdit.normalizeHTML(i);var g=h.indexOf(">");if(g!==-1&&g<h.length-1){if(h.charAt(g+1)!==" "){h=h.substring(0,g+1)+" "+h.substring(g+1)}}return h};c.inlineEdit.CKEditor.htmlComparator=function(h,g){return c.inlineEdit.CKEditor.normalizeHTML(h)===c.inlineEdit.CKEditor.normalizeHTML(g)};c.inlineEdit.CKEditor.blurHandlerBinder=function(g){g.events.afterInitEdit.addListener(c.inlineEdit.CKEditor.focus);g.events.afterBeginEdit.addListener(function(){var h=c.inlineEdit.CKEditor.getEditor(g.editField[0]);if(h){c.inlineEdit.CKEditor.focus(h)}})};c.inlineEdit.CKEditor.editModeRenderer=function(h){var i=c.allocateSimpleId(h.editField);d.data(c.unwrap(h.editField),"fluid.inlineEdit.CKEditor",h);var g=CKEDITOR.replace(i,h.options.CKEditor);g.on("instanceReady",function(j){c.inlineEdit.CKEditor.focus(j.editor);h.events.afterInitEdit.fire(j.editor)})};c.defaults("fluid.inlineEdit.CKEditor",{selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.CKEditor.viewAccessor"},lazyEditView:true,modelComparator:c.inlineEdit.CKEditor.htmlComparator,blurHandlerBinder:c.inlineEdit.CKEditor.blurHandlerBinder,editModeRenderer:c.inlineEdit.CKEditor.editModeRenderer,CKEditor:{}});c.inlineEdit.dropdown=function(g,h){return a("fluid.inlineEdit.dropdown",g,h)};c.inlineEdit.dropdown.editModeRenderer=function(g){var h=c.allocateSimpleId(g.editField);g.editField.selectbox({finishHandler:function(){g.finish()}});return{container:g.editContainer,field:d("input.selectbox",g.editContainer)}};c.inlineEdit.dropdown.blurHandlerBinder=function(g){c.deadMansBlur(g.editField,d("div.selectbox-wrapper li",g.editContainer),function(){g.cancel()})};c.defaults("fluid.inlineEdit.dropdown",{applyEditPadding:false,blurHandlerBinder:c.inlineEdit.dropdown.blurHandlerBinder,editModeRenderer:c.inlineEdit.dropdown.editModeRenderer})})(jQuery,fluid_1_2);function FCKeditor_OnComplete(a){fluid.inlineEdit.FCKEditor.complete.fire(a)}var fluid_1_2=fluid_1_2||{};(function(b,a){a.dom.computeAbsolutePosition=function(c){var e=0,d=0;if(c.offsetParent){do{e+=c.offsetLeft;d+=c.offsetTop;c=c.offsetParent}while(c);return[e,d]}};a.dom.cleanseScripts=function(c){var d=b.data(c,a.dom.cleanseScripts.MARKER);if(!d){a.dom.iterateDom(c,function(e){return e.tagName.toLowerCase()==="script"?"delete":null});b.data(c,a.dom.cleanseScripts.MARKER,true)}};a.dom.cleanseScripts.MARKER="fluid-scripts-cleansed";a.dom.insertAfter=function(c,d){var e=d.nextSibling;if(!e){d.parentNode.appendChild(c)}else{d.parentNode.insertBefore(c,e)}};a.dom.isWhitespaceNode=function(c){return !(/[^\t\n\r ]/.test(c.data))};a.dom.isIgnorableNode=function(c){return(c.nodeType===8)||((c.nodeType===3)&&a.dom.isWhitespaceNode(c))}})(jQuery,fluid_1_2);var fluid_1_2=fluid_1_2||{};(function(f,g){g.orientation={HORIZONTAL:4,VERTICAL:1};g.rectSides={4:["left","right"],1:["top","bottom"],8:"top",12:"bottom",2:"left",3:"right"};g.position={BEFORE:-1,AFTER:1,INSIDE:2,REPLACE:3};g.direction={NEXT:1,PREVIOUS:-1,UP:8,DOWN:12,LEFT:2,RIGHT:3};g.directionSign=function(k){return k===g.direction.UP||k===g.direction.LEFT?g.direction.PREVIOUS:g.direction.NEXT};g.directionAxis=function(k){return k===g.direction.LEFT||k===g.direction.RIGHT?0:1};g.directionOrientation=function(k){return g.directionAxis(k)?g.orientation.VERTICAL:g.orientation.HORIZONTAL};g.keycodeDirection={up:g.direction.UP,down:g.direction.DOWN,left:g.direction.LEFT,right:g.direction.RIGHT};g.moveDom=function(m,n,k){m=g.unwrap(m);n=g.unwrap(n);var l;if(k===g.position.INSIDE){n.appendChild(m)}else{if(k===g.position.BEFORE){for(l=n.previousSibling;;l=l.previousSibling){if(!l||!g.dom.isIgnorableNode(l)){if(l!==m){g.dom.cleanseScripts(m);n.parentNode.insertBefore(m,n)}break}}}else{if(k===g.position.AFTER){for(l=n.nextSibling;;l=l.nextSibling){if(!l||!g.dom.isIgnorableNode(l)){if(l!==m){g.dom.cleanseScripts(m);g.dom.insertAfter(m,n)}break}}}else{g.fail("Unrecognised position supplied to fluid.moveDom: "+k)}}}};g.normalisePosition=function(l,n,k,m){if(l===g.position.REPLACE){l=n&&k>=m?g.position.AFTER:g.position.BEFORE}return l};g.permuteDom=function(n,r,q,l,o){n=g.unwrap(n);r=g.unwrap(r);var p=f.inArray(n,l);if(p===-1){g.fail("Error in permuteDom: source element "+g.dumpEl(n)+" not found in source list "+g.dumpEl(l))}var v=f.inArray(r,o);if(v===-1){g.fail("Error in permuteDom: target element "+g.dumpEl(r)+" not found in source list "+g.dumpEl(o))}var k=l===o;q=g.normalisePosition(q,k,v,p);var u={};u[g.position.AFTER]=n.nextSibling;u[g.position.BEFORE]=n.previousSibling;g.moveDom(l[p],o[v],q);var t=k?v-1:l.length-2;var m;if(q===g.position.BEFORE&&k){t--}if(!k||v>p){for(m=t;m>p;--m){g.moveDom(l[m+1],l[m],g.position.AFTER)}if(p+1<l.length){g.moveDom(l[p+1],u[g.position.AFTER],g.position.BEFORE)}}var s=k?p-1:o.length-1;if(q===g.position.AFTER){v++}if(!k||v<p){for(m=v;m<s;++m){g.moveDom(o[m],o[m+1],g.position.BEFORE)}if(s>=0&&s<o.length-1){g.moveDom(o[s],u[g.position.BEFORE],g.position.AFTER)}}};var b=function(k,l){return window.getComputedStyle?window.getComputedStyle(k,null).getPropertyValue(l):k.currentStyle[l]};var h=function(k){while(k&&k.nodeName){if(k.nodeName==="BODY"){return true}k=k.parentNode}return false};var j=function(k){return"hidden"===k.type||b(k,"display")==="none"||b(k,"visibility")==="hidden"||!h(k)};var e=function(m,l,q){var o={};o.element=m;o.orientation=l;if(q===g.position.INSIDE){o.position=q}if(j(m)){o.clazz="hidden"}var p=g.dom.computeAbsolutePosition(m)||[0,0];var n=m.offsetWidth;var k=m.offsetHeight;o.rect={left:p[0],top:p[1]};o.rect.right=p[0]+n;o.rect.bottom=p[1]+k;return o};var c=10000;function d(k){return"Rect top: "+k.top+" left: "+k.left+" bottom: "+k.bottom+" right: "+k.right}function i(k){if(!k||!k.rect){return"null"}else{return d(k.rect)+" position: "+k.position+" for "+g.dumpEl(k.element)}}g.dropManager=function(){var s=[];var l={};var r={};var n;function t(x){return g.allocateSimpleId(x)}function u(x,C,A,B,D,z){var y=f.extend(true,{},A);y.rect[C[B]]=y.rect[C[1-B]]+(B?1:-1);y.rect[C[1-B]]=(B?-1:1)*c;y.position=D===g.position.INSIDE?D:(B?g.position.BEFORE:g.position.AFTER);y.clazz=z;x[x.length]=y}function q(A,y,z,x,C,B){var F=f.extend(true,{},z);var D=f.extend(true,{},z);var E=(F.rect[y[0]]+F.rect[y[1]])/2;F.rect[y[1]]=E;F.position=g.position.BEFORE;D.rect[y[0]]=E;D.position=g.position.AFTER;F.clazz=C;D.clazz=B;A[A.length]=F;A[A.length]=D}function p(z,y,A,x,B){y+=A;if(y<0&&x==="locked"){return"locked"}if(y>=z.length||B===null){return null}else{A=z[y];return B(A)==="locked"&&x==="locked"?"locked":null}}var o;var m,k;r.updateGeometry=function(G){o=G;s=[];l={};var x=G.elementMapper;for(var F=0;F<G.extents.length;++F){var B=G.extents[F];var y=B.orientation;var z=g.rectSides[y];var A=function(L,I,O,P,K){var J=e(L,y,P);J.owner=B;if(J.clazz!=="hidden"&&x){J.clazz=x(L)}l[t(L)]=J;var M=p(B.elements,K,g.position.BEFORE,J.clazz,x);var N=p(B.elements,K,g.position.AFTER,J.clazz,x);if(P===g.position.INSIDE){s[s.length]=J}else{q(s,z,J,P,M,N)}if(I&&G.sentinelize){u(s,z,J,1,P,M)}if(O&&G.sentinelize){u(s,z,J,0,P,N)}return J};var H=true;for(var C=0;C<B.elements.length;++C){var E=B.elements[C];var D=A(E,C===0,C===B.elements.length-1,g.position.INTERLEAVED,C);if(D.clazz!=="hidden"){H=false}}if(H&&B.parentElement){A(B.parentElement,true,true,g.position.INSIDE)}}};r.startDrag=function(C,B,z,A){var E=B[0]+z/2;var D=B[1]+A/2;var y=E-C.pageX;var x=D-C.pageY;r.updateGeometry(o);n=null;m=y;k=x;f("body").bind("mousemove.fluid-dropManager",r.mouseMove)};r.lastPosition=function(){return n};r.endDrag=function(){f("body").unbind("mousemove.fluid-dropManager")};r.mouseMove=function(A){var z=A.pageX+m;var C=A.pageY+k;var B=r.closestTarget(z,C,n);if(B&&B!==g.dropManager.NO_CHANGE){n=B;r.dropChangeFirer.fire(B)}};r.dropChangeFirer=g.event.getEventFirer();var v={element:null};r.closestTarget=function(I,G,D){var C=Number.MAX_VALUE;var A=v;var z=Number.MAX_VALUE;var H=v;for(var F=0;F<s.length;++F){var E=s[F];if(E.clazz==="hidden"){continue}var B=g.geom.minPointRectangle(I,G,E.rect);if(E.clazz==="locked"){if(B<z){z=B;H=E}}else{if(B<C){C=B;A=E}if(B===0){break}}}if(!A){return A}if(z>=C){H=v}if(D&&D.position===A.position&&g.unwrap(D.element)===g.unwrap(A.element)&&g.unwrap(D.lockedelem)===g.unwrap(H.element)){return g.dropManager.NO_CHANGE}return{position:A.position,element:A.element,lockedelem:H.element}};r.shuffleProjectFrom=function(x,A,z){var y=r.projectFrom(x,A,z);
if(y){y.position=g.position.REPLACE}return y};r.projectFrom=function(A,C,B){r.updateGeometry(o);var z=l[t(A)];var y=g.geom.projectFrom(z.rect,C,s,B);if(!y.cacheelem){return null}var x=y.cacheelem.position;return{element:y.cacheelem.element,position:x?x:g.position.BEFORE}};function w(y,A,z){var B=g.directionSign(A);var x=f(z).index(y)+B;if(x<0){x+=z.length}x%=z.length;return z[x]}r.logicalFrom=function(y,A,z){var x=r.getOwningSpan(y,g.position.INTERLEAVED,z);return{element:w(y,A,x),position:g.position.REPLACE}};r.lockedWrapFrom=function(z,D,C){var B=r.logicalFrom(z,D,C);var x=r.getOwningSpan(z,g.position.INTERLEAVED,C);var A=l[t(z)].owner.elements;if(C||x[0]===A[0]){return B}var y=w(z,D,A);if(o.elementMapper(y)==="locked"){B.element=null;B.clazz="locked"}return B};r.getOwningSpan=function(z,y,B){var x=l[t(z)].owner;var A=y===g.position.INSIDE?[x.parentElement]:x.elements;if(!B&&o.elementMapper){A=f.makeArray(A);g.remove_if(A,function(C){return o.elementMapper(C)==="locked"})}return A};r.geometricMove=function(A,B,x){var y=r.getOwningSpan(A,null,true);var z=r.getOwningSpan(B,x,true);g.permuteDom(A,B,x,y,z)};return r};g.dropManager.NO_CHANGE="no change";g.geom=g.geom||{};g.geom.minPointRectangle=function(k,o,n){var m=k<n.left?(n.left-k):(k>n.right?(k-n.right):0);var l=o<n.top?(n.top-o):(o>n.bottom?(o-n.bottom):0);return m*m+l*l};g.geom.minRectRect=function(n,l){var m=n.right<l.left?l.left-n.right:l.right<n.left?n.left-l.right:0;var k=n.bottom<l.top?l.top-n.bottom:l.bottom<n.top?n.top-l.bottom:0;return m*m+k*k};var a=function(){return{mindist:Number.MAX_VALUE,minrdist:Number.MAX_VALUE}};g.geom.projectFrom=function(o,A,B,u){var m=g.directionAxis(A);var x=g.rectSides[A];var v=g.rectSides[m*15+5-A];var r=g.directionSign(A);var k={left:(7*o.left+1*o.right)/8,right:(5*o.left+3*o.right)/8,top:(7*o.top+1*o.bottom)/8,bottom:(5*o.top+3*o.bottom)/8};k[x]=r*c;k[v]=-k[x];function C(G,E,H){var F=E.rect;var I=g.geom.minRectRect(k,F);var D=-r*H*(o[H===1?x:v]-F[H===1?v:x]);if(I<=G.mindist&&D>=0){if(I===G.mindist&&D*H>G.minrdist){return}G.minrdist=D*H;G.mindist=I;G.minelem=E}}var s=a();var w=a();var n=a();for(var y=0;y<B.length;++y){var z=B[y];var l=z.owner&&z.element===z.owner.parentElement;if(z.clazz==="hidden"||u&&l){continue}else{if(!u&&z.clazz==="locked"){C(n,z,1)}else{C(s,z,1);C(w,z,-1)}}}var q=!s.minelem||w.mindist<s.mindist;var t=q?w:s;var p={wrapped:q,cacheelem:t.minelem};if(n.mindist<t.mindist){p.lockedelem=n.minelem}return p}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(c,d){var b=function(n,k,l){d.dom.cleanseScripts(d.unwrap(n));var m=c(n).clone();d.dom.iterateDom(m.get(0),function(o){o.removeAttribute("id");if(o.tagName.toLowerCase()==="input"){o.setAttribute("disabled","disabled")}});m.removeAttr("id");m.removeClass("ui-droppable");m.addClass(k);if(l){var j=c(document.createElement("div"));j.append(m);j.append(l);m=j}c("body").append(m);if(!c.browser.safari){m.css("display","block").width(n.offsetWidth).height(n.offsetHeight)}if(c.browser.opera){m.hide()}return m};function f(k,m,n,j){var l=m;var o=false;if(c.browser.opera){k.keypress(function(p){if(o){o=false;p.preventDefault();return false}});l=function(q){var p=m(q);if(p===false){o=true}}}k.keydown(l);k.keyup(n)}function i(j){j.container.attr("role",j.options.containerRole.container);j.container.attr("aria-multiselectable","false");j.container.attr("aria-readonly","false");j.container.attr("aria-disabled","false")}function a(j){return j+"_avatar"}var h=function(j){if(j.keysets&&!(j.keysets instanceof Array)){j.keysets=[j.keysets]}};d.reorderer=function(y,l){if(!y){d.fail("Reorderer initialised with no container")}var z=d.initView("fluid.reorderer",y,l);l=z.options;var s=d.dropManager();z.layoutHandler=d.initSubcomponent(z,"layoutHandler",[z.container,l,s,z.dom]);z.activeItem=undefined;h(l);var j=z.locate("dropWarning");var w;if(j){w=j.clone()}var B=function(E){var G=l.keysets;for(var F=0;F<G.length;F++){if(G[F].modifier(E)){return true}}return false};var k=function(){return c.inArray(z.activeItem,z.dom.fastLocate("movables"))>=0};var m=function(E){z.dom.fastLocate("dropTargets").attr("aria-dropeffect",E)};var t=l.styles;var u=function(E){return(!E.ctrlKey&&!E.altKey&&!E.shiftKey&&!E.metaKey)};var C=function(L){var N=z.activeItem;if(!N){return true}var E=l.keysets;for(var H=0;H<E.length;H++){var G=E[H];var K=d.keyForValue(G,L.keyCode);if(!K){continue}var M=G.modifier(L);var F=d.keycodeDirection[K];var I=z.layoutHandler.getRelativePosition(N,F,!M);if(!I){continue}if(M){var J=z.events.onBeginMove.fire(N);if(J===false){return false}if(j.length>0){if(I.clazz==="locked"){z.events.onShowKeyboardDropWarning.fire(N,j);j.show()}else{j.hide()}}if(I.element){z.requestMovement(I,N)}}else{if(u(L)){N.blur();c(I.element).focus()}}return false}return true};z.handleKeyDown=function(E){if(!z.activeItem||z.activeItem!==E.target){return true}var F=c(z.activeItem);if(!F.hasClass(t.dragging)&&B(E)){if(k()){F.removeClass(t.selected);F.addClass(t.dragging);F.attr("aria-grabbed","true");m("move")}return false}return C(E)};z.handleKeyUp=function(E){if(!z.activeItem||z.activeItem!==E.target){return true}var F=c(z.activeItem);if(F.hasClass(t.dragging)&&!B(E)){if(j){j.hide()}F.removeClass(t.dragging);F.addClass(t.selected);F.attr("aria-grabbed","false");m("none");return false}return false};var n;var o=function(F){var E=c(document.createElement(F));E.addClass(l.styles.dropMarker);E.hide();return E};d.logEnabled=true;z.requestMovement=function(F,E){if(!F||d.unwrap(F.element)===d.unwrap(E)){return}z.events.onMove.fire(E,F);s.geometricMove(E,F.element,F.position);c(z.activeItem).focus();z.refresh();s.updateGeometry(z.layoutHandler.getGeometricInfo());z.events.afterMove.fire(E,F,z.dom.fastLocate("movables"))};var x=function(E,F){z.dom.fastLocate("grabHandle",E)[F?"addClass":"removeClass"](t.hover)};function r(G){var F=l.styles;G.attr("aria-grabbed","false");G.mouseover(function(){z.events.onHover.fire(G,true)});G.mouseout(function(){z.events.onHover.fire(G,false)});var E;z.dom.fastLocate("grabHandle",G).draggable({refreshPositions:false,scroll:true,helper:function(){var H;if(w){H=w[0]}E=c(l.avatarCreator(G[0],F.avatar,H));E.attr("id",a(z.container.id));return E},start:function(N,M){var I=z.events.onBeginMove.fire(G);if(I===false){return false}var L=z.dom.fastLocate("grabHandle",G)[0];var K=d.dom.computeAbsolutePosition(L);var H=L.offsetWidth;var J=L.offsetHeight;G.focus();G.removeClass(l.styles.selected);G.addClass(l.styles.mouseDrag);G.attr("aria-grabbed","true");m("move");s.startDrag(N,K,H,J);E.show()},stop:function(J,I){G.removeClass(l.styles.mouseDrag);G.addClass(l.styles.selected);c(z.activeItem).attr("aria-grabbed","false");var H=d.unwrap(n);if(H.parentNode){H.parentNode.removeChild(H)}E.hide();I.helper=null;m("none");s.endDrag();z.requestMovement(s.lastPosition(),G);z.activeItem.focus()},handle:z.dom.fastLocate("grabHandle",G)})}function D(E,F){E.removeClass(F.selected);E.removeClass(F.dragging);E.addClass(F.defaultStyle);E.attr("aria-selected","false")}var q=function(G){z.events.onSelect.fire(G);var F=l.styles;if(z.activeItem&&z.activeItem!==G){D(c(z.activeItem),F)}z.activeItem=G;var E=c(G);E.removeClass(F.defaultStyle);E.addClass(F.selected);E.attr("aria-selected","true")};var A=function(){var H=function(J){D(c(this),l.styles);return J.stopPropagation()};var I=function(J){q(this);return J.stopPropagation()};var E=z.dom.fastLocate("selectables");for(var G=0;G<E.length;++G){var F=c(E[G]);if(!c.data(F[0],"fluid.reorderer.selectable-initialised")){F.addClass(t.defaultStyle);F.blur(H);F.focus(I);F.click(function(J){var K=d.unwrap(z.dom.fastLocate("grabHandle",this));if(d.dom.isContainer(K,J.target)){c(this).focus()}});F.attr("role",l.containerRole.item);F.attr("aria-selected","false");F.attr("aria-disabled","false");c.data(F[0],"fluid.reorderer.selectable-initialised",true)}}if(!z.selectableContext){z.selectableContext=d.selectable(z.container,{selectableElements:E,selectablesTabindex:z.options.selectablesTabindex,direction:null})}};var v=function(E){d.moveDom(n,E.element,E.position);n.css("display","");if(w){if(E.lockedelem){w.show()}else{w.hide()}}};var p=function(){var H=z.dom.fastLocate("movables");var G=z.dom.fastLocate("dropTargets");A();for(var E=0;E<H.length;E++){var F=H[E];if(!c.data(F,"fluid.reorderer.movable-initialised")){r(c(F));c.data(F,"fluid.reorderer.movable-initialised",true)}}if(H.length>0&&!n){n=o(H[0].tagName)}s.updateGeometry(z.layoutHandler.getGeometricInfo());s.dropChangeFirer.addListener(v,"fluid.Reorderer");G.attr("aria-dropeffect","none")};if(z.container){f(z.container,z.handleKeyDown,z.handleKeyUp);i(z);d.tabbable(z.container);p()}if(l.afterMoveCallbackUrl){z.events.afterMove.addListener(function(){var E=z.layoutHandler;var F=E.getModel?E.getModel():l.acquireModel(z);c.post(l.afterMoveCallbackUrl,JSON.stringify(F))},"postModel")}z.events.onHover.addListener(x,"style");z.refresh=function(){z.dom.refresh("movables");z.dom.refresh("selectables");z.dom.refresh("grabHandle",z.dom.fastLocate("movables"));z.dom.refresh("stylisticOffset",z.dom.fastLocate("movables"));z.dom.refresh("dropTargets");z.events.onRefresh.fire();p();z.selectableContext.selectables=z.dom.fastLocate("selectables");z.selectableContext.selectablesUpdated(z.activeItem)};z.refresh();return z};d.reorderer.keys={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:19,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,i:73,j:74,k:75,m:77};d.reorderer.defaultKeysets=[{modifier:function(j){return j.ctrlKey},up:d.reorderer.keys.UP,down:d.reorderer.keys.DOWN,right:d.reorderer.keys.RIGHT,left:d.reorderer.keys.LEFT},{modifier:function(j){return j.ctrlKey},up:d.reorderer.keys.i,down:d.reorderer.keys.m,right:d.reorderer.keys.k,left:d.reorderer.keys.j}];d.reorderer.roles={GRID:{container:"grid",item:"gridcell"},LIST:{container:"list",item:"listitem"},REGIONS:{container:"main",item:"article"}};var e=function(j,k,l){l=l||{};l.layoutHandler=k;return d.reorderer(j,l)};d.reorderList=function(j,k){return e(j,"fluid.listLayoutHandler",k)
};d.reorderGrid=function(j,k){return e(j,"fluid.gridLayoutHandler",k)};d.reorderer.SHUFFLE_GEOMETRIC_STRATEGY="shuffleProjectFrom";d.reorderer.GEOMETRIC_STRATEGY="projectFrom";d.reorderer.LOGICAL_STRATEGY="logicalFrom";d.reorderer.WRAP_LOCKED_STRATEGY="lockedWrapFrom";d.reorderer.NO_STRATEGY=null;d.reorderer.relativeInfoGetter=function(k,m,l,j,n){return function(p,r,o){var q=d.directionOrientation(r);var s=q===k?m:l;return s!==null?j[s](p,r,o):null}};d.defaults("fluid.reorderer",{styles:{defaultStyle:"fl-reorderer-movable-default",selected:"fl-reorderer-movable-selected",dragging:"fl-reorderer-movable-dragging",mouseDrag:"fl-reorderer-movable-dragging",hover:"fl-reorderer-movable-hover",dropMarker:"fl-reorderer-dropMarker",avatar:"fl-reorderer-avatar"},selectors:{dropWarning:".flc-reorderer-dropWarning",movables:".flc-reorderer-movable",grabHandle:"",stylisticOffset:""},avatarCreator:b,keysets:d.reorderer.defaultKeysets,layoutHandler:{type:"fluid.listLayoutHandler"},events:{onShowKeyboardDropWarning:null,onSelect:null,onBeginMove:"preventable",onMove:null,afterMove:null,onHover:null,onRefresh:null},mergePolicy:{keysets:"replace","selectors.selectables":"selectors.movables","selectors.dropTargets":"selectors.movables"}});function g(j,l,k){return function(){return{sentinelize:l,extents:[{orientation:j,elements:k.fastLocate("dropTargets")}],elementMapper:function(m){return c.inArray(m,k.fastLocate("movables"))===-1?"locked":null}}}}d.defaults(true,"fluid.listLayoutHandler",{orientation:d.orientation.VERTICAL,containerRole:d.reorderer.roles.LIST,selectablesTabindex:-1,sentinelize:true});d.listLayoutHandler=function(k,l,j,n){var m={};m.getRelativePosition=d.reorderer.relativeInfoGetter(l.orientation,d.reorderer.LOGICAL_STRATEGY,null,j,n);m.getGeometricInfo=g(l.orientation,l.sentinelize,n);return m};d.defaults(true,"fluid.gridLayoutHandler",{orientation:d.orientation.HORIZONTAL,containerRole:d.reorderer.roles.GRID,selectablesTabindex:-1,sentinelize:false});d.gridLayoutHandler=function(k,l,j,n){var m={};m.getRelativePosition=d.reorderer.relativeInfoGetter(l.orientation,d.reorderer.LOGICAL_STRATEGY,d.reorderer.SHUFFLE_GEOMETRIC_STRATEGY,j,n);m.getGeometricInfo=g(l.orientation,l.sentinelize,n);return m}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(d,f){var k=function(l,m){return l+"lightbox-cell:"+m+":"};var j=function(l){var m=function(n){if(n.which===f.reorderer.keys.ENTER){var o=d("a",n.target);document.location=o.attr("href")}};l.keypress(m)};var b=function(p,r,n){var l=p.getElementsByTagName(r);var q=[];for(var o=0;o<l.length;o+=1){var m=l[o];var s=m.id;if(s&&s.match(n)){q.push(m)}}return q};var h=function(l,m){l=f.unwrap(l);var n="^"+k(m,"[0-9]+")+"$";return function(){return b(l,"div",n)}};var a=function(l){return f.findAncestor(l,function(m){return d(m).is("form")})};var e=function(l,m){return b(m,"input","^"+k(l.attr("id"),"[^:]*")+"reorder-index$")};var c=function(m,q){var l=e(m,q);for(var p=0;p<l.length;p++){var n=l[p];var o=n.name;n.name=o||n.id}};var i=function(l){var m=a(l);c(l,m);return function(){var o,p;o=e(l,m);for(p=0;p<o.length;p+=1){o[p].value=p}if(m&&m.action){var n=d(m).serialize();d.post(m.action,n,function(r,s,q){})}}};var g=function(p,o,n){var m=f.model.getBeanValue(p,o);var l=m||n;f.model.setBeanValue(p,o,l)};f.reorderImages=function(l,n){var o=f.initView("fluid.reorderImages",l,n);g(o,"options.listeners.afterMove",o.options.afterMoveCallback||i(o.container));g(o,"options.selectors.movables",h(o.container,o.container.attr("id")));var m=f.reorderer(o.container,o.options);f.transform(m.locate("movables"),function(p){f.reorderImages.addAriaRoles(o.options.selectors.imageTitle,p)});f.tabindex(d("a",o.container),-1);j(o.container);return m};f.reorderImages.addAriaRoles=function(m,l){l=d(l);l.attr("role","img");var p=d(m,l);if(p[0]===l[0]||p[0]===document){f.fail("Could not locate cell title using selector "+m+" in context "+f.dumpEl(l))}var n=f.allocateSimpleId(p);l.attr("aria-labelledby",n);var o=d("img",l);o.attr("role","presentation");o.attr("alt","")};f.lightbox=f.reorderImages;f.defaults("fluid.reorderImages",{layoutHandler:"fluid.gridLayoutHandler",selectors:{imageTitle:".flc-reorderer-imageTitle"}})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(c,b){b.moduleLayout=b.moduleLayout||{};var e=function(g,f){return b.find(f.columns,function(j,i){var h=c.inArray(g,j.elements);return h===-1?null:{columnIndex:i,itemIndex:h}},{columnIndex:-1,itemIndex:-1})};var a=function(g,f){return b.find(f.columns,function(i,h){return g===i.container?h:null},-1)};b.moduleLayout.updateLayout=function(i,k,g,h){i=b.unwrap(i);k=b.unwrap(k);var f=e(i,h);h.columns[f.columnIndex].elements.splice(f.itemIndex,1);var m;if(g===b.position.INSIDE){m=h.columns[a(k,h)].elements;m.splice(m.length,0,i)}else{var l=e(k,h);m=h.columns[l.columnIndex].elements;g=b.normalisePosition(g,f.columnIndex===l.columnIndex,l.itemIndex,f.itemIndex);var j=g===b.position.BEFORE?0:1;m.splice(l.itemIndex+j,0,i)}};b.moduleLayout.layoutFromFlat=function(f,h,g){var i={};i.container=f;i.columns=b.transform(h,function(j){return{container:j,elements:c.makeArray(g.filter(function(){return b.dom.isContainer(j,this)}))}});return i};b.moduleLayout.layoutFromIds=function(f){return{container:b.byId(f.id),columns:b.transform(f.columns,function(g){return{container:b.byId(g.id),elements:b.transform(g.children,b.byId)}})}};b.moduleLayout.layoutToIds=function(f){return{id:b.getId(f.container),columns:b.transform(f.columns,function(g){return{id:b.getId(g.container),children:b.transform(g.elements,b.getId)}})}};var d=function(g,f){if(f){var h=c(g).offset();f=c(f);f.css("position","absolute");f.css("top",h.top);f.css("left",h.left)}};b.defaults(true,"fluid.moduleLayoutHandler",{orientation:b.orientation.VERTICAL,containerRole:b.reorderer.roles.REGIONS,selectablesTabindex:0,sentinelize:true});b.moduleLayoutHandler=function(g,n,j,h){var k={};function m(){var p;if(n.selectors.modules){p=b.moduleLayout.layoutFromFlat(g,h.locate("columns"),h.locate("modules"))}if(!p){var o=b.model.getBeanValue(n,"moduleLayout.layout");b.moduleLayout.layoutFromIds(o)}return p}var i=m();k.layout=i;function f(o){var p=n.selectors.lockedModules?h.fastLocate("lockedModules"):[];return c.inArray(o,p)!==-1}k.getRelativePosition=b.reorderer.relativeInfoGetter(n.orientation,b.reorderer.WRAP_LOCKED_STRATEGY,b.reorderer.GEOMETRIC_STRATEGY,j,h);k.getGeometricInfo=function(){var s=[];var r={extents:s,sentinelize:n.sentinelize};r.elementMapper=function(t){return f(t)?"locked":null};for(var o=0;o<i.columns.length;o++){var q=i.columns[o];var p={orientation:n.orientation,elements:c.makeArray(q.elements),parentElement:q.container};s.push(p)}return r};function l(o){return function(){var p=b.accumulate(i.columns,function(q,r){return r.concat(q.elements)},[]);if(!o){b.remove_if(p,f)}return p}}k.returnedOptions={selectors:{movables:l(false),dropTargets:l(false),selectables:l(true)},listeners:{onMove:function(o,p){b.moduleLayout.updateLayout(o,p.element,p.position,i)},onRefresh:function(){i=m();k.layout=i},"onShowKeyboardDropWarning.setPosition":d}};k.getModel=function(){return b.moduleLayout.layoutToIds(i)};return k}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(b,a){a.reorderLayout=function(c,f){var e={layoutHandler:"fluid.moduleLayoutHandler",selectors:{columns:".flc-reorderer-column",modules:".flc-reorderer-module"}};var d=b.extend(true,e,f);return a.reorderer(c,d)}})(jQuery,fluid_1_2);
/*!	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){if(!M.w3){return}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f()}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false)}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f()}});if(O==top){(function(){if(J){return}try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()})()}}if(M.wk){(function(){if(J){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}s(f)}}();function f(){if(J){return}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]()}}function K(X){if(J){X()}else{U[U.length]=X}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false)}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false)}else{if(typeof O.attachEvent!=D){i(O,"onload",Y)}else{if(typeof O.onload=="function"){var X=O.onload;
O.onload=function(){X();Y()}}else{O.onload=Y}}}}}function h(){if(T){V()}else{H()}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return}}X.removeChild(aa);Z=null;H()})()}else{H()}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa)}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class")}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align")}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value")}}P(ai,ah,Y,ab)}else{p(ae);if(ab){ab(aa)}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z}ab(aa)}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z}}}return X}function A(){return !a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null}else{l=ae;Q=X}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310"}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac}else{ab.flashvars=ac}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae)}else{setTimeout(arguments.callee,10)}})()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(g(Y),Y)}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true))}}}}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X}if(aa){if(typeof ai.id==D){ai.id=Y}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae]}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"'}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"'}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />'}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac])}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac])}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab])}}aa.parentNode.replaceChild(Z,aa);X=Z}}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa)}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null}}Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return}var aa=j.getElementsByTagName("head")[0];if(!aa){return}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;G=null}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1]}G=X}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y)}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(!m){return}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y}else{v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2])}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa])}for(var Y in M){M[Y]=null}M=null;for(var X in swfobject){swfobject[X]=null}swfobject=null})}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false)}else{if(Z){Z({success:false,id:ab})}}},getObjectById:function(X){if(M.w3){return z(X)}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al]}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak]}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai]}else{am.flashvars=ai+"="+Z[ai]}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true)}X.success=true;X.ref=an}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return}else{w(ah,true)}}if(ac){ac(X)}})}else{if(ac){ac(X)}}},switchOffAutoHideShow:function(){m=false},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X)}else{return undefined}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y)}},removeSWF:function(X){if(M.w3){y(X)}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X)}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1]}if(aa==null){return L(Z)}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block"}}if(E){E(B)}}a=false}}}}();fluid_1_2=fluid_1_2||{};(function(f,g){var e=function(r,q,p){q=(q)?q:p;r.animate(q.params,q.duration,q.callback)};var l=function(r,p,q){r.queue("fx",[]);r.animate({width:p,queue:false},q)};var i=function(p,q){if(q===false){p.displayElement.show()}else{e(p.displayElement,q,p.options.showAnimation)}};var a=function(r,q,s){q=(q===null||isNaN(q))?r.options.delay:q;if(q){var p=setTimeout(function(){a(r,0,s)},q)}else{if(s===false){r.displayElement.hide()}else{e(r.displayElement,s,r.options.hideAnimation)}}};var o=function(r,q,t){t=t||false;var p=r.indicator.width();var s=r.options.animate;if((q>p)&&(s==="both"||s==="forward")&&!t){l(r.indicator,q,r.options.speed)}else{if((q<p)&&(s==="both"||s==="backward")&&!t){l(r.indicator,q,r.options.speed)}else{r.indicator.width(q)}}};var j=function(q,p){return Math.round((Math.min(p,100)*q.progressBar.width())/100)};var n=function(p){var q=Math.max(j(p,parseFloat(p.storedPercent)),p.options.minWidth);o(p,q,true)};var k=function(p){p.attr("role","progressbar");p.attr("aria-valuemin","0");p.attr("aria-valuemax","100");p.attr("aria-valuenow","0");p.attr("aria-valuetext","");p.attr("aria-busy","false")};var h=function(s,r){var q=r<100&&r>0;s.ariaElement.attr("aria-busy",q);s.ariaElement.attr("aria-valuenow",r);if(q){var p=g.stringTemplate(s.options.ariaBusyText,{percentComplete:r});s.ariaElement.attr("aria-valuetext",p)}else{if(r===100){s.ariaElement.attr("aria-valuetext",s.options.ariaDoneText)}}};var d=function(p,q){p.html(q)};var m=function(p){p.indicator.css("top",p.progressBar.position().top).css("left",0).height(p.progressBar.height());n(p)};var b=function(r,q,p,t){i(r,t);if(q!==null){r.storedPercent=q;var s=Math.max(j(r,parseFloat(q)),r.options.minWidth);o(r,s)}if(p!==null){d(r.label,p)}if(r.ariaElement){h(r,q)}};var c=function(p){p.displayElement=p.locate("displayElement");if(p.options.initiallyHidden){p.displayElement.hide()}p.progressBar=p.locate("progressBar");p.label=p.locate("label");p.indicator=p.locate("indicator");p.ariaElement=p.locate("ariaElement");p.indicator.width(p.options.minWidth);p.storedPercent=0;if(p.ariaElement){k(p.ariaElement)}};g.progress=function(p,q){var r=g.initView("fluid.progress",p,q);c(r);r.show=function(s){i(r,s)};r.hide=function(s,t){a(r,s,t)};r.update=function(s,t,u){b(r,s,t,u)};r.refreshView=function(){m(r)};return r};g.defaults("fluid.progress",{selectors:{displayElement:".flc-progress",progressBar:".flc-progress-bar",indicator:".flc-progress-indicator",label:".flc-progress-label",ariaElement:".flc-progress-bar"},showAnimation:{params:{opacity:"show"},duration:"slow",callback:null},hideAnimation:{params:{opacity:"hide"},duration:"slow",callback:null},minWidth:5,delay:0,speed:200,animate:"forward",initiallyHidden:true,updatePosition:false,ariaBusyText:"Progress is %percentComplete percent complete",ariaDoneText:"Progress is complete."})
})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(e,f){var a=function(n,m,o,k){if(!k){return}var l=Math.min(o.chunkSize,n.size);o.bytesUploaded=Math.min(o.bytesUploaded+l,n.size);m.onFileProgress.fire(n,o.bytesUploaded,n.size)};var h=function(l,k){if(l.swfUploadSettings){l.swfUploadSettings.upload_complete_handler(k)}else{l.events.afterFileComplete.fire(k)}};var d=function(l,k){l.queueManager.finishFile(k);if(l.queueManager.shouldUploadNextFile()){i(l)}else{l.queueManager.complete()}};var c=function(l){if(!l.queue.isUploading){return}var k=l.demoState.currentFile;k.filestatus=f.uploader.fileStatusConstants.COMPLETE;l.events.onFileSuccess.fire(k);l.demoState.fileIdx++;d(l,k)};var g=function(l){if(!l.queue.isUploading){return}var k=l.demoState.currentFile;if(l.demoState.bytesUploaded<k.size){l.invokeAfterRandomDelay(function(){a(k,l.events,l.demoState,l.queue.isUploading);g(l)})}else{c(l)}};var i=function(k){k.demoState.currentFile=k.queue.files[k.demoState.fileIdx];k.demoState.chunksForCurrentFile=Math.ceil(k.demoState.currentFile/k.demoState.chunkSize);k.demoState.bytesUploaded=0;k.queue.isUploading=true;k.events.onFileStart.fire(k.demoState.currentFile);k.demoState.currentFile.filestatus=f.uploader.fileStatusConstants.IN_PROGRESS;g(k)};var j=function(l){var k=l.demoState.currentFile;k.filestatus=f.uploader.fileStatusConstants.CANCELLED;l.queue.shouldStop=true;l.events.onFileError.fire(k,f.uploader.errorConstants.UPLOAD_STOPPED,"The demo upload was paused by the user.");d(l,k);l.events.onUploadStop.fire()};var b=function(k){if(k.options.simulateDelay===undefined||k.options.simulateDelay===null){k.options.simulateDelay=true}k.demoState={fileIdx:0,chunkSize:200000};return k};f.demoUploadManager=function(k){var l=k;l.start=function(){l.queueManager.start();i(l)};l.stop=function(){j(l)};l.invokeAfterRandomDelay=function(n){var m;if(l.options.simulateDelay){m=Math.floor(Math.random()*1000+100);setTimeout(n,m)}else{n()}};b(l);return l}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(e,f){var h=function(n,o){var k=[];for(var m=0;m<n.length;m++){var l=n[m];if(o(l)===true){k.push(l)}}return k};var c=function(k){return h(k.files,function(l){return(l.filestatus===f.uploader.fileStatusConstants.COMPLETE)})};var i=function(k){return h(k.files,function(l){return(l.filestatus===f.uploader.fileStatusConstants.QUEUED||l.filestatus===f.uploader.fileStatusConstants.CANCELLED)})};var j=function(k){return h(k.files,function(l){return(l.filestatus===f.uploader.fileStatusConstants.ERROR)})};var b=function(m,l){var k=e.inArray(l,m.files);m.files.splice(k,1)};var g=function(k){k.currentBatch={fileIdx:-1,files:[],totalBytes:0,numFilesCompleted:0,numFilesErrored:0,bytesUploadedForFile:0,previousBytesUploadedForFile:0,totalBytesUploaded:0}};var a=function(k){var l=k.getReadyFiles();k.currentBatch.files=l;k.currentBatch.totalBytes=f.fileQueue.sizeOfFiles(l)};var d=function(k){g(k);a(k)};f.fileQueue=function(){var k={};k.files=[];k.isUploading=false;k.addFile=function(l){k.files.push(l)};k.removeFile=function(l){b(k,l)};k.totalBytes=function(){return f.fileQueue.sizeOfFiles(k.files)};k.getReadyFiles=function(){return i(k)};k.getErroredFiles=function(){return j(k)};k.sizeOfReadyFiles=function(){return f.fileQueue.sizeOfFiles(k.getReadyFiles())};k.getUploadedFiles=function(){return c(k)};k.sizeOfUploadedFiles=function(){return f.fileQueue.sizeOfFiles(k.getUploadedFiles())};k.setupCurrentBatch=function(){d(k)};k.clearCurrentBatch=function(){g(k)};k.updateCurrentBatch=function(){a(k)};return k};f.fileQueue.sizeOfFiles=function(m){var n=0;for(var l=0;l<m.length;l++){var k=m[l];n+=k.size}return n};f.fileQueue.manager=function(k,l){var m={};m.queue=k;m.events=l;m.start=function(){m.queue.setupCurrentBatch();m.queue.isUploading=true;m.queue.shouldStop=false;m.events.onUploadStart.fire(m.queue.currentBatch.files)};m.startFile=function(){m.queue.currentBatch.fileIdx++;m.queue.currentBatch.bytesUploadedForFile=0;m.queue.currentBatch.previousBytesUploadedForFile=0};m.finishFile=function(o){var n=m.queue.currentBatch;n.numFilesCompleted++;m.events.afterFileComplete.fire(o)};m.shouldUploadNextFile=function(){return !m.queue.shouldStop&&m.queue.isUploading&&m.queue.currentBatch.numFilesCompleted<m.queue.currentBatch.files.length};m.complete=function(){m.events.afterUploadComplete.fire(m.queue.currentBatch.files);m.queue.clearCurrentBatch()};return m}})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(f,d){var a=function(i){var h=i.options.maxHeight;var j=(i.scrollingElm.children().eq(0).height()>h);var g=(j)?h:"";i.scrollingElm.height(g)};var e=function(g){g.scrollingElm[0].scrollTop=g.scrollingElm[0].scrollHeight};var c=function(k,j){if(!j||j.length<1){return}var l=0;var h=0;var p=j[0].offsetTop;var i=j.height();var m=k.scrollingElm[0].scrollTop;var o=k.scrollingElm.height();if(k.options.padScroll){var g=j.prev().height();l=(g+i<=o)?g:0;var n=j.next().height();h=(n+i<=o)?n:0}if((p-l)<m){k.scrollingElm[0].scrollTop=p-l}if(((p+i)+h)>(m+o)){i=(i<o)?i:o;k.scrollingElm[0].scrollTop=(p-o+i+h)}};var b=function(g){g.scrollingElm=g.container.parents(g.options.selectors.wrapper);if(!g.scrollingElm.length){d.fail({name:"Missing Scroller",message:"The scroller wrapper element was not found."})}if(!f.browser.msie||f.browser.version>6){g.scrollingElm.css("max-height",g.options.maxHeight)}};d.scroller=function(g,h){var i=d.initView("fluid.scroller",g,h);b(i);i.scrollTo=function(j){c(i,j)};i.scrollBottom=function(){e(i)};i.refreshView=function(){if(f.browser.msie&&f.browser.version<7){a(i)}};i.refreshView();return i};d.defaults("fluid.scroller",{selectors:{wrapper:".flc-scroller"},maxHeight:180,padScroll:true})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(h,j){var b=function(){var r=function(){};SWFUpload.prototype.selectFile=r;SWFUpload.prototype.selectFiles=r};var f=function(r,s){r.returnedOptions={uploadManager:{type:s.options.uploadManager.type||s.options.uploadManager}}};var g=function(s){var r=h("<div><span></span></div>");r.addClass(s.options.styles.flash9Container);h("body").append(r);return r};var a=function(r){var s=g(r);r.returnedOptions.uploadManager.options={flashURL:r.options.flash9URL||undefined,flashButtonPeerId:j.allocateSimpleId(s.children().eq(0))}};var c=function(s,r){r.wrap("<div class='"+s.options.styles.uploaderWrapperFlash10+"'></div>");var t=h("<div><span></span></div>");t.addClass(s.options.styles.browseButtonOverlay);r.after(t);b();return t};var o=function(s,u){var v=s.options,t=c(s,u.container),r=u.locate("browseButton");j.tabindex(r,-1);s.isTransparent=v.flashButtonAlwaysVisible?false:(!h.browser.msie||v.transparentEvenInIE);s.returnedOptions.uploadManager.options={flashURL:v.flash10URL||undefined,flashButtonImageURL:s.isTransparent?undefined:v.flashButtonImageURL,flashButtonPeerId:j.allocateSimpleId(t.children().eq(0)),flashButtonHeight:v.flashButtonHeight||r.outerHeight(),flashButtonWidth:v.flashButtonWidth||r.outerWidth(),flashButtonWindowMode:s.isTransparent?SWFUpload.WINDOW_MODE.TRANSPARENT:SWFUpload.WINDOW_MODE.OPAQUE,flashButtonCursorEffect:SWFUpload.CURSOR.HAND,listeners:{onUploadStart:function(){u.uploadManager.swfUploader.setButtonDisabled(true)},afterUploadComplete:function(){u.uploadManager.swfUploader.setButtonDisabled(false)}}}};j.swfUploadSetupDecorator=function(t,r){var s={};j.mergeComponentOptions(s,"fluid.swfUploadSetupDecorator",r);s.flashVersion=swfobject.getFlashPlayerVersion().major;f(s,t);if(s.flashVersion===9){a(s,t)}else{o(s,t)}return s};j.defaults("fluid.swfUploadSetupDecorator",{flashButtonAlwaysVisible:false,transparentEvenInIE:true,flashButtonImageURL:"../images/browse.png",styles:{browseButtonOverlay:"fl-uploader-browse-overlay",flash9Container:"fl-uploader-flash9-container",uploaderWrapperFlash10:"fl-uploader-flash10-wrapper"}});var m={uploadURL:"upload_url",flashURL:"flash_url",postParams:"post_params",fileSizeLimit:"file_size_limit",fileTypes:"file_types",fileTypesDescription:"file_types_description",fileUploadLimit:"file_upload_limit",fileQueueLimit:"file_queue_limit",flashButtonPeerId:"button_placeholder_id",flashButtonImageURL:"button_image_url",flashButtonHeight:"button_height",flashButtonWidth:"button_width",flashButtonWindowMode:"button_window_mode",flashButtonCursorEffect:"button_cursor",debug:"debug"};var q={afterReady:"swfupload_loaded_handler",onFileDialog:"file_dialog_start_handler",afterFileQueued:"file_queued_handler",onQueueError:"file_queue_error_handler",afterFileDialog:"file_dialog_complete_handler",onFileStart:"upload_start_handler",onFileProgress:"upload_progress_handler",onFileError:"upload_error_handler",onFileSuccess:"upload_success_handler"};var p=function(w,u,v){var r=v||{};for(var s in u){var t=w[s];if(t){r[t]=u[s]}}return r};var k=function(v,x,w){var s=w||{};for(var t in v.events){var r=v.events[t].fire;var u=x[t];if(u){s[u]=r}}s.upload_complete_handler=function(y){v.queueManager.finishFile(y);if(v.queueManager.shouldUploadNextFile()){v.swfUploader.startUpload()}else{if(v.queueManager.queue.shouldStop){v.swfUploader.stopUpload()}v.queueManager.complete()}};return s};var l=function(r){if(r.queue.isUploading){return}if(r.options.fileQueueLimit===1){r.swfUploader.selectFile()}else{r.swfUploader.selectFiles()}};var i=function(r){r.queue.shouldStop=true;r.events.onUploadStop.fire()};var e=function(r){var s=function(t){j.find(r.queue.files,function(u){if(u.id===t.id){u.filestatus=t.filestatus;return true}})};r.events.afterFileQueued.addListener(function(t){r.queue.addFile(t)});r.events.onFileStart.addListener(function(t){r.queueManager.startFile();s(t)});r.events.onFileProgress.addListener(function(u,x,v){var t=r.queue.currentBatch;var w=x-t.previousBytesUploadedForFile;t.totalBytesUploaded+=w;t.bytesUploadedForFile+=w;t.previousBytesUploadedForFile=x;s(u)});r.events.onFileError.addListener(function(u,t){if(t===j.uploader.errorConstants.UPLOAD_STOPPED){r.queue.isUploading=false}else{if(r.queue.isUploading){r.queue.currentBatch.totalBytesUploaded+=u.size;r.queue.currentBatch.numFilesErrored++
}}s(u)});r.events.onFileSuccess.addListener(function(t){if(r.queue.currentBatch.bytesUploadedForFile===0){r.queue.currentBatch.totalBytesUploaded+=t.size}s(t)});r.events.afterUploadComplete.addListener(function(){r.queue.isUploading=false})};var d=function(s,r){s.queue.removeFile(r);s.swfUploader.cancelUpload(r.id);s.events.afterFileRemoved.fire(r)};var n=function(s,r){s.events=r;s.queue=j.fileQueue();s.queueManager=j.fileQueue.manager(s.queue,s.events);s.swfUploadSettings=p(m,s.options);k(s,q,s.swfUploadSettings);s.swfUploader=new SWFUpload(s.swfUploadSettings);e(s)};j.swfUploadManager=function(s,r){var t={};j.mergeComponentOptions(t,"fluid.swfUploadManager",r);j.mergeListeners(s,t.options.listeners);t.browseForFiles=function(){l(t)};t.removeFile=function(u){d(t,u)};t.start=function(){t.queueManager.start();t.swfUploader.startUpload()};t.stop=function(){i(t)};n(t,s);return t};j.defaults("fluid.swfUploadManager",{uploadURL:"",flashURL:"../../../lib/swfupload/flash/swfupload.swf",flashButtonPeerId:"",postParams:{},fileSizeLimit:"20480",fileTypes:"*",fileTypesDescription:null,fileUploadLimit:0,fileQueueLimit:0,debug:false})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(g,i){var D=function(G,F){return G.locate("fileQueue").find("#"+F.id)};var f=function(G,F){return g("#"+F.id+"_error",G.container)};var e=function(I,J){var H=I.uploadManager.queue.files;for(var G=0;G<H.length;G++){var F=H[G];if(F.id.toString()===J.attr("id")){return F}}return null};var u=function(G,F){var H=F.id+"_progress";return G.fileProgressors[H]};var A=function(H,F){var G=D(H,F);H.scroller.scrollTo(G);var I=u(H,F);I.refreshView();I.show()};var r=function(I,G,H,F){var J=i.uploader.derivePercent(H,F);var K=J+"%";u(I,G).update(J,K)};var n=function(H,F){var G=D(H,F);u(H,F).hide();if(F.filestatus===i.uploader.fileStatusConstants.COMPLETE){H.locate("fileIconBtn",G).removeClass(H.options.styles.dim)}};var c=function(H,G){var I=u(H,G);if(!I){return}var F=I.displayElement;F.remove()};var B=function(F,G){G.fadeOut("fast",function(){G.remove();F.refreshView()})};var E=function(G,F){if(F.filestatus===i.uploader.fileStatusConstants.ERROR){B(G,f(G,F))}};var b=function(G,F,H){c(G,F);E(G,F);G.uploadManager.removeFile(F);B(G,H)};var l=function(G,H){var F=e(G,H);if(!F||F.filestatus===i.uploader.fileStatusConstants.COMPLETE){return}b(G,F,H)};var w=function(G,F){var H=D(G,F);b(G,F,H)};var k=function(I,G){var H=function(){if(I.hasClass(G.ready)&&!I.hasClass(G.uploading)){I.addClass(G.hover)}};var F=function(){if(I.hasClass(G.ready)&&!I.hasClass(G.uploading)){I.removeClass(G.hover)}};I.hover(H,F)};var j=function(F,H){var G=function(){l(F,H)};i.activatable(H,null,{additionalBindings:[{key:g.ui.keyCode.DELETE,activateHandler:G}]})};var m=function(F,G){if(g.browser.msie&&g.browser.version<7){k(G,F.options.styles)}F.locate("fileIconBtn",G).click(function(){l(F,G)});j(F,G)};var q=function(G,F){var H=G.rowTemplate.clone();H.removeClass(G.options.styles.hiddenTemplate);G.locate("fileName",H).text(F.name);G.locate("fileSize",H).text(i.uploader.formatFileSize(F.size));G.locate("fileIconBtn",H).addClass(G.options.styles.remove);H.attr("id",F.id);H.addClass(G.options.styles.ready);m(G,H);return H};var s=function(G,J){var F=G.rowProgressorTemplate.clone();var H=J.attr("id");var I=H+"_progress";F.attr("id",I);F.css("top",J.position().top);F.height(J.height()).width(5);G.container.after(F);G.fileProgressors[I]=i.progress(G.uploadContainer,{selectors:{progressBar:"#"+H,displayElement:"#"+I,label:"#"+I+" .fl-uploader-file-progress-text",indicator:"#"+I}})};var v=function(G,F){var H=q(G,F);if(!(g.browser.msie&&(g.browser.version>=8))){H.hide()}G.container.append(H);H.fadeIn("slow");G.scroller.scrollBottom();s(G,H);G.refreshView()};var z=function(F){var G=F.locate("fileIconBtn",F.locate("fileRows"));G.attr("disabled","disabled");G.addClass(F.options.styles.dim)};var h=function(F){var G=F.locate("fileIconBtn",F.locate("fileRows"));G.removeAttr("disabled");G.removeClass(F.options.styles.dim)};var p=function(F,H,G){H.removeClass(F.options.styles.ready).removeClass(F.options.styles.error).addClass(G)};var a=function(H,G){var I=D(H,G);p(H,I,H.options.styles.uploaded);I.attr("title",H.options.strings.status.success);i.enabled(I,false);var F=H.locate("fileIconBtn",I);F.unbind("click");F.removeClass(H.options.styles.remove);F.attr("title",H.options.strings.status.success)};var x=function(I,K,F){var H=I.errorInfoRowTemplate.clone();H.attr("id",K.attr("id")+"_error");var J=i.keyForValue(i.uploader.errorConstants,F);var G=I.options.strings.errors[J];I.locate("errorText",H).text(G);K.after(H);I.scroller.scrollTo(H)};var C=function(I,G,F){n(I,G);if(G.filestatus===i.uploader.fileStatusConstants.ERROR){var H=D(I,G);p(I,H,I.options.styles.error);x(I,H,F)}};var t=function(F){F.returnedOptions={listeners:{afterFileQueued:F.addFile,onUploadStart:F.prepareForUpload,onFileStart:F.showFileProgress,onFileProgress:F.updateFileProgress,onFileSuccess:F.markFileComplete,onFileError:F.showErrorForFile,afterFileComplete:F.hideFileProgress,afterUploadComplete:F.refreshAfterUpload}}};var y=function(F){i.tabbable(F.container);F.selectableContext=i.selectable(F.container,{selectableSelector:F.options.selectors.fileRows,onSelect:function(G){g(G).addClass(F.options.styles.selected)},onUnselect:function(G){g(G).removeClass(F.options.styles.selected)}})};var o=function(F){F.rowTemplate=F.locate("rowTemplate").remove();F.errorInfoRowTemplate=F.locate("errorInfoRowTemplate").remove();F.errorInfoRowTemplate.removeClass(F.options.styles.hiddenTemplate);F.rowProgressorTemplate=F.locate("rowProgressorTemplate",F.uploadContainer).remove()};var d=function(G,F){G.uploadManager=F;G.scroller=i.scroller(G.container);o(G);y(G);t(G)};i.fileQueueView=function(G,J,F,H){var I=i.initView("fluid.fileQueueView",G,H);I.uploadContainer=J;I.fileProgressors={};I.addFile=function(K){v(I,K)};I.removeFile=function(K){w(I,K)};I.prepareForUpload=function(){z(I)};I.refreshAfterUpload=function(){h(I)};I.showFileProgress=function(K){A(I,K)};I.updateFileProgress=function(L,M,K){r(I,L,M,K)};I.markFileComplete=function(K){u(I,K).update(100,"100%");a(I,K)};I.showErrorForFile=function(L,K){C(I,L,K)};I.hideFileProgress=function(K){n(I,K)};I.refreshView=function(){I.scroller.refreshView();I.selectableContext.refresh()};d(I,F);return I};i.defaults("fluid.fileQueueView",{selectors:{fileRows:".flc-uploader-file",fileName:".flc-uploader-file-name",fileSize:".flc-uploader-file-size",fileIconBtn:".flc-uploader-file-action",errorText:".flc-uploader-file-error",rowTemplate:".flc-uploader-file-tmplt",errorInfoRowTemplate:".flc-uploader-file-error-tmplt",rowProgressorTemplate:".flc-uploader-file-progressor-tmplt"},styles:{hover:"fl-uploader-file-hover",selected:"fl-uploader-file-focus",ready:"fl-uploader-file-state-ready",uploading:"fl-uploader-file-state-uploading",uploaded:"fl-uploader-file-state-uploaded",error:"fl-uploader-file-state-error",remove:"fl-uploader-file-action-remove",dim:"fl-uploader-dim",hiddenTemplate:"fl-uploader-hidden-templates"},strings:{progress:{toUploadLabel:"To upload: %fileCount %fileLabel (%totalBytes)",singleFile:"file",pluralFiles:"files"},status:{success:"File Uploaded",error:"File Upload Error"},errors:{HTTP_ERROR:"File upload error: a network error occured or the file was rejected (reason unknown).",IO_ERROR:"File upload error: a network error occured.",UPLOAD_LIMIT_EXCEEDED:"File upload error: you have uploaded as many files as you are allowed during this session",UPLOAD_FAILED:"File upload error: the upload failed for an unknown reason.",QUEUE_LIMIT_EXCEEDED:"You have as many files in the queue as can be added at one time. Removing files from the queue may allow you to add different files.",FILE_EXCEEDS_SIZE_LIMIT:"One or more of the files that you attempted to add to the queue exceeded the limit of %fileSizeLimit.",ZERO_BYTE_FILE:"One or more of the files that you attempted to add contained no data.",INVALID_FILETYPE:"One or more files were not added to the queue because they were of the wrong type."}}})})(jQuery,fluid_1_2);(function(h,l){var n=function(D,E){return(E===1)?D.options.strings.progress.singleFile:D.options.strings.progress.pluralFiles};var u=function(D,E){E.removeAttr("disabled");E.removeClass(D.options.styles.dim)};var o=function(D,E){E.attr("disabled","disabled");E.addClass(D.options.styles.dim)};var a=function(D,E){E.removeClass(D.options.styles.hidden)};var f=function(D,E){E.addClass(D.options.styles.hidden)};var A=function(F,E){E=E||false;var D=F.totalProgress.indicator;D.toggleClass(F.options.styles.totalProgress,!E);D.toggleClass(F.options.styles.totalProgressError,E)};var g=function(D){o(D,D.locate("uploadButton"));if(D.uploadManager.queue.files.length===0){D.locate("browseButton").text(D.options.strings.buttons.browse);a(D,D.locate("instructions"))}};var c=function(D){o(D,D.locate("uploadButton"));u(D,D.locate("browseButton"));f(D,D.locate("pauseButton"));a(D,D.locate("uploadButton"))};var m=function(D){D.locate("browseButton").text(D.options.strings.buttons.addMore);f(D,D.locate("pauseButton"));a(D,D.locate("uploadButton"));u(D,D.locate("uploadButton"));u(D,D.locate("browseButton"));f(D,D.locate("instructions"));D.totalProgress.hide()};var d=function(D){D.totalProgress.hide(false,false);A(D);f(D,D.locate("uploadButton"));o(D,D.locate("browseButton"));u(D,D.locate("pauseButton"));a(D,D.locate("pauseButton"));D.locate(D.options.focusWithEvent.afterUploadStart).focus()};var x=function(G){var E=G.uploadManager.queue.getReadyFiles().length;var H=G.uploadManager.queue.sizeOfReadyFiles();var D=n(G,E);var F=l.stringTemplate(G.options.strings.progress.toUploadLabel,{fileCount:E,fileLabel:D,totalBytes:l.uploader.formatFileSize(H)});G.locate("totalFileStatusText").html(F)};var b=function(I){var G=I.uploadManager.queue.currentBatch;var D=l.uploader.derivePercent(G.totalBytesUploaded,G.totalBytes);var F=G.files.length;var H=n(I,F);var E=l.stringTemplate(I.options.strings.progress.totalProgressLabel,{curFileN:G.fileIdx+1,totalFilesN:F,fileLabel:H,currBytes:l.uploader.formatFileSize(G.totalBytesUploaded),totalBytes:l.uploader.formatFileSize(G.totalBytes)});
I.totalProgress.update(D,E)};var s=function(H){var J=H.uploadManager.queue.getErroredFiles().length;var I=H.uploadManager.queue.files.length;var F=n(H,I);var G="";if(J>0){var E=(J===1)?H.options.strings.progress.singleError:H.options.strings.progress.pluralErrors;A(H,true);G=l.stringTemplate(H.options.strings.progress.numberOfErrors,{errorsN:J,errorLabel:E})}var D=l.stringTemplate(H.options.strings.progress.completedLabel,{curFileN:H.uploadManager.queue.getUploadedFiles().length,totalFilesN:I,errorString:G,fileLabel:F,totalCurrBytes:l.uploader.formatFileSize(H.uploadManager.queue.sizeOfUploadedFiles())});H.totalProgress.update(100,D)};var t=function(D){D.locate("browseButton").click(function(E){D.uploadManager.browseForFiles();E.preventDefault()});D.locate("uploadButton").click(function(){D.uploadManager.start()});D.locate("pauseButton").click(function(){D.uploadManager.stop()})};var C=function(D){if(D.uploadManager.queue.getReadyFiles().length>0){m(D);x(D);D.locate(D.options.focusWithEvent.afterFileDialog).focus()}};var i=function(D){if(D.uploadManager.queue.getReadyFiles().length===0){g(D)}x(D)};var j=function(D){};var p=function(E){var D=E.uploadManager.queue.shouldStop;if(E.uploadManager.queue.getReadyFiles().length===0){c(E)}else{m(E)}s(E)};var w=function(D){D.events.afterFileDialog.addListener(function(){C(D)});D.events.afterFileRemoved.addListener(function(){i(D)});D.events.onUploadStart.addListener(function(){d(D)});D.events.onUploadStop.addListener(function(){D.locate(D.options.focusWithEvent.afterUploadStop).focus()});D.events.onFileProgress.addListener(function(){b(D)});D.events.onFileSuccess.addListener(function(){b(D)});D.events.onFileError.addListener(function(F,E,G){if(E===l.uploader.errorConstants.UPLOAD_STOPPED){j(D)}});D.events.afterUploadComplete.addListener(function(){p(D)})};var z=function(E){var D=l.initSubcomponent(E,"uploadManager",[E.events,l.COMPONENT_OPTIONS]);return E.options.demo?l.demoUploadManager(D):D};var k=function(D){D.decorators=l.initSubcomponents(D,"decorators",[D,l.COMPONENT_OPTIONS]);D.uploadManager=z(D);D.fileQueueView=l.initSubcomponent(D,"fileQueueView",[D.locate("fileQueue"),D.container,D.uploadManager,l.COMPONENT_OPTIONS]);D.totalProgress=l.initSubcomponent(D,"totalProgressBar",[D.container,l.COMPONENT_OPTIONS]);o(D,D.locate("uploadButton"));t(D);w(D)};l.uploader=function(D,E){var F=l.initView("fluid.uploader",D,E);k(F);return F};l.progressiveEnhanceableUploader=function(D,F,E){F=l.container(F);D=l.container(D);if(swfobject.getFlashPlayerVersion().major<9){F.show()}else{D.show();return l.uploader(D,E)}};l.uploader.formatFileSize=function(D){if(typeof D==="number"){if(D===0){return"0.0 KB"}else{if(D>0){if(D<1048576){return(Math.ceil(D/1024*10)/10).toFixed(1)+" KB"}else{return(Math.ceil(D/1048576*10)/10).toFixed(1)+" MB"}}}}return""};l.uploader.derivePercent=function(D,E){return Math.round((D*100)/E)};l.defaults("fluid.uploader",{demo:false,decorators:[{type:"fluid.swfUploadSetupDecorator"},{type:"fluid.manuallyDegrade",options:{selectors:{enhanceable:".fl-uploader.fl-progEnhance-basic"}}}],uploadManager:{type:"fluid.swfUploadManager"},fileQueueView:{type:"fluid.fileQueueView"},totalProgressBar:{type:"fluid.progress",options:{selectors:{progressBar:".flc-uploader-queue-footer",displayElement:".flc-uploader-total-progress",label:".flc-uploader-total-progress-text",indicator:".flc-uploader-total-progress",ariaElement:".flc-uploader-total-progress"}}},selectors:{fileQueue:".flc-uploader-queue",browseButton:".flc-uploader-button-browse",uploadButton:".flc-uploader-button-upload",pauseButton:".flc-uploader-button-pause",totalFileStatusText:".flc-uploader-total-progress-text",instructions:".flc-uploader-browse-instructions"},focusWithEvent:{afterFileDialog:"uploadButton",afterUploadStart:"pauseButton",afterUploadStop:"uploadButton"},styles:{disabled:"fl-uploader-disabled",hidden:"fl-uploader-hidden",dim:"fl-uploader-dim",totalProgress:"fl-uploader-total-progress-okay",totalProgressError:"fl-uploader-total-progress-errored"},events:{afterReady:null,onFileDialog:null,afterFileQueued:null,afterFileRemoved:null,onQueueError:null,afterFileDialog:null,onUploadStart:null,onUploadStop:null,onFileStart:null,onFileProgress:null,onFileError:null,onFileSuccess:null,afterFileComplete:null,afterUploadComplete:null},strings:{progress:{toUploadLabel:"To upload: %fileCount %fileLabel (%totalBytes)",totalProgressLabel:"Uploading: %curFileN of %totalFilesN %fileLabel (%currBytes of %totalBytes)",completedLabel:"Uploaded: %curFileN of %totalFilesN %fileLabel (%totalCurrBytes)%errorString",numberOfErrors:", %errorsN %errorLabel",singleFile:"file",pluralFiles:"files",singleError:"error",pluralErrors:"errors"},buttons:{browse:"Browse Files",addMore:"Add More",stopUpload:"Stop Upload",cancelRemaning:"Cancel remaining Uploads",resumeUpload:"Resume Upload"}}});l.uploader.errorConstants={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};l.uploader.fileStatusConstants={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};var B=function(D,H,E,G){var F=h("<a href='#'>"+H+"</a>");F.addClass(E);if(D==="before"){G.before(F)}else{G.after(F)}return F};var e=function(D,E){if(window.opera){D.show().removeClass("hideUploaderForOpera");E.show().addClass("hideUploaderForOpera")}else{D.show();E.hide()}};var y=function(D){var F=B(D.options.defaultRenderLocation,D.options.strings.degradeLinkText,D.options.styles.degradeLinkClass,D.enhancedContainer);F.addClass("flc-manuallyDegrade-degrade");var E=B(D.options.defaultRenderLocation,D.options.strings.enhanceLinkText,D.options.styles.enhanceLinkClass,D.degradedContainer);E.addClass("flc-manuallyDegrade-enhance")};var v=function(D){D.degradeControl=D.locate("degradeControl");D.enhanceControl=D.locate("enhanceControl")};var r=function(D){if(!D.degradedContainer.length){return}v(D);if(!D.degradeControl.length&&!D.enhanceControl.length){D.options.controlRenderer(D);v(D)}D.degradeControl.click(D.degrade);D.enhanceControl.click(D.enhance);D.enhanceControl.hide()};var q=function(D){var E=l.defaults("fluid.manuallyDegrade");return(D&&D.container)?D.container:E.container};l.manuallyDegrade=function(F,E){var D=q(E);var H=l.initView("fluid.manuallyDegrade",D,E);var G=false;H.enhancedContainer=F.container;H.degradedContainer=H.locate("enhanceable");H.degrade=function(){e(H.enhanceControl,H.degradeControl);e(H.degradedContainer,H.enhancedContainer);G=true};H.enhance=function(){e(H.degradeControl,H.enhanceControl);e(H.enhancedContainer,H.degradedContainer);G=false};H.isDegraded=function(){return G};r(H);return H};l.defaults("fluid.manuallyDegrade",{container:"body",controlRenderer:y,defaultRenderLocation:"before",strings:{degradeLinkText:"Switch to the standard single-file Uploader",enhanceLinkText:"Switch to the Flash-based multi-file Uploader"},selectors:{enhanceable:".fl-ProgEnhance-basic",degradeControl:".flc-manuallyDegrade-degrade",enhanceControl:".flc-manuallyDegrade-enhance"},styles:{degradeLinkClass:"fl-uploader-manually-degrade",enhanceLinkClass:"fl-uploader-manually-enhance"}})})(jQuery,fluid_1_2);fluid_1_2=fluid_1_2||{};(function(d,h){function s(y,z,B){if(!y.pageLinks){return}if(B.pageIndex!==undefined){var A=y.pageLinks.eq(B.pageIndex);A.removeClass(y.options.styles.currentPage)}var x=y.pageLinks.eq(z.pageIndex);x.addClass(y.options.styles.currentPage)}function j(y,x,z){y.unbind("click.fluid.pager");y.bind("click.fluid.pager",function(){x.initiatePageChange.fire(z)})}function b(x){x.pageCount=Math.max(1,Math.floor((x.totalRange-1)/x.pageSize)+1)}function l(x){return Math.min(x.totalRange,(x.pageIndex+1)*x.pageSize)}h.pager=function(){return h.pagerImpl.apply(null,arguments)};h.pager.directPageList=function(x,B,z){var C=h.initView("fluid.pager.directPageList",x,z);C.pageLinks=C.locate("pageLinks");for(var A=0;A<C.pageLinks.length;++A){var y=C.pageLinks.eq(A);j(y,B,{pageIndex:A})}B.onModelChange.addListener(function(D,E){s(C,D,E)});C.defaultModel={pageIndex:undefined,pageSize:1,totalRange:C.pageLinks.length};return C};h.iota=function(z,A){A=A||0;var y=[];for(var x=0;x<z;++x){y[y.length]=A++}return y};h.pager.everyPageStrategy=h.iota;h.pager.gappedPageStrategy=function(x,y){if(!x){x=3}if(!y){y=x}return function(E,F,A){var D=[];var z=0;var C=false;for(var B=0;B<E;++B){if(B<x||(E-B-1)<x||(B>=A-y&&B<=A+y)){D[z++]=B;C=false}else{if(!C){D[z++]=-1;C=true}}}return D}};h.pager.renderedPageList=function(x,F,z,G,E){G=d.extend(true,z,G);var B=h.initView("fluid.pager.renderedPageList",x,G);G=B.options;var y={cutpoints:[{id:"page-link:link",selector:z.selectors.pageLinks},{id:"page-link:skip",selector:z.selectors.pageLinkSkip},{id:"page-link:disabled",selector:z.selectors.pageLinkDisabled}]};if(G.linkBody){y.cutpoints[y.cutpoints.length]={id:"payload-component",selector:G.linkBody}}function A(H){return function(I){return I===-1?{ID:"page-link:skip"}:{ID:I===H?"page-link:link":"page-link:link",localID:I+1,value:I+1,pageIndex:I,decorators:[{type:"jQuery",func:"click",args:function(){F.initiatePageChange.fire({pageIndex:I})}},{type:I===H?"addClass":"",classes:B.options.styles.currentPage}]}}}var C=B.locate("root");h.expectFilledSelector(C,"Error finding root template for fluid.pager.renderedPageList");var D=h.selfRender(C,{},y);F.onModelChange.addListener(function(I,K){var H=B.options.pageStrategy(I.pageCount,0,I.pageIndex);var J=h.transform(H,A(I.pageIndex));J[J.length-1].value=J[J.length-1].value+E.last;F.onRenderPageLinks.fire(J,I);h.reRender(D,C,J,y);s(B,I,K)});return B};h.defaults("fluid.pager.renderedPageList",{selectors:{root:".flc-pager-links"},linkBody:"a",pageStrategy:h.pager.everyPageStrategy});var k=function(z,x,y){if(y.pageIndex===0){z.previous.addClass(x.styles.disabled)}else{z.previous.removeClass(x.styles.disabled)}if(y.pageIndex===y.pageCount-1){z.next.addClass(x.styles.disabled)}else{z.next.removeClass(x.styles.disabled)
}};h.pager.previousNext=function(x,z,y){var A=h.initView("fluid.pager.previousNext",x,y);A.previous=A.locate("previous");j(A.previous,z,{relativePage:-1});A.next=A.locate("next");j(A.next,z,{relativePage:+1});z.onModelChange.addListener(function(B,D,C){k(A,y,B)});return A};h.pager.pagerBar=function(A,y,z,x){var B=h.initView("fluid.pager.pagerBar",y,z);B.pageList=h.initSubcomponent(B,"pageList",[y,A,B.options,h.COMPONENT_OPTIONS,x]);B.previousNext=h.initSubcomponent(B,"previousNext",[y,A,B.options,h.COMPONENT_OPTIONS,x]);return B};h.defaults("fluid.pager.pagerBar",{previousNext:{type:"fluid.pager.previousNext"},pageList:{type:"fluid.pager.directPageList"},selectors:{pageLinks:".flc-pager-pageLink",pageLinkSkip:".flc-pager-pageLink-skip",pageLinkDisabled:".flc-pager-pageLink-disabled",previous:".flc-pager-previous",next:".flc-pager-next"},styles:{currentPage:"fl-pager-currentPage",disabled:"fl-pager-disabled"}});function a(x){return x.options.columnDefs}h.pager.findColumnDef=function(z,y){var x=d.grep(z,function(A){return A.key===y})[0];return x};function r(A,z,x){var y=(z.options.dataOffset?z.options.dataOffset+".":"");A.shortRoot=x;A.longRoot=y+A.shortRoot}function e(y,z,x){if(y.charAt(0)==="*"){return x+y.substring(1)}else{return y.replace("*",z)}}h.pager.fetchValue=function(A,z,y,C,x){r(x,A,y);var B=e(C,x.shortRoot,x.longRoot);return h.model.getBeanValue(z,B)};h.pager.basicSorter=function(G,z){var D=G.options.dataModel;var F={};var A=a(G);var B=h.pager.findColumnDef(A,z.sortKey);var x=[];for(var y=0;y<z.totalRange;++y){x[y]={index:y,value:h.pager.fetchValue(G,D,y,B.valuebinding,F)}}var E=typeof x[0].value;function C(K,J){var I=K.value;var H=J.value;return I===H?0:(I>H?z.sortDir:-z.sortDir)}x.sort(C);return h.transform(x,function(H){return H.index})};h.pager.directModelFilter=function(A,z,C){var D=[];var x=l(z);for(var B=z.pageIndex*z.pageSize;B<x;++B){var y=C?C[B]:B;D[D.length]={index:y,row:A[y]}}return D};function c(D,C){var B="";var y=0;while(true){var z=D.indexOf("${",y);if(z===-1){B+=D.substring(y);break}else{B+=D.substring(y,z);var x=D.indexOf("}",z+2);var A=D.substring(z+2,x);if(A==="VALUE"){A=C.EL}else{A=e(A,C.shortRoot,C.longRoot)}var E=h.model.getBeanValue(C.dataModel,A);B+=E;y=x+1}}return B}function u(A,x,z){for(var y in x){var B=x[y];if(B===h.VALUE){if(y==="valuebinding"){A[y]=z.EL}else{A[y]={valuebinding:z.EL}}}else{if(y==="valuebinding"){A[y]=e(x[y],z)}else{if(typeof(B)==="object"){A[y]=B.length!==undefined?[]:{};u(A[y],B,z)}else{if(typeof(B)==="string"){A[y]=c(B,z)}else{A[y]=x[y]}}}}}return A}function p(z,D){var A=D.options;var C=z.valuebinding;var B=z.key;if(!C){h.fail("Error in definition for column with key "+B+": valuebinding is not set")}D.EL=e(C,D.shortRoot,D.longRoot);if(!B){var y=h.model.parseEL(C);B=y[y.length-1]}var x=(A.keyPrefix?A.keyPrefix:"")+B;return x}function m(y,z){var x=h.transform(z.columnDefs,function(B){var A=p(B,z);var C;if(!B.components){return{ID:A,valuebinding:z.EL}}else{if(typeof B.components==="function"){C=B.components(y.row,y.index)}else{C=B.components}}C=u({},C,z);C.ID=A;return C});return x}function w(x){return h.model.getBeanValue(x.options.dataModel,x.options.dataOffset)}function q(x,z){var C=z.options.renderOptions.idMap["header:"+x];var A=h.jById(C);if(A.length===0){return null}var B=z.overallOptions.selectors.headerSortStylisticOffset;var y=h.findAncestor(A,function(D){return d(D).is(B)});return y}function n(z,y,x){y=d(y);y.removeClass(z.ascendingHeader);y.removeClass(z.descendingHeader);if(x!==0){y.addClass(x===1?z.ascendingHeader:z.descendingHeader)}}function t(z,y){var x=y.sortKey?h.pager.findColumnDef(z,y.sortKey):null;return x?x.sortable:false}function v(y,A){var z=A.overallOptions.styles;var x=t(A.columnDefs,y)?y.sortDir:0;n(z,q(y.sortKey,A),x)}function o(A,z,y){b(z);if(z.pageIndex>=z.pageCount){z.pageIndex=z.pageCount-1}if(y||z.pageIndex!==A.model.pageIndex||z.pageSize!==A.model.pageSize||z.sortKey!==A.model.sortKey||z.sortDir!==A.model.sortDir){var x=t(a(A),z)?A.options.sorter(A,z):null;A.permutation=x;A.events.onModelChange.fire(z,A.model,A);h.model.copyModel(A.model,z)}}function g(z,x,y){return function(){if(x.sortable===true){var A=z.model;var C=h.copy(A);var D=z.options.styles;var E=A.sortKey;if(x.key!==A.sortKey){C.sortKey=x.key;C.sortDir=1;var B=q(E,y);if(B){n(D,B,0)}}else{if(C.sortKey===x.key){C.sortDir=-1*C.sortDir}else{return false}}C.pageIndex=0;o(z,C,true);v(C,y)}return false}}function f(y,x){return y[x.sortable?"sortableHeader":"unsortableHeader"]}function i(z,x,A,y){return{children:h.transform(A,function(B){return{ID:p(B,y),value:B.label,decorators:[{jQuery:["click",g(z,B,y)]},{identify:"header:"+B.key}].concat(f(y.overallOptions.decorators,B))}})}}h.pager.selfRender=function(F,y){var A=h.initView("fluid.pager.selfRender",F.container,y);var G=A.options;G.renderOptions.idMap=G.renderOptions.idMap||{};var E=G.renderOptions.idMap;var B=A.locate("root");var D=h.selfRender(B,{},G.renderOptions);B.addClass(G.styles.root);var z=a(F);var x={options:G,columnDefs:z,overallOptions:F.options,dataModel:F.options.dataModel,idMap:E};var C=w(F);return{returnedOptions:{listeners:{onModelChange:function(J,L){var I=F.options.modelFilter(C,J,F.permutation);var H=h.transform(I,function(M){var N=r(x,F,M.index);if(z==="explode"){return h.explode(M.row,B)}else{if(z.length){return m(M,x)}}});var K={};K[G.row]=H;if(typeof(z)==="object"){K[G.header]=i(F,J,z,x)}G.renderOptions=G.renderOptions||{};G.renderOptions.model=x.dataModel;h.reRender(D,B,K,G.renderOptions);v(J,x)}}}}};h.defaults("fluid.pager.selfRender",{selectors:{root:".flc-pager-body-template"},styles:{root:"fl-pager"},keyStrategy:"id",keyPrefix:"",row:"row:",header:"header:",renderOptions:{}});h.pager.summary=function(z,x){var y=z.locate("summary");return{returnedOptions:{listeners:{onModelChange:function(A,C){var B=h.stringTemplate(x.message,{first:A.pageIndex*A.pageSize+1,last:l(A),total:A.totalRange});if(y.length>0){y.text(B)}}}}}};h.pager.directPageSize=function(y){var x=y.locate("pageSize");if(x.length>0){y.events.onModelChange.addListener(function(z,A){if(x.val()!==z.pageSize){x.val(z.pageSize)}});x.change(function(){y.events.initiatePageSizeChange.fire(x.val())})}return y};h.pager.rangeAnnotator=function(z,y){var x={};z.events.onRenderPageLinks.addListener(function(A,D){var F=z.options.annotateColumnRange;var C=z.options.dataModel;var H=a(z);if(!F||!C||!H){return}var B=h.pager.findColumnDef(H,F);function G(I){I=z.permutation?z.permutation[I]:I;return h.pager.fetchValue(z,C,I,B.valuebinding,x)}var E={};h.model.copyModel(E,D);h.transform(A,function(I){if(I.ID==="page-link:link"){var M=I.pageIndex;var P=M*E.pageSize;E.pageIndex=M;var J=l(E);var O=G(P);var L=G(J-1);var N="<b>"+O+"</b><br/>&mdash;<br/><b>"+L+"</b>";var K={type:"jQuery",func:"tooltip",args:{delay:z.options.tooltipDelay,extraClass:z.options.styles.tooltip,bodyHandler:function(){return N},showURL:false,id:z.options.tooltipId}};I.decorators.push(K)}})})};h.pagerImpl=function(x,y){var A=h.initView("fluid.pager",x,y);var C=function(E,F){if(F.value<0){F.value=0}};A.events.initiatePageChange.addListener(function(E){var F=h.copy(A.model);if(E.relativePage!==undefined){F.pageIndex=A.model.pageIndex+E.relativePage}else{F.pageIndex=E.pageIndex}if(F.pageIndex===undefined||F.pageIndex<0){F.pageIndex=0}o(A,F,E.forceUpdate)});A.events.initiatePageSizeChange.addListener(function(E){var F=h.copy(A.model);F.pageSize=E;o(A,F)});var B=A.locate("pagerBar");if(B.length>0){A.pagerBar=h.initSubcomponent(A,"pagerBar",[A.events,B,h.COMPONENT_OPTIONS,A.options.strings])}var D=A.locate("pagerBarSecondary");if(D.length>0){A.pagerBarSecondary=h.initSubcomponent(A,"pagerBar",[A.events,D,h.COMPONENT_OPTIONS,A.options.strings])}A.bodyRenderer=h.initSubcomponent(A,"bodyRenderer",[A,h.COMPONENT_OPTIONS]);A.summary=h.initSubcomponent(A,"summary",[A.dom,h.COMPONENT_OPTIONS]);A.pageSize=h.initSubcomponent(A,"pageSize",[A]);A.rangeAnnotator=h.initSubcomponent(A,"rangeAnnotator",[A,h.COMPONENT_OPTIONS]);A.model=h.copy(A.options.model);var z=w(A);if(z){A.model.totalRange=z.length}if(A.model.totalRange===undefined){if(!A.pagerBar){h.fail("Error in Pager configuration - cannot determine total range,  since not configured in model.totalRange and no PagerBar is configured")}A.model=A.pagerBar.pageList.defaultModel}A.applier=h.makeChangeApplier(A.model);A.events.initiatePageChange.fire({pageIndex:A.model.pageIndex?A.model.pageIndex:0,forceUpdate:true});return A};h.defaults("fluid.pager",{pagerBar:{type:"fluid.pager.pagerBar",options:null},summary:{type:"fluid.pager.summary",options:{message:"%first-%last of %total items"}},pageSize:{type:"fluid.pager.directPageSize"},modelFilter:h.pager.directModelFilter,sorter:h.pager.basicSorter,bodyRenderer:{type:"fluid.emptySubcomponent"},model:{pageIndex:undefined,pageSize:10,totalRange:undefined},dataModel:undefined,dataOffset:"",columnDefs:"explode",annotateColumnRange:undefined,tooltipDelay:300,tooltipId:"tooltip",rangeAnnotator:{type:"fluid.pager.rangeAnnotator"},selectors:{pagerBar:".flc-pager-top",pagerBarSecondary:".flc-pager-bottom",summary:".flc-pager-summary",pageSize:".flc-pager-page-size",headerSortStylisticOffset:".flc-pager-sort-header"},styles:{tooltip:"fl-pager-tooltip",ascendingHeader:"fl-pager-asc",descendingHeader:"fl-pager-desc"},decorators:{sortableHeader:[],unsortableHeader:[]},strings:{last:" (last)"},events:{initiatePageChange:null,initiatePageSizeChange:null,onModelChange:null,onRenderPageLinks:null}})})(jQuery,fluid_1_2);