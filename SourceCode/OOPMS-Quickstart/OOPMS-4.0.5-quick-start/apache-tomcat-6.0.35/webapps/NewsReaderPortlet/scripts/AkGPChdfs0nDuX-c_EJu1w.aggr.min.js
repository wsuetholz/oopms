var news=news||{};if(!news.init){news.init=function(b,a){a.defaults("news.reader",{url:null,gradeNames:["fluid.viewComponent","autoInit"],selectors:{feedListContainer:".news-feeds-container",storyListContainer:".news-stories-container",storyDetailContainer:".story-container"},events:{onReady:null,onFeedReturn:null,onFeedSelect:null,onStorySelect:null},components:{feedListView:{type:"news.feedListView",createOnEvent:"onReady",container:"{reader}.dom.feedListContainer",options:{model:"{reader}.model",url:"{reader}.options.url",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn"}}},feedDetailView:{type:"news.feedDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyListContainer",options:{model:"{reader}.model",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn",onStorySelect:"{reader}.events.onStorySelect"}}},storyDetailView:{type:"news.storyDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyDetailContainer",options:{model:"{reader}.model",events:{onStorySelect:"{reader}.events.onStorySelect"}}}},finalInitFunction:function(c){b.get(c.options.url,function(d){c.model=d;c.events.onReady.fire();c.locate("feedListContainer").show();},"json");}});a.defaults("news.feedListView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{feed:".news-feed",feedLink:".news-feed-link",feedTitle:".news-feed-title"},listeners:{hideFeed:function(c){c.hideList();},showFeed:function(c){c.showList();}},events:{onFeedSelect:null,onFeedReturn:null,showFeed:{event:"onFeedReturn",args:["{feedListView}"]},hideFeed:{event:"onFeedSelect",args:["{feedListView}"]}},repeatingSelectors:["feed"],protoTree:{expander:{type:"fluid.renderer.repeat",repeatID:"feed",controlledBy:"feeds",pathAs:"feed",tree:{feedTitle:{value:"${{feed}.name}"},feedLink:{target:"javascript:;"}}}},finalInitFunction:function(c){b(c.options.selectors.feedLink).live("click",function(){var d,f,e;d=b(this).index(c.options.selectors.feedLink);e=c.model.feeds[d].id;if(e!==c.model.activeFeed){console.log("updating");b.ajax({url:c.options.url,data:{activeateNews:e},dataType:"json",success:function(g){c.model=g;c.events.onFeedSelect.fire(c.model.feed);}});}else{c.events.onFeedSelect.fire(c.model.feed);}});c.hideList=function(){b(c.container).hide();};c.showList=function(){b(c.container).show();};}});a.defaults("news.feedDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:false,selectors:{feedTitle:".news-feed-title",backLink:".news-reader-back-link",story:".news-story",storyLink:".news-story-link",storyTitle:".news-story-title",storySummary:".news-story-summary"},events:{onFeedSelect:null,onFeedReturn:null,onStoryReturn:null,showDetails:{event:"onFeedSelect",args:["{feedDetailView}","{arguments}.0"]},hideDetails:{event:"onFeedReturn",args:["{feedDetailView}"]}},listeners:{showDetails:function(c,d){c.showDetails(d);},hideDetails:function(c){c.hideDetails();}},repeatingSelectors:["story"],protoTree:{feedTitle:{value:"${feed.title}"},backLink:{target:"javascript:;"},expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"feed.entries",pathAs:"story",tree:{storyTitle:{value:"${{story}.title}"},storyLink:{target:"${{story}.link}"},storySummary:{value:"${{story}.description}"}}}},finalInitFunction:function(c){b(c.options.selectors.storyLink).live("click",function(){var e,d;e=b(this).index(c.options.selectors.feedLink);d=c.model.entries[e];c.events.onStorySelect.fire(d);});c.showDetails=function(d){c.model.feed=d;c.refreshView();b(c.container).show();};c.hideDetails=function(){b(c.container).hide();};b(c.options.selectors.backLink).live("click",function(){c.events.onFeedReturn.fire();});}});a.defaults("news.storyDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{storyContent:".story-content"},events:{onStorySelect:null,onStoryReturn:null,showStory:{event:"onStorySelect",args:["{storyDetailView}","{arguments}.0"]},hideStory:{event:"onStoryReturn",args:["{storyDetailView}"]}},listeners:{showStory:function(c,d){c.showStory(d);},hideStory:function(c){c.hideStory();}},repeatingSelectors:["story"],protoTree:{expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"entries",pathAs:"story",tree:{storyContent:{value:"${{story}.description}"}}}},finalInitFunction:function(c){c.showStory=function(d){b(c.container).show();};c.hideStory=function(){b(c.container).hide();};b(c.options.selectors.backLink).live("click",function(){c.events.onStoryReturn.fire();});}});};}