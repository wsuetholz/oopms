var news=news||{};if(!news.init){news.init=function(c,a){var b=function(d,e){d.model=e;d.model.feedIds=[];d.model.feedNames=[];c(d.model.feeds).each(function(f,g){d.model.feedIds.push(String(g.id));d.model.feedNames.push(g.name);});d.model.activeFeedStr=String(d.model.activeFeed);};a.defaults("news.reader",{url:null,gradeNames:["fluid.viewComponent","autoInit"],selectors:{feedListContainer:".news-feeds-container",storyListContainer:".news-stories-container",storyDetailContainer:".story-container"},useFlyouts:true,events:{onReady:null,onFeedReturn:null,onFeedSelect:null,onStorySelect:null},components:{feedListView:{type:"news.feedListView",createOnEvent:"onReady",container:"{reader}.dom.feedListContainer",options:{model:"{reader}.model",url:"{reader}.options.url",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn"}}},feedDetailView:{type:"news.feedDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyListContainer",options:{model:"{reader}.model",useFlyouts:"{reader}.options.useFlyouts",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn",onStorySelect:"{reader}.events.onStorySelect"}}},storyDetailView:{type:"news.storyDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyDetailContainer",options:{model:"{reader}.model",events:{onStorySelect:"{reader}.events.onStorySelect"}}}},finalInitFunction:function(d){c.get(d.options.url,function(e){b(d,e);d.events.onReady.fire();d.locate("feedListContainer").show();},"json");}});a.defaults("news.feedListView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{feedSelect:".news-feed-select"},listeners:{hideFeed:function(d){d.hideList();},showFeed:function(d){d.showList();}},events:{onFeedSelect:null,onFeedReturn:null,showFeed:{event:"onFeedReturn",args:["{feedListView}"]},hideFeed:null},repeatingSelectors:["feed"],protoTree:{feedSelect:{selection:"${activeFeedStr}",optionlist:"${feedIds}",optionnames:"${feedNames}"}},finalInitFunction:function(d){d.loadFeed=function(e){if(e!==d.model.activeFeed){c.ajax({url:d.options.url,data:{activeateNews:e},dataType:"json",success:function(f){b(d,f);d.events.onFeedSelect.fire(d.model.feed);}});}else{d.events.onFeedSelect.fire(d.model.feed);}};c(d.options.selectors.feedSelect).live("change",function(){var e,g,f;f=c(this).val();d.loadFeed(f);});d.hideList=function(){c(d.container).hide();};d.showList=function(){c(d.container).show();};}});a.defaults("news.feedDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{feedTitle:".news-feed-title",backLink:".news-reader-back-link",story:".news-story",storyLink:".news-story-link",storyTitle:".news-story-title",storySummary:".news-story-summary"},events:{onFeedSelect:null,onFeedReturn:null,onStoryReturn:null,showDetails:{event:"onFeedSelect",args:["{feedDetailView}","{arguments}.0"]},hideDetails:{event:"onFeedReturn",args:["{feedDetailView}"]}},listeners:{showDetails:function(d,e){d.showDetails(e);},hideDetails:function(d){d.hideDetails();}},repeatingSelectors:["story"],protoTree:{feedTitle:{value:"${feed.title}"},backLink:{target:"javascript:;"},expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"feed.entries",pathAs:"story",valueAs:"storyValue",tree:{storyTitle:{value:"${{story}.title}"},storyLink:{target:"${{story}.link}",decorators:[{attrs:{title:"{storyValue}.description"}}]},storySummary:{value:"${{story}.description}"}}}},finalInitFunction:function(d){c(d.options.selectors.storyLink).live("click",function(){var f,e;f=c(this).index(d.options.selectors.feedLink);e=d.model.entries[f];d.events.onStorySelect.fire(e);});d.showDetails=function(e){d.model.feed=e;d.refreshView();if(d.options.useFlyouts){c(d.options.selectors.storyLink).tooltip({showURL:false,position:{offset:"15 15"}});}c(d.container).show();};d.hideDetails=function(){c(d.container).hide();};c(d.options.selectors.backLink).live("click",function(){d.events.onFeedReturn.fire();});d.showDetails(d.model.feed);}});a.defaults("news.storyDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{storyContent:".story-content"},events:{onStorySelect:null,onStoryReturn:null,showStory:{event:"onStorySelect",args:["{storyDetailView}","{arguments}.0"]},hideStory:{event:"onStoryReturn",args:["{storyDetailView}"]}},listeners:{showStory:function(d,e){d.showStory(e);},hideStory:function(d){d.hideStory();}},repeatingSelectors:["story"],protoTree:{expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"entries",pathAs:"story",tree:{storyContent:{value:"${{story}.description}"}}}},finalInitFunction:function(d){d.showStory=function(e){c(d.container).show();};d.hideStory=function(){c(d.container).hide();};c(d.options.selectors.backLink).live("click",function(){d.events.onStoryReturn.fire();});}});};}